definitions:
  api.AddAlertRequest:
    properties:
      alert_id:
        type: string
    required:
    - alert_id
    type: object
  api.AddNoteRequest:
    properties:
      content:
        maxLength: 5000
        minLength: 1
        type: string
    required:
    - content
    type: object
  api.ApprovalActionRequest:
    properties:
      action:
        description: approve, reject, escalate, comment
        type: string
      comment:
        description: Optional comment
        type: string
      expected_version:
        description: For optimistic locking
        type: integer
    type: object
  api.ApprovalError:
    properties:
      error:
        properties:
          code:
            type: string
          message:
            type: string
        type: object
      success:
        type: boolean
    type: object
  api.ApprovalListResponse:
    properties:
      has_more:
        type: boolean
      items:
        items:
          $ref: '#/definitions/soar.ApprovalRequest'
        type: array
      limit:
        type: integer
      page:
        type: integer
      total:
        type: integer
    type: object
  api.ApprovalRequest:
    properties:
      approvedBy:
        description: User ID of approver
        type: string
      comment:
        description: Optional comment (max 5000 chars)
        type: string
    type: object
  api.ApprovalResponse:
    properties:
      approvedAt:
        type: string
      approvedBy:
        type: string
      comment:
        type: string
      executionId:
        type: string
      rejectedAt:
        type: string
      rejectedBy:
        type: string
      status:
        type: string
      success:
        type: boolean
    type: object
  api.AssignableUser:
    properties:
      roleName:
        type: string
      username:
        type: string
    type: object
  api.AssignableUsersResponse:
    properties:
      limit:
        type: integer
      search:
        type: string
      total:
        type: integer
      users:
        items:
          $ref: '#/definitions/api.AssignableUser'
        type: array
    type: object
  api.BatchTestRequest:
    properties:
      events:
        items:
          $ref: '#/definitions/cerberus_core.Event'
        type: array
      expected_alerts:
        type: integer
      timeout_seconds:
        description: Max 30
        type: integer
    required:
    - events
    type: object
  api.BatchTestResponse:
    properties:
      alerts_generated:
        type: integer
      errors:
        items:
          type: string
        type: array
      events_per_second:
        type: number
      matched_events:
        type: integer
      results:
        description: Per-event results if requested
        items:
          $ref: '#/definitions/api.EventResult'
        type: array
      total_events:
        type: integer
      total_time_ms:
        type: number
    type: object
  api.BlockIPRequest:
    properties:
      alertId:
        description: 'Optional: for audit trail'
        type: string
      ip:
        type: string
      reason:
        description: Optional
        type: string
    type: object
  api.BlockIPResponse:
    properties:
      action:
        type: string
      message:
        type: string
      success:
        type: boolean
      target:
        type: string
    type: object
  api.BulkOperationRequest:
    properties:
      rule_ids:
        items:
          type: string
        type: array
    type: object
  api.BulkOperationResponse:
    properties:
      errors:
        items:
          type: string
        type: array
      failed:
        type: integer
      processed:
        type: integer
    type: object
  api.CloneRuleRequest:
    properties:
      newName:
        description: 'Optional: defaults to "Original Name (Copy)"'
        type: string
    type: object
  api.CloneRuleResponse:
    properties:
      data: {}
      success:
        type: boolean
    type: object
  api.CloseInvestigationRequest:
    properties:
      affected_assets:
        items:
          type: string
        type: array
      ml_feedback:
        $ref: '#/definitions/core.MLFeedback'
      resolution_category:
        type: string
      summary:
        maxLength: 5000
        type: string
      verdict:
        $ref: '#/definitions/core.InvestigationVerdict'
    required:
    - resolution_category
    - summary
    - verdict
    type: object
  api.ComponentHealth:
    properties:
      latency:
        description: How long the check took
        type: string
      message:
        type: string
      status:
        description: '"healthy", "unhealthy", "degraded"'
        type: string
    type: object
  api.CoverageGap:
    properties:
      tactics:
        items:
          type: string
        type: array
      technique_id:
        type: string
      technique_name:
        type: string
    type: object
  api.CoverageMatrix:
    properties:
      tactics:
        items:
          $ref: '#/definitions/api.CoverageMatrixTactic'
        type: array
    type: object
  api.CoverageMatrixTactic:
    properties:
      tactic_id:
        type: string
      tactic_name:
        type: string
      techniques:
        items:
          $ref: '#/definitions/api.CoverageMatrixTechnique'
        type: array
    type: object
  api.CoverageMatrixTechnique:
    properties:
      is_covered:
        type: boolean
      rule_count:
        type: integer
      rules:
        items:
          $ref: '#/definitions/api.RuleReference'
        type: array
      technique_id:
        type: string
      technique_name:
        type: string
    type: object
  api.CoverageReport:
    properties:
      coverage_gaps:
        items:
          $ref: '#/definitions/api.CoverageGap'
        type: array
      coverage_percent:
        type: number
      covered_techniques:
        type: integer
      last_updated:
        type: string
      tactic_coverage:
        items:
          $ref: '#/definitions/api.TacticAnalytics'
        type: array
      total_techniques:
        type: integer
      total_unique_rules:
        type: integer
    type: object
  api.CreateFeedRequest:
    properties:
      auth_config:
        additionalProperties: true
        type: object
      auto_enable_rules:
        type: boolean
      branch:
        type: string
      description:
        type: string
      enabled:
        type: boolean
      exclude_paths:
        items:
          type: string
        type: array
      exclude_tags:
        items:
          type: string
        type: array
      id:
        description: Feed configuration fields
        type: string
      include_paths:
        items:
          type: string
        type: array
      include_tags:
        items:
          type: string
        type: array
      metadata:
        additionalProperties:
          type: string
        type: object
      min_severity:
        type: string
      name:
        type: string
      path:
        type: string
      priority:
        type: integer
      tags:
        items:
          type: string
        type: array
      template_id:
        description: Template-based creation
        type: string
      type:
        type: string
      update_schedule:
        type: string
      update_strategy:
        type: string
      url:
        type: string
    type: object
  api.CreateInvestigationFromAlertRequest:
    properties:
      description:
        description: 'Optional: auto-generated as "Investigation created from alert
          [alertID]"'
        type: string
      priority:
        description: 'Optional: auto-mapped from alert severity'
        type: string
      title:
        description: 'Optional: auto-generated as "Investigation: [RuleName]"'
        type: string
    type: object
  api.CreateInvestigationFromAlertResponse:
    properties:
      alertId:
        type: string
      investigation:
        $ref: '#/definitions/core.Investigation'
      linkedAt:
        type: string
      message:
        type: string
      warnings:
        description: 'TASK 145.2: Return warnings for non-fatal issues (e.g., MITRE
          truncation)'
        items:
          type: string
        type: array
    type: object
  api.CreateInvestigationRequest:
    properties:
      alert_ids:
        items:
          type: string
        type: array
      assignee_id:
        type: string
      description:
        maxLength: 2000
        type: string
      priority:
        $ref: '#/definitions/core.InvestigationPriority'
      title:
        maxLength: 200
        minLength: 1
        type: string
    required:
    - priority
    - title
    type: object
  api.DatabaseInfo:
    properties:
      clickhouse_version:
        type: string
      sqlite_wal_mode:
        type: string
    type: object
  api.ErrorRateStats:
    properties:
      cache_errors_percent:
        type: number
      detection_errors_percent:
        type: number
      training_errors_percent:
        type: number
    type: object
  api.ErrorResponse:
    properties:
      errors:
        items:
          type: string
        type: array
    type: object
  api.EventResult:
    properties:
      error:
        type: string
      event_id:
        type: string
      event_index:
        type: integer
      matched:
        type: boolean
      time_ms:
        type: number
    type: object
  api.FeedResponse:
    properties:
      feed:
        $ref: '#/definitions/feeds.RuleFeed'
    type: object
  api.FeedsListResponse:
    properties:
      items:
        items:
          $ref: '#/definitions/feeds.RuleFeed'
        type: array
      limit:
        type: integer
      page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  api.FeedsSummaryResponse:
    properties:
      active_feeds:
        type: integer
      error_count:
        type: integer
      health_status:
        type: string
      last_sync:
        description: null if no feeds have synced
        type: string
      total_feeds:
        type: integer
      total_rules:
        type: integer
    type: object
  api.FirstRunResponse:
    properties:
      is_first_run:
        type: boolean
    type: object
  api.GetRemediationActionsResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/api.RemediationActionRecord'
        type: array
      success:
        type: boolean
    type: object
  api.HealthCheck:
    properties:
      details:
        type: string
      message:
        type: string
      status:
        description: '"pass", "fail", "warn"'
        type: string
      time:
        type: string
    type: object
  api.HealthDetailedResponse:
    properties:
      components:
        additionalProperties:
          $ref: '#/definitions/api.ComponentHealth'
        type: object
      database:
        $ref: '#/definitions/api.DatabaseInfo'
      status:
        type: string
      system:
        $ref: '#/definitions/api.SystemInfo'
      time:
        type: string
      uptime:
        type: string
      version:
        type: string
    type: object
  api.HealthReadyResponse:
    properties:
      components:
        additionalProperties:
          $ref: '#/definitions/api.ComponentHealth'
        type: object
      status:
        description: '"ready" or "not_ready"'
        type: string
      time:
        type: string
    type: object
  api.HuntIOCsRequest:
    properties:
      alertId:
        description: 'Optional: for context'
        type: string
      iocs:
        items:
          $ref: '#/definitions/api.IOCEntry'
        type: array
    type: object
  api.HuntIOCsResponse:
    properties:
      action:
        type: string
      huntId:
        type: string
      iocCount:
        type: integer
      message:
        type: string
      success:
        type: boolean
    type: object
  api.IOCEntry:
    properties:
      type:
        description: ip, domain, hash, url
        type: string
      value:
        type: string
    type: object
  api.ImportResponse:
    properties:
      failed:
        type: integer
      imported:
        type: integer
      results:
        items:
          $ref: '#/definitions/api.ImportResult'
        type: array
      skipped:
        type: integer
      total:
        type: integer
      updated:
        type: integer
    type: object
  api.ImportResult:
    properties:
      filename:
        type: string
      message:
        type: string
      rule_id:
        type: string
      status:
        description: imported|updated|skipped|failed
        type: string
    type: object
  api.LatencyStats:
    properties:
      average:
        $ref: '#/definitions/time.Duration'
      max:
        $ref: '#/definitions/time.Duration'
      p95:
        $ref: '#/definitions/time.Duration'
      p99:
        $ref: '#/definitions/time.Duration'
    type: object
  api.LinkInvestigationRequest:
    properties:
      investigationId:
        type: string
    required:
    - investigationId
    type: object
  api.LinkInvestigationResponse:
    properties:
      alertId:
        type: string
      investigationId:
        type: string
      message:
        type: string
      previousInvestigationId:
        type: string
      warnings:
        description: 'TASK 107: Partial failure warnings'
        items:
          type: string
        type: array
    type: object
  api.ListenerTemplate:
    properties:
      category:
        type: string
      config:
        $ref: '#/definitions/storage.DynamicListener'
      description:
        type: string
      icon:
        type: string
      id:
        type: string
      name:
        type: string
      tags:
        items:
          type: string
        type: array
    type: object
  api.MLAPIConfig:
    properties:
      algorithms:
        items:
          type: string
        type: array
      batch_size:
        type: integer
      drift_detection:
        type: boolean
      enable_continuous:
        type: boolean
      enabled:
        type: boolean
      min_confidence:
        type: number
      retrain_threshold:
        type: integer
      training_interval:
        type: string
      validation_ratio:
        type: number
      voting_strategy:
        type: string
      weights:
        additionalProperties:
          format: float64
          type: number
        type: object
    type: object
  api.MLDetailedHealthResponse:
    properties:
      checks:
        additionalProperties:
          $ref: '#/definitions/api.HealthCheck'
        type: object
      message:
        type: string
      performance_metrics:
        $ref: '#/definitions/api.MLPerformanceMetrics'
      status:
        type: string
      system_resources:
        $ref: '#/definitions/api.MLSystemResources'
      timestamp:
        type: string
      uptime:
        $ref: '#/definitions/time.Duration'
      version:
        type: string
    type: object
  api.MLPerformanceMetrics:
    properties:
      detection_latency:
        $ref: '#/definitions/api.LatencyStats'
      error_rates:
        $ref: '#/definitions/api.ErrorRateStats'
      memory_usage:
        $ref: '#/definitions/api.MemoryStats'
      throughput:
        $ref: '#/definitions/api.ThroughputStats'
      training_duration:
        $ref: '#/definitions/api.LatencyStats'
    type: object
  api.MLStatusResponse:
    properties:
      buffer_size:
        type: integer
      config:
        $ref: '#/definitions/api.MLAPIConfig'
      enabled:
        type: boolean
      is_running:
        type: boolean
      last_training:
        type: string
      performance_history:
        items:
          $ref: '#/definitions/ml.TrainingPerformance'
        type: array
      sample_count:
        type: integer
    type: object
  api.MLSystemResources:
    properties:
      active_goroutines:
        type: integer
      cpu_usage_percent:
        type: number
      disk_usage_percent:
        type: number
      memory_usage_percent:
        type: number
    type: object
  api.MemoryStats:
    properties:
      available_mb:
        type: number
      used_mb:
        type: number
      utilization_percent:
        type: number
    type: object
  api.MigrateCQLRequest:
    properties:
      all:
        description: Migrate all CQL rules
        type: boolean
      dry_run:
        description: Preview without saving
        type: boolean
      preserve_original:
        description: Keep original CQL rules as disabled
        type: boolean
      rule_ids:
        description: Specific rule IDs to migrate (empty for all)
        items:
          type: string
        type: array
    type: object
  api.MigrateCQLResponse:
    properties:
      failed:
        type: integer
      migrated:
        type: integer
      results:
        items:
          $ref: '#/definitions/api.MigrationResult'
        type: array
      skipped:
        type: integer
      total_rules:
        type: integer
    type: object
  api.MigrationResult:
    properties:
      error:
        type: string
      rule_id:
        type: string
      rule_name:
        type: string
      sigma_yaml:
        type: string
      success:
        type: boolean
      warnings:
        items:
          type: string
        type: array
    type: object
  api.PaginationResponse:
    properties:
      items: {}
      limit:
        type: integer
      page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  api.ParsedEvents:
    properties:
      count:
        type: integer
      errors:
        items:
          type: string
        type: array
      events:
        items:
          $ref: '#/definitions/cerberus_core.Event'
        type: array
      warnings:
        items:
          type: string
        type: array
    type: object
  api.PlaybookExecutionRequest:
    properties:
      alert_id:
        type: string
    required:
    - alert_id
    type: object
  api.PlaybookExecutionResponse:
    properties:
      error:
        type: string
      execution_id:
        type: string
      started_at:
        type: string
      status:
        type: string
      step_results:
        additionalProperties:
          $ref: '#/definitions/soar.ActionResult'
        type: object
    type: object
  api.PlaybookValidationResponse:
    properties:
      errors:
        items:
          type: string
        type: array
      valid:
        type: boolean
      warnings:
        items:
          type: string
        type: array
    type: object
  api.QueryValidationResponse:
    properties:
      errors:
        items:
          type: string
        type: array
      valid:
        type: boolean
      warnings:
        items:
          type: string
        type: array
    type: object
  api.RemediationActionRecord:
    properties:
      actionId:
        type: string
      actionType:
        description: block-ip, unblock-ip, hunt-iocs
        type: string
      alertId:
        type: string
      completedAt:
        type: string
      reason:
        type: string
      requestedAt:
        type: string
      requestedBy:
        type: string
      status:
        description: pending, completed, failed
        type: string
      target:
        type: string
    type: object
  api.RemediationError:
    properties:
      code:
        type: string
      error:
        type: string
    type: object
  api.RestoreRuleRequest:
    properties:
      version:
        type: integer
    type: object
  api.RestoreRuleResponse:
    properties:
      data:
        properties:
          content:
            type: string
          id:
            type: string
          restoredAt:
            type: string
          restoredFromVersion:
            type: integer
          title:
            type: string
          version:
            type: integer
        type: object
      success:
        type: boolean
    type: object
  api.RuleReference:
    properties:
      rule_id:
        type: string
      rule_name:
        type: string
      rule_severity:
        type: string
      source:
        description: '"mongodb" or "sigma_feed"'
        type: string
    type: object
  api.RuleTestRequest:
    properties:
      events:
        description: Sample events to test
        items:
          $ref: '#/definitions/cerberus_core.Event'
        type: array
      expect_correlation:
        type: boolean
      expect_match:
        description: Expected match outcome
        type: boolean
      rule:
        allOf:
        - $ref: '#/definitions/core.Rule'
        description: Inline rule definition
      rule_id:
        description: Or load existing rule by ID
        type: string
    required:
    - events
    type: object
  api.RuleTestResponse:
    properties:
      correlation_state:
        additionalProperties: true
        type: object
      correlation_triggered:
        type: boolean
      errors:
        items:
          type: string
        type: array
      evaluation_time_ms:
        type: number
      execution_time_ms:
        description: Alias for EvaluationTimeMs
        type: number
      match_count:
        type: integer
      matched:
        type: boolean
      matched_events:
        description: Indices of matched events
        items:
          type: integer
        type: array
      matches:
        description: Legacy fields for backwards compatibility
        items:
          $ref: '#/definitions/detect.MatchResult'
        type: array
      total_events:
        type: integer
    type: object
  api.RuleVersionEntry:
    properties:
      author:
        type: string
      createdAt:
        type: string
      title:
        type: string
      version:
        type: integer
    type: object
  api.RuleVersionsResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/api.RuleVersionEntry'
        type: array
      success:
        type: boolean
    type: object
  api.SearchRequest:
    properties:
      end_time:
        type: string
      limit:
        type: integer
      offset:
        type: integer
      order_by:
        type: string
      order_direction:
        type: string
      query:
        type: string
      start_time:
        type: string
    required:
    - query
    type: object
  api.SearchResponse:
    properties:
      events:
        items:
          $ref: '#/definitions/cerberus_core.Event'
        type: array
      has_more:
        type: boolean
      limit:
        type: integer
      offset:
        type: integer
      stats:
        $ref: '#/definitions/api.SearchStats'
      total:
        type: integer
    type: object
  api.SearchStats:
    properties:
      execution_time_ms:
        $ref: '#/definitions/time.Duration'
      query:
        type: string
    type: object
  api.SetupCompleteRequest:
    properties:
      skipped_wizard:
        description: SkippedWizard indicates if the user skipped the setup wizard
        type: boolean
    type: object
  api.SetupCompleteResponse:
    properties:
      message:
        type: string
      success:
        type: boolean
    type: object
  api.SyncStatusResponse:
    properties:
      feed_id:
        type: string
      message:
        type: string
      status:
        type: string
      status_url:
        type: string
    type: object
  api.SystemInfo:
    properties:
      cpu_cores:
        type: integer
      goroutines:
        type: integer
      heap_alloc:
        type: string
      heap_sys:
        type: string
      num_gc:
        type: integer
    type: object
  api.TacticAnalytics:
    properties:
      alert_count_30d:
        type: integer
      coverage_percent:
        type: number
      covered_techniques:
        type: integer
      gap_count:
        type: integer
      rule_count:
        type: integer
      tactic_id:
        type: string
      tactic_name:
        type: string
      total_techniques:
        type: integer
    type: object
  api.ThroughputStats:
    properties:
      average_per_second:
        type: number
      current_per_second:
        type: number
      peak_per_second:
        type: number
    type: object
  api.UnblockIPRequest:
    properties:
      alertId:
        description: 'Optional: for audit trail'
        type: string
      ip:
        type: string
      reason:
        description: Optional
        type: string
    type: object
  api.UnblockIPResponse:
    properties:
      action:
        type: string
      message:
        type: string
      success:
        type: boolean
      target:
        type: string
    type: object
  api.UpdateAssigneeRequest:
    properties:
      assigneeId:
        description: Pointer for null support (unassign)
        type: string
    type: object
  api.UpdateAssigneeResponse:
    properties:
      assignedTo:
        type: string
      id:
        type: string
      message:
        type: string
      previousAssignee:
        type: string
    type: object
  api.UpdateDispositionRequest:
    properties:
      disposition:
        type: string
      reason:
        type: string
    required:
    - disposition
    type: object
  api.UpdateDispositionResponse:
    properties:
      disposition:
        type: string
      dispositionReason:
        type: string
      dispositionSetAt:
        type: string
      dispositionSetBy:
        type: string
      id:
        type: string
      message:
        type: string
    type: object
  api.UpdateFeedRequest:
    properties:
      auth_config:
        additionalProperties: true
        type: object
      auto_enable_rules:
        type: boolean
      branch:
        type: string
      description:
        type: string
      enabled:
        type: boolean
      exclude_paths:
        items:
          type: string
        type: array
      exclude_tags:
        items:
          type: string
        type: array
      include_paths:
        items:
          type: string
        type: array
      include_tags:
        items:
          type: string
        type: array
      metadata:
        additionalProperties:
          type: string
        type: object
      min_severity:
        type: string
      name:
        type: string
      path:
        type: string
      priority:
        type: integer
      tags:
        items:
          type: string
        type: array
      type:
        type: string
      update_schedule:
        type: string
      update_strategy:
        type: string
      url:
        type: string
    type: object
  api.UpdateInvestigationRequest:
    properties:
      assignee_id:
        type: string
      description:
        maxLength: 2000
        type: string
      priority:
        $ref: '#/definitions/core.InvestigationPriority'
      status:
        $ref: '#/definitions/core.InvestigationStatus'
      title:
        maxLength: 200
        minLength: 1
        type: string
    type: object
  api.ValidateRequest:
    properties:
      sigma_yaml:
        type: string
    type: object
  api.ValidateResponse:
    properties:
      category:
        description: 'Detected category: detection|correlation'
        type: string
      errors:
        items:
          type: string
        type: array
      valid:
        type: boolean
      warnings:
        items:
          type: string
        type: array
    type: object
  cerberus_core.Event:
    properties:
      event_id:
        example: event-123
        type: string
      event_type:
        example: user_login
        type: string
      fields:
        additionalProperties: true
        type: object
      ingested_at:
        type: string
      listener_id:
        type: string
      listener_name:
        type: string
      raw_data:
        description: |-
          RawData stores the original raw event data. Using json.RawMessage prevents
          double-encoding when the event is serialized to JSON for API responses.
          For JSON events, this contains valid JSON that should be embedded as-is.
          For non-JSON events (syslog, CEF), this contains the raw string.
        example: '{"key":"value"}'
        type: string
      severity:
        example: info
        type: string
      source:
        type: string
      source_format:
        example: json
        type: string
      source_ip:
        example: 192.168.1.100
        type: string
      timestamp:
        example: "2023-10-31T12:00:00Z"
        type: string
    type: object
  core.Action:
    properties:
      config:
        type: object
      created_at:
        type: string
      id:
        example: action-123
        type: string
      type:
        description: webhook, jira, etc.
        example: webhook
        type: string
      updated_at:
        type: string
    type: object
  core.Alert:
    properties:
      alert_id:
        example: alert-123
        type: string
      assigned_to:
        type: string
      category:
        description: |-
          Alert Info Modal - Overview metadata fields
          Category represents the alert classification (e.g., malware, phishing, intrusion, data_exfiltration)
        example: intrusion
        type: string
      confidence_score:
        description: ConfidenceScore indicates detection confidence as percentage
          (0-100)
        example: 85.5
        type: number
      correlated_alert_ids:
        description: |-
          Correlation tracking fields
          For correlation alerts: IDs of the contributing alerts that triggered this correlation
        items:
          type: string
        type: array
      correlation_rule_id:
        description: 'For contributing alerts: which correlation rule(s) this alert
          contributed to'
        type: string
      disposition:
        allOf:
        - $ref: '#/definitions/core.AlertDisposition'
        description: 'TASK 102: Disposition workflow fields for analyst verdict'
        example: undetermined
      disposition_reason:
        example: Confirmed malicious activity
        type: string
      disposition_set_at:
        type: string
      disposition_set_by:
        example: analyst@company.com
        type: string
      duplicate_count:
        type: integer
      event:
        $ref: '#/definitions/cerberus_core.Event'
      event_id:
        example: event-456
        type: string
      event_ids:
        items:
          type: string
        type: array
      fingerprint:
        type: string
      investigation_id:
        example: inv-789
        type: string
      jira_ticket_id:
        example: PROJ-123
        type: string
      last_seen:
        type: string
      mitre_techniques:
        items:
          type: string
        type: array
      occurrence_count:
        description: OccurrenceCount tracks how many times this alert pattern has
          triggered (for aggregated alerts)
        example: 3
        type: integer
      risk_score:
        description: RiskScore is the calculated risk level (0-100) based on asset
          criticality, severity, threat intel
        example: 75
        type: integer
      rule_description:
        type: string
      rule_id:
        example: failed_login
        type: string
      rule_name:
        type: string
      rule_type:
        description: sigma, correlation, cql, ml
        type: string
      severity:
        example: Warning
        type: string
      sla_breached:
        description: SLABreached indicates whether the response SLA was violated
        example: false
        type: boolean
      source:
        description: Source identifies the system that generated the alert (e.g.,
          Windows Security, Splunk, Sysmon)
        example: Windows Security
        type: string
      status:
        allOf:
        - $ref: '#/definitions/core.AlertStatus'
        description: Pending, Acknowledged, Dismissed
        example: Pending
      threat_intel:
        additionalProperties: true
        type: object
      timestamp:
        example: "2023-10-31T12:00:00Z"
        type: string
    type: object
  core.AlertBrief:
    properties:
      alert_id:
        type: string
      rule_id:
        type: string
      rule_name:
        type: string
      severity:
        type: string
      status:
        type: string
      timestamp:
        type: string
    type: object
  core.AlertDisposition:
    enum:
    - undetermined
    - true_positive
    - false_positive
    - benign
    - suspicious
    - inconclusive
    type: string
    x-enum-varnames:
    - DispositionUndetermined
    - DispositionTruePositive
    - DispositionFalsePositive
    - DispositionBenign
    - DispositionSuspicious
    - DispositionInconclusive
  core.AlertLink:
    properties:
      alert_id:
        type: string
      created_at:
        type: string
      created_by:
        type: string
      description:
        type: string
      id:
        type: string
      link_type:
        description: e.g., "related", "duplicate", "escalation"
        type: string
      linked_alert_id:
        type: string
    type: object
  core.AlertLinkRequest:
    properties:
      description:
        type: string
      link_type:
        type: string
      linked_alert_id:
        type: string
    type: object
  core.AlertLinkResponse:
    properties:
      alert_id:
        type: string
      created_at:
        type: string
      created_by:
        type: string
      description:
        type: string
      link_type:
        type: string
      linked_alert:
        $ref: '#/definitions/core.AlertBrief'
    type: object
  core.AlertStatus:
    enum:
    - Pending
    - Acknowledged
    - Investigating
    - Resolved
    - Escalated
    - Closed
    - Dismissed
    - FalsePositive
    type: string
    x-enum-varnames:
    - AlertStatusPending
    - AlertStatusAcknowledged
    - AlertStatusInvestigating
    - AlertStatusResolved
    - AlertStatusEscalated
    - AlertStatusClosed
    - AlertStatusDismissed
    - AlertStatusFalsePositive
  core.CorrelationRule:
    properties:
      actions:
        items:
          $ref: '#/definitions/core.Action'
        type: array
      created_at:
        type: string
      description:
        example: Detects multiple failed logins
        type: string
      id:
        example: correlation_rule_1
        type: string
      name:
        example: Brute Force Detection
        type: string
      sequence:
        description: 'TASK #184: Conditions field removed - use SIGMA correlation
          syntax instead'
        example:
        - user_login
        - user_login
        - user_login
        items:
          type: string
        type: array
      severity:
        example: High
        type: string
      updated_at:
        type: string
      version:
        example: 1
        type: integer
      window:
        description: time window for correlation in nanoseconds
        example: 300000000000
        type: integer
    type: object
  core.Evidence:
    properties:
      alert_id:
        type: string
      description:
        type: string
      filename:
        description: Internal stored filename (UUID)
        type: string
      hash:
        description: SHA-256 hash of file content
        type: string
      id:
        type: string
      investigation_id:
        type: string
      mime_type:
        type: string
      name:
        description: Original filename for display
        type: string
      size:
        type: integer
      type:
        $ref: '#/definitions/core.EvidenceType'
      uploaded_at:
        type: string
      uploaded_by:
        allOf:
        - $ref: '#/definitions/core.UserRef'
        description: Full user reference for API responses
      uploaded_by_id:
        description: User ID who uploaded
        type: string
    type: object
  core.EvidenceType:
    enum:
    - log
    - file
    - screenshot
    - network_capture
    - process_dump
    - other
    type: string
    x-enum-varnames:
    - EvidenceTypeLog
    - EvidenceTypeFile
    - EvidenceTypeScreenshot
    - EvidenceTypeNetworkCapture
    - EvidenceTypeProcessDump
    - EvidenceTypeOther
  core.Investigation:
    properties:
      affected_assets:
        items:
          type: string
        type: array
      alert_ids:
        example:
        - alert-001
        - alert-002
        items:
          type: string
        type: array
      artifacts:
        $ref: '#/definitions/core.InvestigationArtifacts'
      assignee_id:
        example: user123
        type: string
      closed_at:
        type: string
      correlation_rule_id:
        description: CorrelationRuleID is the ID of the correlation rule that triggered
          this investigation
        example: corr-rule-001
        type: string
      created_at:
        example: "2025-01-08T10:23:00Z"
        type: string
      created_by:
        example: user123
        type: string
      description:
        example: Multiple failed login attempts followed by successful authentication
        maxLength: 2000
        type: string
      event_ids:
        example:
        - event-001
        - event-002
        items:
          type: string
        type: array
      investigation_id:
        example: INV-20250108-0042
        type: string
      mitre_tactics:
        example:
        - TA0001
        - TA0006
        items:
          type: string
        type: array
      mitre_techniques:
        example:
        - T1078
        - T1110
        items:
          type: string
        type: array
      ml_feedback:
        $ref: '#/definitions/core.MLFeedback'
      notes:
        items:
          $ref: '#/definitions/core.InvestigationNote'
        type: array
      priority:
        allOf:
        - $ref: '#/definitions/core.InvestigationPriority'
        example: critical
      resolution_category:
        example: incident_contained
        type: string
      status:
        allOf:
        - $ref: '#/definitions/core.InvestigationStatus'
        example: in_progress
      summary:
        maxLength: 5000
        type: string
      tags:
        items:
          type: string
        type: array
      title:
        example: Suspected Lateral Movement
        maxLength: 200
        minLength: 1
        type: string
      trigger_alert_id:
        description: TriggerAlertID is the ID of the correlation alert that spawned
          this investigation (when TriggerSource is "correlation")
        example: alert-corr-001
        type: string
      trigger_source:
        description: |-
          Correlation trigger fields - track how investigation was created
          TriggerSource indicates how this investigation was created ("manual", "correlation", "playbook", "ml_alert")
        example: correlation
        type: string
      updated_at:
        example: "2025-01-08T15:05:00Z"
        type: string
      verdict:
        allOf:
        - $ref: '#/definitions/core.InvestigationVerdict'
        example: true_positive
    required:
    - priority
    - status
    - title
    type: object
  core.InvestigationArtifacts:
    properties:
      files:
        items:
          type: string
        type: array
      hashes:
        items:
          type: string
        type: array
      hosts:
        items:
          type: string
        type: array
      ips:
        items:
          type: string
        type: array
      processes:
        items:
          type: string
        type: array
      users:
        items:
          type: string
        type: array
    type: object
  core.InvestigationNote:
    properties:
      analyst_id:
        type: string
      content:
        type: string
      created_at:
        type: string
      id:
        type: string
    type: object
  core.InvestigationPriority:
    enum:
    - critical
    - high
    - medium
    - low
    type: string
    x-enum-varnames:
    - InvestigationPriorityCritical
    - InvestigationPriorityHigh
    - InvestigationPriorityMedium
    - InvestigationPriorityLow
  core.InvestigationStatus:
    enum:
    - open
    - in_progress
    - in_progress
    - awaiting_review
    - closed
    - resolved
    - false_positive
    type: string
    x-enum-comments:
      InvestigationStatusInvestigating: 'TASK 51.4: Alias for InProgress for backward
        compatibility'
    x-enum-descriptions:
    - ""
    - ""
    - 'TASK 51.4: Alias for InProgress for backward compatibility'
    - ""
    - ""
    - ""
    - ""
    x-enum-varnames:
    - InvestigationStatusOpen
    - InvestigationStatusInProgress
    - InvestigationStatusInvestigating
    - InvestigationStatusAwaitingReview
    - InvestigationStatusClosed
    - InvestigationStatusResolved
    - InvestigationStatusFalsePositive
  core.InvestigationVerdict:
    enum:
    - true_positive
    - false_positive
    - inconclusive
    type: string
    x-enum-varnames:
    - InvestigationVerdictTruePositive
    - InvestigationVerdictFalsePositive
    - InvestigationVerdictInconclusive
  core.MLFeedback:
    properties:
      ml_helpfulness:
        description: very_helpful, somewhat, not_helpful
        type: string
      ml_quality_rating:
        description: 1-5 stars
        type: integer
      use_for_training:
        type: boolean
    type: object
  core.Rule:
    properties:
      actions:
        description: 'TASK #184: Conditions field removed - SIGMA rules use SigmaYAML
          for detection'
        items:
          $ref: '#/definitions/core.Action'
        type: array
      author:
        type: string
      correlation:
        additionalProperties: true
        description: Correlation config
        type: object
      created_at:
        type: string
      description:
        example: Detects multiple failed login attempts
        type: string
      enabled:
        example: true
        type: boolean
      false_positives:
        items:
          type: string
        type: array
      id:
        example: failed_login
        type: string
      logsource_category:
        description: |-
          Denormalized logsource fields for efficient querying and filtering of SIGMA rules
          LogsourceCategory represents the general category of logs (e.g., "process_creation", "network_connection")
        type: string
      logsource_product:
        description: LogsourceProduct represents the product generating the logs (e.g.,
          "windows", "linux", "azure")
        type: string
      logsource_service:
        description: LogsourceService represents the specific service within the product
          (e.g., "sysmon", "security", "application")
        type: string
      metadata:
        additionalProperties: true
        type: object
      mitre_tactics:
        items:
          type: string
        type: array
      mitre_techniques:
        items:
          type: string
        type: array
      name:
        example: Failed User Login
        type: string
      query:
        description: CQL query string
        type: string
      references:
        items:
          type: string
        type: array
      severity:
        example: Warning
        type: string
      sigma_yaml:
        description: |-
          TASK #184: Detection and Logsource fields removed - use SigmaYAML instead
          SigmaYAML contains the complete SIGMA rule in YAML format for SIGMA-type rules
        type: string
      tags:
        items:
          type: string
        type: array
      type:
        description: '''sigma'' or ''cql'''
        example: sigma
        type: string
      updated_at:
        type: string
      version:
        example: 1
        type: integer
    type: object
  core.StatusChange:
    properties:
      alert_id:
        type: string
      changed_at:
        type: string
      changed_by:
        type: string
      from_status:
        $ref: '#/definitions/core.AlertStatus'
      note:
        type: string
      to_status:
        $ref: '#/definitions/core.AlertStatus'
    type: object
  core.UserRef:
    properties:
      avatar_url:
        type: string
      email:
        type: string
      id:
        type: string
      name:
        type: string
      role:
        type: string
    type: object
  detect.ConditionFailure:
    properties:
      actual:
        type: string
      condition:
        type: string
      expected:
        type: string
      reason:
        type: string
    type: object
  detect.MatchResult:
    properties:
      event:
        $ref: '#/definitions/cerberus_core.Event'
      explanation:
        type: string
      failed_conditions:
        items:
          $ref: '#/definitions/detect.ConditionFailure'
        type: array
      matched:
        type: boolean
      matched_conditions:
        items:
          type: string
        type: array
    type: object
  feeds.FeedStats:
    properties:
      failed_rules:
        type: integer
      imported_rules:
        type: integer
      last_error:
        type: string
      last_sync_duration:
        description: seconds
        type: number
      skipped_rules:
        type: integer
      sync_count:
        type: integer
      total_rules:
        type: integer
      updated_rules:
        type: integer
    type: object
  feeds.FeedSyncResult:
    properties:
      duration:
        type: number
      end_time:
        type: string
      errors:
        items:
          type: string
        type: array
      feed_id:
        type: string
      feed_name:
        type: string
      rule_results:
        items:
          $ref: '#/definitions/feeds.RuleImportResult'
        type: array
      start_time:
        type: string
      stats:
        $ref: '#/definitions/feeds.FeedStats'
      success:
        type: boolean
    type: object
  feeds.FeedTemplate:
    properties:
      branch:
        type: string
      description:
        type: string
      estimated_rule_count:
        type: integer
      exclude_paths:
        items:
          type: string
        type: array
      id:
        type: string
      include_paths:
        items:
          type: string
        type: array
      name:
        type: string
      recommended_priority:
        type: integer
      tags:
        items:
          type: string
        type: array
      type:
        type: string
      url:
        type: string
    type: object
  feeds.RuleFeed:
    properties:
      auth_config:
        additionalProperties: true
        type: object
      auto_enable_rules:
        type: boolean
      branch:
        description: For git
        type: string
      created_at:
        type: string
      created_by:
        type: string
      description:
        type: string
      enabled:
        type: boolean
      exclude_paths:
        items:
          type: string
        type: array
      exclude_tags:
        items:
          type: string
        type: array
      id:
        type: string
      include_paths:
        description: Import configuration
        items:
          type: string
        type: array
      include_tags:
        items:
          type: string
        type: array
      last_sync:
        type: string
      metadata:
        additionalProperties:
          type: string
        type: object
      min_severity:
        type: string
      name:
        type: string
      next_sync:
        type: string
      path:
        description: For filesystem
        type: string
      priority:
        description: Higher = takes precedence
        type: integer
      stats:
        allOf:
        - $ref: '#/definitions/feeds.FeedStats'
        description: Statistics
      status:
        type: string
      tags:
        description: Metadata
        items:
          type: string
        type: array
      type:
        description: git, http, filesystem, api
        type: string
      update_schedule:
        description: Cron format
        type: string
      update_strategy:
        description: Update strategy
        type: string
      updated_at:
        type: string
      url:
        description: Connection details
        type: string
    type: object
  feeds.RuleImportResult:
    properties:
      action:
        description: imported, updated, skipped, failed
        type: string
      error:
        type: string
      file_path:
        type: string
      reason:
        type: string
      rule_id:
        type: string
      rule_title:
        type: string
    type: object
  ingest.DLQEvent:
    properties:
      createdAt:
        type: string
      errorDetails:
        type: string
      errorReason:
        type: string
      id:
        format: int64
        type: integer
      listenerID:
        type: string
      protocol:
        type: string
      rawEvent:
        type: string
      retries:
        type: integer
      sourceIP:
        type: string
      status:
        description: '''pending'', ''replayed'', ''discarded'''
        type: string
      timestamp:
        type: string
    type: object
  mitre.DataSource:
    properties:
      created:
        type: string
      description:
        type: string
      external_references:
        items:
          $ref: '#/definitions/mitre.ExternalReference'
        type: array
      id:
        type: string
      modified:
        type: string
      name:
        type: string
      spec_version:
        type: string
      type:
        type: string
      x_mitre_collection_layers:
        items:
          type: string
        type: array
      x_mitre_domains:
        items:
          type: string
        type: array
      x_mitre_platforms:
        items:
          type: string
        type: array
      x_mitre_version:
        type: string
    type: object
  mitre.ExternalReference:
    properties:
      description:
        type: string
      external_id:
        type: string
      source_name:
        type: string
      url:
        type: string
    type: object
  mitre.KillChainPhase:
    properties:
      kill_chain_name:
        type: string
      phase_name:
        description: This is the tactic name
        type: string
    type: object
  mitre.Tactic:
    properties:
      created:
        type: string
      description:
        type: string
      external_references:
        items:
          $ref: '#/definitions/mitre.ExternalReference'
        type: array
      id:
        type: string
      modified:
        type: string
      name:
        type: string
      spec_version:
        type: string
      type:
        type: string
      x_mitre_deprecated:
        type: boolean
      x_mitre_domains:
        items:
          type: string
        type: array
      x_mitre_shortname:
        type: string
      x_mitre_version:
        type: string
    type: object
  mitre.Technique:
    properties:
      created:
        type: string
      description:
        type: string
      external_references:
        items:
          $ref: '#/definitions/mitre.ExternalReference'
        type: array
      id:
        type: string
      kill_chain_phases:
        items:
          $ref: '#/definitions/mitre.KillChainPhase'
        type: array
      modified:
        type: string
      name:
        type: string
      revoked:
        type: boolean
      spec_version:
        type: string
      type:
        type: string
      x_mitre_data_sources:
        items:
          type: string
        type: array
      x_mitre_defense_bypassed:
        items:
          type: string
        type: array
      x_mitre_deprecated:
        type: boolean
      x_mitre_detection:
        type: string
      x_mitre_domains:
        items:
          type: string
        type: array
      x_mitre_effective_permissions:
        items:
          type: string
        type: array
      x_mitre_impact_type:
        items:
          type: string
        type: array
      x_mitre_is_subtechnique:
        type: boolean
      x_mitre_permissions_required:
        items:
          type: string
        type: array
      x_mitre_platforms:
        items:
          type: string
        type: array
      x_mitre_remote_support:
        type: boolean
      x_mitre_system_requirements:
        items:
          type: string
        type: array
      x_mitre_version:
        type: string
    type: object
  ml.TrainingPerformance:
    properties:
      algorithmMetrics:
        additionalProperties:
          format: float64
          type: number
        type: object
      driftDetected:
        type: boolean
      sampleCount:
        format: int64
        type: integer
      timestamp:
        type: string
      trainingDuration:
        $ref: '#/definitions/time.Duration'
      validationScore:
        format: float64
        type: number
    type: object
  soar.ActionResult:
    properties:
      action_type:
        $ref: '#/definitions/soar.ActionType'
      completed_at:
        type: string
      duration:
        $ref: '#/definitions/time.Duration'
      error:
        type: string
      message:
        type: string
      output:
        additionalProperties: true
        type: object
      started_at:
        type: string
      status:
        $ref: '#/definitions/soar.ActionStatus'
    type: object
  soar.ActionStatus:
    enum:
    - pending
    - running
    - completed
    - failed
    - skipped
    type: string
    x-enum-varnames:
    - ActionStatusPending
    - ActionStatusRunning
    - ActionStatusCompleted
    - ActionStatusFailed
    - ActionStatusSkipped
  soar.ActionType:
    enum:
    - block_ip
    - isolate_host
    - quarantine_file
    - send_notification
    - enrich_ioc
    - create_ticket
    - update_alert
    - call_webhook
    - run_script
    type: string
    x-enum-varnames:
    - ActionTypeBlock
    - ActionTypeIsolate
    - ActionTypeQuarantine
    - ActionTypeNotify
    - ActionTypeEnrich
    - ActionTypeCreateTicket
    - ActionTypeUpdateAlert
    - ActionTypeWebhook
    - ActionTypeScript
  soar.ApprovalAction:
    properties:
      action:
        $ref: '#/definitions/soar.ApprovalActionType'
      approval_id:
        type: string
      comment:
        type: string
      created_at:
        type: string
      id:
        type: string
      user_id:
        type: string
      username:
        type: string
    type: object
  soar.ApprovalActionType:
    enum:
    - approve
    - reject
    - escalate
    - comment
    type: string
    x-enum-varnames:
    - ApprovalActionApprove
    - ApprovalActionReject
    - ApprovalActionEscalate
    - ApprovalActionComment
  soar.ApprovalConfig:
    properties:
      allow_self_approval:
        type: boolean
      escalation_config:
        $ref: '#/definitions/soar.EscalationConfig'
      min_approvers:
        description: Minimum number of approvers
        type: integer
      mode:
        $ref: '#/definitions/soar.ApprovalMode'
      required:
        type: boolean
      required_approvers:
        description: User IDs or role names
        items:
          type: string
        type: array
      timeout_minutes:
        description: Auto-expire after this time
        type: integer
    type: object
  soar.ApprovalMode:
    enum:
    - any
    - all
    - majority
    type: string
    x-enum-varnames:
    - ApprovalModeAny
    - ApprovalModeAll
    - ApprovalModeMajority
  soar.ApprovalRequest:
    properties:
      alert_id:
        type: string
      approval_count:
        type: integer
      context:
        additionalProperties: true
        description: Alert details, step params, etc.
        type: object
      created_at:
        type: string
      escalation_level:
        type: integer
      execution_id:
        type: string
      expires_at:
        type: string
      id:
        type: string
      min_approvers:
        type: integer
      mode:
        $ref: '#/definitions/soar.ApprovalMode'
      playbook_id:
        type: string
      playbook_name:
        type: string
      rejection_count:
        type: integer
      requested_by:
        type: string
      required_approvers:
        items:
          type: string
        type: array
      resolved_at:
        type: string
      status:
        $ref: '#/definitions/soar.ApprovalStatus'
      step_id:
        type: string
      step_name:
        type: string
      updated_at:
        type: string
      version:
        description: For optimistic locking
        type: integer
    type: object
  soar.ApprovalStats:
    properties:
      avg_response_time_minutes:
        type: number
      total_approved:
        type: integer
      total_escalated:
        type: integer
      total_expired:
        type: integer
      total_pending:
        type: integer
      total_rejected:
        type: integer
    type: object
  soar.ApprovalStatus:
    enum:
    - pending
    - approved
    - rejected
    - expired
    - escalated
    - cancelled
    type: string
    x-enum-varnames:
    - ApprovalStatusPending
    - ApprovalStatusApproved
    - ApprovalStatusRejected
    - ApprovalStatusExpired
    - ApprovalStatusEscalated
    - ApprovalStatusCancelled
  soar.EscalationConfig:
    properties:
      enabled:
        type: boolean
      escalate_after_mins:
        type: integer
      escalate_to:
        description: User IDs or roles to escalate to
        items:
          type: string
        type: array
      max_escalation_level:
        type: integer
    type: object
  soar.Playbook:
    properties:
      created_at:
        type: string
      created_by:
        type: string
      description:
        type: string
      enabled:
        type: boolean
      id:
        type: string
      name:
        type: string
      priority:
        description: Higher priority runs first
        type: integer
      steps:
        items:
          $ref: '#/definitions/soar.PlaybookStep'
        type: array
      tags:
        items:
          type: string
        type: array
      triggers:
        items:
          $ref: '#/definitions/soar.PlaybookTrigger'
        type: array
      updated_at:
        type: string
    type: object
  soar.PlaybookCondition:
    properties:
      field:
        type: string
      operator:
        description: eq, ne, gt, lt, contains, matches
        type: string
      value: {}
    type: object
  soar.PlaybookStep:
    properties:
      action_type:
        $ref: '#/definitions/soar.ActionType'
      approval:
        allOf:
        - $ref: '#/definitions/soar.ApprovalConfig'
        description: Approval requirements for this step
      conditions:
        items:
          $ref: '#/definitions/soar.PlaybookCondition'
        type: array
      continue_on_error:
        type: boolean
      id:
        type: string
      name:
        type: string
      parameters:
        additionalProperties: true
        type: object
      timeout:
        $ref: '#/definitions/time.Duration'
    type: object
  soar.PlaybookTrigger:
    properties:
      conditions:
        items:
          $ref: '#/definitions/soar.PlaybookCondition'
        type: array
      type:
        description: alert, severity, rule_id, ioc_type
        type: string
    type: object
  storage.DynamicListener:
    properties:
      cert_file:
        type: string
      created_at:
        type: string
      created_by:
        type: string
      description:
        type: string
      error_count:
        type: integer
      events_per_minute:
        type: number
      events_received:
        type: integer
      field_mapping:
        description: Field mapping to use for normalization
        type: string
      host:
        type: string
      id:
        type: string
      key_file:
        type: string
      last_event:
        type: string
      name:
        type: string
      port:
        type: integer
      protocol:
        description: tcp, udp, tls
        type: string
      source:
        type: string
      started_at:
        type: string
      status:
        description: stopped, starting, running, error
        type: string
      stopped_at:
        type: string
      tags:
        items:
          type: string
        type: array
      tls:
        type: boolean
      type:
        description: syslog, cef, json, fluentd, fluentbit
        type: string
      updated_at:
        type: string
    type: object
  storage.ListenerStats:
    properties:
      error_count:
        type: integer
      error_rate:
        type: number
      events_per_minute:
        type: number
      events_received:
        type: integer
      last_event:
        type: string
      uptime_duration:
        type: number
    type: object
  storage.ModelMetadata:
    properties:
      algorithm:
        description: 'TASK 37: zscore, iqr, isolation_forest'
        type: string
      createdAt:
        description: 'TASK 37: Creation timestamp'
        type: string
      filePath:
        description: 'TASK 37: Path to serialized model file (optional)'
        type: string
      hyperparameters:
        description: 'TASK 37: JSON hyperparameters'
        type: string
      metrics:
        description: 'JSON string (performance metrics: precision, recall, F1)'
        type: string
      modelType:
        type: string
      name:
        type: string
      status:
        description: 'TASK 37: active, retired, training'
        type: string
      trainedAt:
        type: string
      trainingCompletedAt:
        description: 'TASK 37: When training finished'
        type: string
      trainingSamples:
        description: 'TASK 37: Number of samples used for training'
        type: integer
      trainingStartedAt:
        description: 'TASK 37: When training began'
        type: string
      version:
        type: string
    type: object
  storage.Permission:
    enum:
    - read:events
    - read:alerts
    - alert:acknowledge
    - alert:comment
    - alert:disposition
    - alert:assign
    - investigations:create
    - read:investigations
    - write:investigations
    - read:rules
    - write:rules
    - read:actions
    - write:actions
    - read:users
    - write:users
    - admin:system
    - read:listeners
    - write:listeners
    type: string
    x-enum-comments:
      PermAcknowledgeAlerts: 'TASK 31: Alert acknowledge permission'
      PermAssignAlerts: 'TASK 105: Alert assignment permission'
      PermCommentAlerts: 'TASK 31: Alert comment permission'
      PermCreateInvestigations: 'TASK 106: Investigation creation permission'
      PermDispositionAlerts: 'TASK 104: Alert disposition permission'
      PermReadInvestigations: Investigation read permission (view, list, evidence
        download)
      PermWriteInvestigations: Investigation write permission (update, evidence upload/delete)
    x-enum-descriptions:
    - ""
    - ""
    - 'TASK 31: Alert acknowledge permission'
    - 'TASK 31: Alert comment permission'
    - 'TASK 104: Alert disposition permission'
    - 'TASK 105: Alert assignment permission'
    - 'TASK 106: Investigation creation permission'
    - Investigation read permission (view, list, evidence download)
    - Investigation write permission (update, evidence upload/delete)
    - ""
    - ""
    - ""
    - ""
    - ""
    - ""
    - ""
    - ""
    - ""
    x-enum-varnames:
    - PermReadEvents
    - PermReadAlerts
    - PermAcknowledgeAlerts
    - PermCommentAlerts
    - PermDispositionAlerts
    - PermAssignAlerts
    - PermCreateInvestigations
    - PermReadInvestigations
    - PermWriteInvestigations
    - PermReadRules
    - PermWriteRules
    - PermReadActions
    - PermWriteActions
    - PermReadUsers
    - PermWriteUsers
    - PermAdminSystem
    - PermReadListeners
    - PermWriteListeners
  storage.PlaybookStats:
    properties:
      disabled_playbooks:
        type: integer
      enabled_playbooks:
        type: integer
      total_playbooks:
        type: integer
    type: object
  storage.Role:
    properties:
      created_at:
        type: string
      description:
        type: string
      id:
        type: integer
      name:
        type: string
      permissions:
        items:
          $ref: '#/definitions/storage.Permission'
        type: array
      updated_at:
        type: string
    type: object
  storage.User:
    properties:
      active:
        type: boolean
      created_at:
        type: string
      locked_until:
        description: Account lockout expiration
        type: string
      mfa_enabled:
        description: Whether MFA is enabled
        type: boolean
      must_change_password:
        description: 'TASK 38.3: Force password change on first login'
        type: boolean
      password_changed_at:
        description: Last password change time (for password expiry)
        type: string
      role_id:
        description: Foreign key to roles table
        type: integer
      role_name:
        description: Denormalized for convenience
        type: string
      roles:
        description: 'DEPRECATED: Legacy field for backward compatibility'
        items:
          type: string
        type: array
      updated_at:
        type: string
      username:
        type: string
    type: object
  time.Duration:
    enum:
    - -9223372036854775808
    - 9223372036854775807
    - 1
    - 1000
    - 1000000
    - 1000000000
    - 60000000000
    - 3600000000000
    format: int64
    type: integer
    x-enum-varnames:
    - minDuration
    - maxDuration
    - Nanosecond
    - Microsecond
    - Millisecond
    - Second
    - Minute
    - Hour
info:
  contact: {}
paths:
  /alerts/{id}:
    delete:
      description: Permanently deletes an alert by ID
      parameters:
      - description: Alert ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Delete alert
      tags:
      - alerts
  /alerts/{id}/assign:
    put:
      consumes:
      - application/json
      description: Assigns an alert to a user
      parameters:
      - description: Alert ID
        in: path
        name: id
        required: true
        type: string
      - description: Assignment request
        in: body
        name: request
        required: true
        schema:
          additionalProperties:
            type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Assign alert
      tags:
      - alerts
  /alerts/{id}/history:
    get:
      description: Returns the status change history for an alert
      parameters:
      - description: Alert ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/core.StatusChange'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Get alert status history
      tags:
      - alerts
  /alerts/{id}/status:
    put:
      consumes:
      - application/json
      description: Updates an alert's status to any valid status value
      parameters:
      - description: Alert ID
        in: path
        name: id
        required: true
        type: string
      - description: Status update request
        in: body
        name: request
        required: true
        schema:
          properties:
            note:
              type: string
            status:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Update alert status
      tags:
      - alerts
  /api/actions:
    get:
      consumes:
      - application/json
      description: Returns a list of all actions
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/core.Action'
            type: array
        "503":
          description: Action storage not available
          schema:
            type: string
      summary: Get actions
      tags:
      - actions
    post:
      consumes:
      - application/json
      description: Create a new action
      parameters:
      - description: Action object
        in: body
        name: action
        required: true
        schema:
          $ref: '#/definitions/core.Action'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/core.Action'
        "400":
          description: Invalid JSON
          schema:
            type: string
        "503":
          description: Action storage not available
          schema:
            type: string
      summary: Create action
      tags:
      - actions
  /api/actions/{id}:
    delete:
      consumes:
      - application/json
      description: Delete an action by ID
      parameters:
      - description: Action ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Action deleted
          schema:
            type: string
        "404":
          description: Action not found
          schema:
            type: string
        "503":
          description: Action storage not available
          schema:
            type: string
      summary: Delete action
      tags:
      - actions
    get:
      consumes:
      - application/json
      description: Get an action by ID
      parameters:
      - description: Action ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Action'
        "404":
          description: Action not found
          schema:
            type: string
        "503":
          description: Action storage not available
          schema:
            type: string
      summary: Get action
      tags:
      - actions
    put:
      consumes:
      - application/json
      description: Update an existing action
      parameters:
      - description: Action ID
        in: path
        name: id
        required: true
        type: string
      - description: Action object
        in: body
        name: action
        required: true
        schema:
          $ref: '#/definitions/core.Action'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Action'
        "400":
          description: Invalid JSON
          schema:
            type: string
        "404":
          description: Action not found
          schema:
            type: string
        "503":
          description: Action storage not available
          schema:
            type: string
      summary: Update action
      tags:
      - actions
  /api/alerts:
    get:
      description: |-
        Retrieves a paginated list of alerts with filtering, sorting, and search.

        **Disposition Filters Behavior:**
        - `disposition`: Filter by specific values (case-insensitive). Multiple values allowed.
        - `has_disposition`: Boolean filter (true=any verdict set, false=undetermined only)

        **Conflicting Filter Auto-Resolution:**
        When both filters are specified, conflicts are automatically resolved:
        - `has_disposition=true&disposition=undetermined`: undetermined is removed from disposition filter
        - `has_disposition=false&disposition=[any value]`: disposition filter is ignored (only undetermined returned)

        Invalid disposition values are silently ignored. Maximum 10 disposition values per request.
      parameters:
      - description: Page number (default 1)
        in: query
        name: page
        type: integer
      - description: Items per page (default 100, max 10000)
        in: query
        name: limit
        type: integer
      - description: Search query (title, description, rule name)
        in: query
        name: q
        type: string
      - description: Filter by severity (critical, high, medium, low)
        in: query
        name: severity
        type: string
      - description: Filter by status (pending, acknowledged, investigating, resolved,
          escalated, closed)
        in: query
        name: status
        type: string
      - description: Filter by rule ID
        in: query
        name: rule_id
        type: string
      - description: Filter by assignee username
        in: query
        name: assigned_to
        type: string
      - description: Filter by tags
        in: query
        name: tags
        type: string
      - description: Filter by disposition (true_positive, false_positive, benign,
          undetermined). Case-insensitive. Multiple values allowed.
        in: query
        name: disposition
        type: string
      - description: Filter by disposition status (true = any verdict set, false =
          undetermined only)
        in: query
        name: has_disposition
        type: boolean
      - description: Filter by MITRE tactic
        in: query
        name: mitre_tactic
        type: string
      - description: Filter by MITRE technique
        in: query
        name: mitre_technique
        type: string
      - description: Filter by creation date (RFC3339)
        in: query
        name: created_after
        type: string
      - description: Filter by creation date (RFC3339)
        in: query
        name: created_before
        type: string
      - description: Filter by update date (RFC3339)
        in: query
        name: updated_after
        type: string
      - description: Filter by update date (RFC3339)
        in: query
        name: updated_before
        type: string
      - description: Sort field (created_at, updated_at, severity, status) with optional
          - prefix for desc
        in: query
        name: sort
        type: string
      - description: Sort order (asc, desc)
        in: query
        name: sort_order
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.PaginationResponse'
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get alerts
      tags:
      - alerts
  /api/alerts/{id}/acknowledge:
    put:
      consumes:
      - application/json
      description: Updates an alert status to acknowledged
      parameters:
      - description: Alert ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad request
          schema:
            type: string
        "404":
          description: Alert not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Acknowledge an alert
      tags:
      - alerts
  /api/alerts/{id}/assignee:
    patch:
      consumes:
      - application/json
      description: Updates an alert's assignee with nullable support for unassignment
      parameters:
      - description: Alert ID
        in: path
        name: id
        required: true
        type: string
      - description: Assignee update
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.UpdateAssigneeRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.UpdateAssigneeResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Update alert assignee
      tags:
      - alerts
  /api/alerts/{id}/dismiss:
    post:
      consumes:
      - application/json
      description: Mark an alert as dismissed
      parameters:
      - description: Alert ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Alert not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Dismiss alert
      tags:
      - alerts
  /api/alerts/{id}/disposition:
    patch:
      consumes:
      - application/json
      description: Updates an alert's disposition (analyst verdict) with reason and
        audit logging
      parameters:
      - description: Alert ID
        in: path
        name: id
        required: true
        type: string
      - description: Disposition update
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.UpdateDispositionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.UpdateDispositionResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Update alert disposition
      tags:
      - alerts
  /api/alerts/{id}/investigation:
    patch:
      consumes:
      - application/json
      description: Links an alert to an existing investigation (bidirectional linking)
      parameters:
      - description: Alert ID
        in: path
        name: id
        required: true
        type: string
      - description: Investigation to link
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/api.LinkInvestigationRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.LinkInvestigationResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "401":
          description: Authentication required
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Alert or investigation not found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Link alert to existing investigation
      tags:
      - alerts
    post:
      consumes:
      - application/json
      description: Creates a new investigation from an alert with auto-generated title/description
      parameters:
      - description: Alert ID
        in: path
        name: id
        required: true
        type: string
      - description: Optional investigation details
        in: body
        name: body
        schema:
          $ref: '#/definitions/api.CreateInvestigationFromAlertRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/api.CreateInvestigationFromAlertResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "401":
          description: Authentication required
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "409":
          description: Alert already linked to an investigation
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Create investigation from alert
      tags:
      - alerts
  /api/auth/config:
    get:
      description: Returns authentication configuration for client-side use (public
        endpoint, no sensitive data)
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Get authentication configuration
      tags:
      - auth
  /api/auth/status:
    get:
      description: Check if the current request is authenticated and return user info
        with CSRF token
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            type: string
      summary: Check authentication status
      tags:
      - auth
  /api/correlation-rules:
    get:
      consumes:
      - application/json
      description: Returns a list of all correlation rules
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/core.CorrelationRule'
            type: array
        "503":
          description: Correlation rule storage not available
          schema:
            type: string
      summary: Get correlation rules
      tags:
      - correlation-rules
    post:
      consumes:
      - application/json
      description: Create a new correlation rule
      parameters:
      - description: Correlation Rule object
        in: body
        name: rule
        required: true
        schema:
          $ref: '#/definitions/core.CorrelationRule'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/core.CorrelationRule'
        "400":
          description: Invalid JSON
          schema:
            type: string
        "503":
          description: Correlation rule storage not available
          schema:
            type: string
      summary: Create correlation rule
      tags:
      - correlation-rules
  /api/correlation-rules/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a correlation rule by ID
      parameters:
      - description: Correlation Rule ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Correlation rule deleted
          schema:
            type: string
        "404":
          description: Correlation rule not found
          schema:
            type: string
        "503":
          description: Correlation rule storage not available
          schema:
            type: string
      summary: Delete correlation rule
      tags:
      - correlation-rules
    get:
      consumes:
      - application/json
      description: Get a correlation rule by ID
      parameters:
      - description: Correlation Rule ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.CorrelationRule'
        "404":
          description: Correlation rule not found
          schema:
            type: string
        "503":
          description: Correlation rule storage not available
          schema:
            type: string
      summary: Get correlation rule
      tags:
      - correlation-rules
    put:
      consumes:
      - application/json
      description: Update an existing correlation rule
      parameters:
      - description: Correlation Rule ID
        in: path
        name: id
        required: true
        type: string
      - description: Correlation Rule object
        in: body
        name: rule
        required: true
        schema:
          $ref: '#/definitions/core.CorrelationRule'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.CorrelationRule'
        "400":
          description: Invalid JSON
          schema:
            type: string
        "404":
          description: Correlation rule not found
          schema:
            type: string
        "503":
          description: Correlation rule storage not available
          schema:
            type: string
      summary: Update correlation rule
      tags:
      - correlation-rules
  /api/dashboard:
    get:
      consumes:
      - application/json
      description: Returns dashboard statistics
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "503":
          description: Storage not available
          schema:
            type: string
      summary: Get dashboard stats
      tags:
      - dashboard
  /api/dashboard/chart:
    get:
      consumes:
      - application/json
      description: Returns historical chart data for events and alerts
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              additionalProperties: true
              type: object
            type: array
        "503":
          description: Storage not available
          schema:
            type: string
      summary: Get dashboard chart data
      tags:
      - dashboard
  /api/events:
    get:
      consumes:
      - application/json
      description: Returns a list of recent security events
      parameters:
      - default: 100
        description: Maximum number of results (1-1000)
        in: query
        maximum: 1000
        minimum: 1
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/cerberus_core.Event'
            type: array
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get events
      tags:
      - events
  /api/rules:
    get:
      consumes:
      - application/json
      description: Returns a paginated list of detection rules
      parameters:
      - description: 'Page number (default: 1)'
        in: query
        name: page
        type: integer
      - description: 'Items per page (default: 50, max: 1000)'
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Paginated rules response
          schema:
            additionalProperties: true
            type: object
        "503":
          description: Rule storage not available
          schema:
            type: string
      summary: Get rules
      tags:
      - rules
    post:
      consumes:
      - application/json
      description: Create a new detection rule
      parameters:
      - description: Rule object
        in: body
        name: rule
        required: true
        schema:
          $ref: '#/definitions/core.Rule'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/core.Rule'
        "400":
          description: Invalid JSON
          schema:
            type: string
        "503":
          description: Rule storage not available
          schema:
            type: string
      summary: Create rule
      tags:
      - rules
  /api/rules/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a detection rule by ID
      parameters:
      - description: Rule ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Rule deleted
          schema:
            type: string
        "404":
          description: Rule not found
          schema:
            type: string
        "503":
          description: Rule storage not available
          schema:
            type: string
      summary: Delete rule
      tags:
      - rules
    put:
      consumes:
      - application/json
      description: Update an existing detection rule
      parameters:
      - description: Rule ID
        in: path
        name: id
        required: true
        type: string
      - description: Rule object
        in: body
        name: rule
        required: true
        schema:
          $ref: '#/definitions/core.Rule'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Rule'
        "400":
          description: Invalid JSON
          schema:
            type: string
        "404":
          description: Rule not found
          schema:
            type: string
        "503":
          description: Rule storage not available
          schema:
            type: string
      summary: Update rule
      tags:
      - rules
  /api/users/assignable:
    get:
      description: Returns a list of active users who can be assigned to alerts
      parameters:
      - description: Filter by username (case-insensitive contains)
        in: query
        name: search
        type: string
      - description: Maximum users to return (1-500, default 100)
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.AssignableUsersResponse'
        "400":
          description: Invalid parameters
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "401":
          description: Authentication required
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Get assignable users
      tags:
      - alerts
      - users
  /api/v1/alerts/{id}:
    get:
      description: Retrieves a single alert by its ID
      parameters:
      - description: Alert ID (UUID format)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Alert'
        "400":
          description: Invalid alert ID format
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Alert not found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Get alert by ID
      tags:
      - alerts
  /api/v1/alerts/{id}/evidence:
    get:
      description: Get all evidence files attached to an alert
      parameters:
      - description: Alert ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/core.Evidence'
            type: array
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: List evidence
      tags:
      - evidence
    post:
      consumes:
      - multipart/form-data
      description: Upload an evidence file and attach it to an alert
      parameters:
      - description: Alert ID
        in: path
        name: id
        required: true
        type: string
      - description: Evidence file
        in: formData
        name: file
        required: true
        type: file
      - description: Description of the evidence
        in: formData
        name: description
        type: string
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/core.Evidence'
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Alert not found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "413":
          description: File too large
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Upload evidence
      tags:
      - evidence
  /api/v1/alerts/{id}/evidence/{evidence_id}:
    delete:
      description: Delete an evidence file from an alert
      parameters:
      - description: Alert ID
        in: path
        name: id
        required: true
        type: string
      - description: Evidence ID
        in: path
        name: evidence_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No content
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Evidence not found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Delete evidence
      tags:
      - evidence
    get:
      description: Download a specific evidence file
      parameters:
      - description: Alert ID
        in: path
        name: id
        required: true
        type: string
      - description: Evidence ID
        in: path
        name: evidence_id
        required: true
        type: string
      produces:
      - application/octet-stream
      responses:
        "200":
          description: OK
          schema:
            type: file
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Evidence not found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Download evidence
      tags:
      - evidence
  /api/v1/alerts/{id}/evidence/{evidence_id}/download:
    get:
      description: Download a specific evidence file (alternate endpoint)
      parameters:
      - description: Alert ID
        in: path
        name: id
        required: true
        type: string
      - description: Evidence ID
        in: path
        name: evidence_id
        required: true
        type: string
      produces:
      - application/octet-stream
      responses:
        "200":
          description: OK
          schema:
            type: file
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Evidence not found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Download evidence file
      tags:
      - evidence
  /api/v1/alerts/{id}/related:
    get:
      description: Get all alerts that are linked to the specified alert
      parameters:
      - description: Alert ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/core.AlertLinkResponse'
            type: array
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: List related alerts
      tags:
      - alerts
    post:
      consumes:
      - application/json
      description: Create a bi-directional relationship between two alerts. This operation
        is idempotent - if the link already exists, returns 200 OK with the existing
        link.
      parameters:
      - description: Alert ID
        in: path
        name: id
        required: true
        type: string
      - description: Link request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/core.AlertLinkRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Link already exists (idempotent)
          schema:
            $ref: '#/definitions/core.AlertLink'
        "201":
          description: Link created
          schema:
            $ref: '#/definitions/core.AlertLink'
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Alert not found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Link alerts
      tags:
      - alerts
  /api/v1/alerts/{id}/related/{related_id}:
    delete:
      description: Remove the bi-directional relationship between two alerts. This
        operation is idempotent - if the link doesn't exist, returns 204 No Content.
      parameters:
      - description: Alert ID
        in: path
        name: id
        required: true
        type: string
      - description: Related Alert ID to unlink
        in: path
        name: related_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No content (link deleted or didn't exist)
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Unlink alerts
      tags:
      - alerts
  /api/v1/approvals:
    get:
      description: Retrieve approval requests with optional filtering by status, playbook,
        alert
      parameters:
      - description: Filter by status (pending, approved, rejected, expired, escalated)
        in: query
        name: status
        type: string
      - description: Filter by playbook ID
        in: query
        name: playbook_id
        type: string
      - description: Filter by alert ID
        in: query
        name: alert_id
        type: string
      - description: Filter by approver ID
        in: query
        name: approver_id
        type: string
      - description: 'Page number (default: 1)'
        in: query
        name: page
        type: integer
      - description: 'Items per page (default: 50, max: 100)'
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.ApprovalListResponse'
        "500":
          description: Server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List approval requests
      tags:
      - approvals
  /api/v1/approvals/{id}:
    delete:
      description: Cancel a pending approval request
      parameters:
      - description: Approval request ID
        in: path
        name: id
        required: true
        type: string
      responses:
        "204":
          description: Approval cancelled
        "400":
          description: Invalid request or approval not pending
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Approval not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Cancel approval request
      tags:
      - approvals
    get:
      description: Retrieve a specific approval request by ID
      parameters:
      - description: Approval request ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/soar.ApprovalRequest'
        "404":
          description: Approval not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get approval request
      tags:
      - approvals
    patch:
      consumes:
      - application/json
      description: Approve, reject, escalate, or comment on an approval request
      parameters:
      - description: Approval request ID
        in: path
        name: id
        required: true
        type: string
      - description: Action to perform
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.ApprovalActionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Updated approval request
          schema:
            $ref: '#/definitions/soar.ApprovalRequest'
        "400":
          description: Invalid request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Approval not found
          schema:
            additionalProperties:
              type: string
            type: object
        "409":
          description: Conflict - optimistic lock failed
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Process approval action
      tags:
      - approvals
  /api/v1/approvals/{id}/actions:
    get:
      description: Retrieve the history of actions for an approval request
      parameters:
      - description: Approval request ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/soar.ApprovalAction'
            type: array
        "404":
          description: Approval not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get approval actions
      tags:
      - approvals
  /api/v1/approvals/expire:
    post:
      description: Manually trigger expiration check for expired approval requests
      produces:
      - application/json
      responses:
        "200":
          description: Expiration result
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Expire approvals
      tags:
      - approvals
  /api/v1/approvals/pending:
    get:
      description: Retrieve pending approval requests where the current user is an
        authorized approver
      parameters:
      - description: 'Items per page (default: 50, max: 100)'
        in: query
        name: limit
        type: integer
      - description: 'Offset (default: 0)'
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/soar.ApprovalRequest'
            type: array
        "500":
          description: Server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get my pending approvals
      tags:
      - approvals
  /api/v1/approvals/stats:
    get:
      description: Get statistics about playbook approval workflows
      produces:
      - application/json
      responses:
        "200":
          description: Approval statistics
          schema:
            additionalProperties: true
            type: object
      summary: Get approval statistics
      tags:
      - playbooks
  /api/v1/auth/csrf-token:
    get:
      description: Returns the current CSRF token from the httpOnly cookie
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            type: string
      summary: Get CSRF token
      tags:
      - auth
  /api/v1/auth/login:
    post:
      consumes:
      - application/json
      description: Authenticates a user with username and password, returns JWT and
        CSRF tokens
      parameters:
      - description: Login credentials
        in: body
        name: credentials
        required: true
        schema:
          properties:
            password:
              type: string
            username:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            type: string
        "401":
          description: Unauthorized
          schema:
            type: string
        "429":
          description: Too Many Requests
          schema:
            type: string
        "503":
          description: Service Unavailable
          schema:
            type: string
      summary: Authenticate user
      tags:
      - auth
  /api/v1/auth/logout:
    post:
      responses: {}
  /api/v1/auth/mfa/disable:
    post:
      consumes:
      - application/json
      description: Disables MFA and removes TOTP secret
      parameters:
      - description: TOTP verification code for confirmation
        in: body
        name: code
        required: true
        schema:
          properties:
            code:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: Success message
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            type: string
        "401":
          description: Unauthorized
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Disable MFA for current user
      tags:
      - auth
  /api/v1/auth/mfa/enable:
    post:
      consumes:
      - application/json
      description: Generates a TOTP secret and QR code for MFA enrollment
      produces:
      - application/json
      responses:
        "200":
          description: QR code and secret
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            type: string
        "401":
          description: Unauthorized
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Enable MFA for current user
      tags:
      - auth
  /api/v1/auth/mfa/verify:
    post:
      consumes:
      - application/json
      description: Verifies a TOTP code and enables MFA for the user
      parameters:
      - description: TOTP verification code
        in: body
        name: code
        required: true
        schema:
          properties:
            code:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: Success message
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            type: string
        "401":
          description: Unauthorized
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Verify and enable MFA
      tags:
      - auth
  /api/v1/correlation-rules:
    get:
      description: This endpoint has been deprecated and replaced by unified /api/v1/rules
      produces:
      - application/json
      responses:
        "410":
          description: Endpoint deprecated
          schema:
            type: string
      summary: Deprecated endpoint
      tags:
      - rules
  /api/v1/dlq:
    get:
      description: Returns a paginated list of dead-letter queue events with optional
        filtering
      parameters:
      - description: Page number (default 1)
        in: query
        name: page
        type: integer
      - description: Items per page (default 50, max 100)
        in: query
        name: limit
        type: integer
      - description: Filter by status (pending, replayed, discarded)
        in: query
        name: status
        type: string
      - description: Filter by protocol (syslog, cef, json, fluentd)
        in: query
        name: protocol
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.PaginationResponse'
        "500":
          description: Internal server error
          schema:
            type: string
      summary: List DLQ events
      tags:
      - dlq
  /api/v1/dlq/{id}:
    delete:
      consumes:
      - application/json
      description: Marks a DLQ event as discarded (does not delete it)
      parameters:
      - description: DLQ Event ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Success message
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: DLQ event not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Discard DLQ event
      tags:
      - dlq
    get:
      description: Returns a single DLQ event by ID
      parameters:
      - description: DLQ Event ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/ingest.DLQEvent'
        "404":
          description: DLQ event not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get DLQ event
      tags:
      - dlq
  /api/v1/dlq/{id}/replay:
    post:
      consumes:
      - application/json
      description: Attempts to re-ingest a DLQ event through the appropriate ingestion
        handler
      parameters:
      - description: DLQ Event ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Success message
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: DLQ event not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Replay DLQ event
      tags:
      - dlq
  /api/v1/dlq/replay-all:
    post:
      consumes:
      - application/json
      description: Attempts to re-ingest all pending DLQ events in batch
      produces:
      - application/json
      responses:
        "200":
          description: Replay statistics
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Replay all pending DLQ events
      tags:
      - dlq
  /api/v1/events/search:
    post:
      consumes:
      - application/json
      description: Execute a CQL query to search and filter security events
      parameters:
      - description: Search request with CQL query
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.SearchRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Search results with pagination
          schema:
            $ref: '#/definitions/api.SearchResponse'
        "400":
          description: Invalid query syntax or request
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Query execution error
          schema:
            additionalProperties:
              type: string
            type: object
        "503":
          description: Query timeout or service unavailable
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Search events with CQL
      tags:
      - events
  /api/v1/events/search/fields:
    get:
      description: Returns a list of available fields for event search
      produces:
      - application/json
      responses:
        "200":
          description: List of searchable fields
          schema:
            items:
              type: string
            type: array
      summary: Get search fields
      tags:
      - events
  /api/v1/events/search/operators:
    get:
      description: Returns a list of available CQL operators
      produces:
      - application/json
      responses:
        "200":
          description: List of operators
          schema:
            items:
              type: string
            type: array
      summary: Get search operators
      tags:
      - events
  /api/v1/events/search/validate:
    post:
      consumes:
      - application/json
      description: Validate a CQL query syntax without executing it
      parameters:
      - description: Query to validate
        in: body
        name: query
        required: true
        schema:
          additionalProperties:
            type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: Validation result
          schema:
            $ref: '#/definitions/api.QueryValidationResponse'
        "400":
          description: Invalid request
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Validate CQL query
      tags:
      - events
  /api/v1/feeds:
    get:
      consumes:
      - application/json
      description: Returns a list of configured SIGMA rule feeds
      parameters:
      - description: 'Page number (default: 1)'
        in: query
        name: page
        type: integer
      - description: 'Items per page (default: 50, max: 100)'
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.FeedsListResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: List all feeds
      tags:
      - feeds
    post:
      consumes:
      - application/json
      description: Creates a new SIGMA rule feed configuration
      parameters:
      - description: Feed configuration
        in: body
        name: feed
        required: true
        schema:
          $ref: '#/definitions/api.CreateFeedRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/api.FeedResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Create a new feed
      tags:
      - feeds
  /api/v1/feeds/{id}:
    delete:
      consumes:
      - application/json
      description: Deletes a SIGMA rule feed configuration
      parameters:
      - description: Feed ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: Feed deleted successfully
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Delete a feed
      tags:
      - feeds
    get:
      consumes:
      - application/json
      description: Returns a single feed by its ID
      parameters:
      - description: Feed ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.FeedResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Get feed by ID
      tags:
      - feeds
    put:
      consumes:
      - application/json
      description: Updates an existing SIGMA rule feed configuration
      parameters:
      - description: Feed ID
        in: path
        name: id
        required: true
        type: string
      - description: Feed configuration updates
        in: body
        name: feed
        required: true
        schema:
          $ref: '#/definitions/api.UpdateFeedRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.FeedResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Update a feed
      tags:
      - feeds
  /api/v1/feeds/{id}/disable:
    post:
      consumes:
      - application/json
      description: Disables a SIGMA rule feed to prevent automatic synchronization
      parameters:
      - description: Feed ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.FeedResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Disable a feed
      tags:
      - feeds
  /api/v1/feeds/{id}/enable:
    post:
      consumes:
      - application/json
      description: Enables a SIGMA rule feed for automatic synchronization
      parameters:
      - description: Feed ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.FeedResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Enable a feed
      tags:
      - feeds
  /api/v1/feeds/{id}/history:
    get:
      consumes:
      - application/json
      description: Returns synchronization history for a SIGMA rule feed
      parameters:
      - description: Feed ID
        in: path
        name: id
        required: true
        type: string
      - description: 'Maximum number of results (default: 20, max: 100)'
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/feeds.FeedSyncResult'
            type: array
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Get feed sync history
      tags:
      - feeds
  /api/v1/feeds/{id}/stats:
    get:
      consumes:
      - application/json
      description: Returns detailed statistics for a SIGMA rule feed
      parameters:
      - description: Feed ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/feeds.FeedStats'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Get feed statistics
      tags:
      - feeds
  /api/v1/feeds/{id}/sync:
    post:
      consumes:
      - application/json
      description: Triggers asynchronous synchronization of a SIGMA rule feed. Returns
        immediately with 202 Accepted. Poll feed stats for completion status.
      parameters:
      - description: Feed ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "202":
          description: Sync operation accepted and running in background
          schema:
            $ref: '#/definitions/api.SyncStatusResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "409":
          description: Feed is already syncing
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Sync a feed (async)
      tags:
      - feeds
  /api/v1/feeds/{id}/test:
    post:
      consumes:
      - application/json
      description: Tests connectivity to a SIGMA rule feed source
      parameters:
      - description: Feed ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Test feed connection
      tags:
      - feeds
  /api/v1/feeds/summary:
    get:
      consumes:
      - application/json
      description: Returns aggregate statistics for all SIGMA rule feeds
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.FeedsSummaryResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Get feeds summary
      tags:
      - feeds
  /api/v1/feeds/sync-all:
    post:
      consumes:
      - application/json
      description: Triggers asynchronous synchronization of all enabled SIGMA rule
        feeds. Returns immediately with 202 Accepted. Poll individual feed stats for
        completion status.
      produces:
      - application/json
      responses:
        "202":
          description: Sync operations accepted and running in background
          schema:
            $ref: '#/definitions/api.SyncStatusResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Sync all feeds (async)
      tags:
      - feeds
  /api/v1/feeds/templates:
    get:
      consumes:
      - application/json
      description: Returns a list of pre-configured feed templates
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/feeds.FeedTemplate'
            type: array
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Get feed templates
      tags:
      - feeds
  /api/v1/hunt/iocs:
    post:
      consumes:
      - application/json
      description: |-
        Initiate a threat hunt for specified indicators of compromise.
        This is a placeholder endpoint that logs the hunt request.
        In production, this would trigger searches across SIEM, EDR, and other security tools.
      parameters:
      - description: Hunt IOCs request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.HuntIOCsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: IOC hunt initiated
          schema:
            $ref: '#/definitions/api.HuntIOCsResponse'
        "400":
          description: Validation error
          schema:
            $ref: '#/definitions/api.RemediationError'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.RemediationError'
      security:
      - BearerAuth: []
      summary: Hunt for IOCs
      tags:
      - remediation
  /api/v1/investigations:
    get:
      consumes:
      - application/json
      description: Returns a list of investigations with pagination and optional filters
      parameters:
      - default: 1
        description: Page number (1-based)
        in: query
        minimum: 1
        name: page
        type: integer
      - default: 20
        description: Items per page (1-1000)
        in: query
        maximum: 1000
        minimum: 1
        name: limit
        type: integer
      - description: Filter by status
        example: open
        in: query
        name: status
        type: string
      - description: Filter by priority
        example: critical
        in: query
        name: priority
        type: string
      - description: Filter by assignee ID
        example: user123
        in: query
        name: assignee
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.PaginationResponse'
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get investigations
      tags:
      - investigations
    post:
      consumes:
      - application/json
      description: Creates a new investigation
      parameters:
      - description: Investigation to create
        in: body
        name: investigation
        required: true
        schema:
          $ref: '#/definitions/api.CreateInvestigationRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/core.Investigation'
        "400":
          description: Invalid request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Create investigation
      tags:
      - investigations
  /api/v1/investigations/{id}:
    delete:
      consumes:
      - application/json
      description: Deletes an investigation
      parameters:
      - description: Investigation ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No content
          schema:
            type: string
        "404":
          description: Investigation not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Delete investigation
      tags:
      - investigations
    get:
      consumes:
      - application/json
      description: Returns a single investigation by ID
      parameters:
      - description: Investigation ID
        example: INV-20250108-0042
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Investigation'
        "404":
          description: Investigation not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get investigation
      tags:
      - investigations
    put:
      consumes:
      - application/json
      description: Updates an existing investigation
      parameters:
      - description: Investigation ID
        in: path
        name: id
        required: true
        type: string
      - description: Investigation updates
        in: body
        name: investigation
        required: true
        schema:
          $ref: '#/definitions/api.UpdateInvestigationRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Investigation'
        "400":
          description: Invalid request
          schema:
            type: string
        "404":
          description: Investigation not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Update investigation
      tags:
      - investigations
  /api/v1/investigations/{id}/alerts:
    post:
      consumes:
      - application/json
      description: Links an alert to an investigation
      parameters:
      - description: Investigation ID
        in: path
        name: id
        required: true
        type: string
      - description: Alert ID
        in: body
        name: alert
        required: true
        schema:
          $ref: '#/definitions/api.AddAlertRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Investigation'
        "400":
          description: Invalid request
          schema:
            type: string
        "404":
          description: Investigation not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Add alert to investigation
      tags:
      - investigations
  /api/v1/investigations/{id}/close:
    post:
      consumes:
      - application/json
      description: Closes an investigation with a verdict
      parameters:
      - description: Investigation ID
        in: path
        name: id
        required: true
        type: string
      - description: Closure details
        in: body
        name: verdict
        required: true
        schema:
          $ref: '#/definitions/api.CloseInvestigationRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Investigation'
        "400":
          description: Invalid request
          schema:
            type: string
        "404":
          description: Investigation not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Close investigation
      tags:
      - investigations
  /api/v1/investigations/{id}/evidence:
    get:
      description: Get all evidence files attached to an investigation
      parameters:
      - description: 'Investigation ID (format: INV-YYYYMMDD-XXXX)'
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/core.Evidence'
            type: array
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Investigation not found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: List investigation evidence
      tags:
      - evidence
      - investigations
    post:
      consumes:
      - multipart/form-data
      description: Upload an evidence file and attach it to an investigation
      parameters:
      - description: 'Investigation ID (format: INV-YYYYMMDD-XXXX)'
        in: path
        name: id
        required: true
        type: string
      - description: Evidence file
        in: formData
        name: file
        required: true
        type: file
      - description: Description of the evidence
        in: formData
        name: description
        type: string
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/core.Evidence'
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "403":
          description: Investigation is closed
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Investigation not found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "413":
          description: File too large
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "415":
          description: Unsupported media type
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Upload investigation evidence
      tags:
      - evidence
      - investigations
  /api/v1/investigations/{id}/evidence/{evidence_id}:
    delete:
      description: Delete an evidence file from an investigation
      parameters:
      - description: 'Investigation ID (format: INV-YYYYMMDD-XXXX)'
        in: path
        name: id
        required: true
        type: string
      - description: Evidence ID (UUID)
        in: path
        name: evidence_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No content
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "403":
          description: Investigation is closed
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Evidence not found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Delete investigation evidence
      tags:
      - evidence
      - investigations
    get:
      description: Get metadata for a specific evidence file attached to an investigation
      parameters:
      - description: 'Investigation ID (format: INV-YYYYMMDD-XXXX)'
        in: path
        name: id
        required: true
        type: string
      - description: Evidence ID (UUID)
        in: path
        name: evidence_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Evidence'
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Evidence not found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Get investigation evidence metadata
      tags:
      - evidence
      - investigations
  /api/v1/investigations/{id}/evidence/{evidence_id}/download:
    get:
      description: Download a specific evidence file attached to an investigation
      parameters:
      - description: 'Investigation ID (format: INV-YYYYMMDD-XXXX)'
        in: path
        name: id
        required: true
        type: string
      - description: Evidence ID (UUID)
        in: path
        name: evidence_id
        required: true
        type: string
      produces:
      - application/octet-stream
      responses:
        "200":
          description: OK
          schema:
            type: file
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Evidence not found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Download investigation evidence
      tags:
      - evidence
      - investigations
  /api/v1/investigations/{id}/notes:
    post:
      consumes:
      - application/json
      description: Adds a note to an investigation
      parameters:
      - description: Investigation ID
        in: path
        name: id
        required: true
        type: string
      - description: Note content
        in: body
        name: note
        required: true
        schema:
          $ref: '#/definitions/api.AddNoteRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Investigation'
        "400":
          description: Invalid request
          schema:
            type: string
        "404":
          description: Investigation not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Add note to investigation
      tags:
      - investigations
  /api/v1/investigations/{id}/timeline:
    get:
      consumes:
      - application/json
      description: Returns chronological events for an investigation
      parameters:
      - description: Investigation ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "404":
          description: Investigation not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get investigation timeline
      tags:
      - investigations
  /api/v1/investigations/statistics:
    get:
      consumes:
      - application/json
      description: Returns statistical data about investigations including counts
        by status, priority, and average resolution time
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal server error
          schema:
            type: string
        "503":
          description: Investigation storage not available
          schema:
            type: string
      summary: Get investigation statistics
      tags:
      - investigations
  /api/v1/listener-templates:
    get:
      consumes:
      - application/json
      description: Returns all available built-in listener templates
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/api.ListenerTemplate'
            type: array
      security:
      - ApiKeyAuth: []
      summary: List listener templates
      tags:
      - listeners
  /api/v1/listener-templates/{id}:
    get:
      consumes:
      - application/json
      description: Returns a single listener template by ID
      parameters:
      - description: Template ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.ListenerTemplate'
        "404":
          description: Template not found
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: Get a listener template
      tags:
      - listeners
  /api/v1/listeners:
    get:
      consumes:
      - application/json
      description: Returns all configured dynamic listeners with pagination and runtime
        statistics
      parameters:
      - description: 'Page number (default: 1)'
        in: query
        minimum: 1
        name: page
        type: integer
      - description: 'Items per page (default: 50, max: 1000)'
        in: query
        maximum: 1000
        minimum: 1
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/api.PaginationResponse'
            - properties:
                items:
                  items:
                    $ref: '#/definitions/storage.DynamicListener'
                  type: array
              type: object
        "500":
          description: Failed to retrieve listeners
          schema:
            type: string
        "503":
          description: Listener manager not available
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: List all dynamic listeners
      tags:
      - listeners
    post:
      consumes:
      - application/json
      description: Creates a new dynamic listener with specified configuration
      parameters:
      - description: Listener configuration
        in: body
        name: listener
        required: true
        schema:
          $ref: '#/definitions/storage.DynamicListener'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/storage.DynamicListener'
        "400":
          description: Invalid JSON or validation error
          schema:
            type: string
        "500":
          description: Failed to create listener
          schema:
            type: string
        "503":
          description: Listener manager not available
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: Create a dynamic listener
      tags:
      - listeners
  /api/v1/listeners/{id}:
    delete:
      consumes:
      - application/json
      description: Deletes a dynamic listener by ID (must be stopped first)
      parameters:
      - description: Listener ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              allOf:
              - type: string
              - properties:
                  status:
                    type: string
                type: object
            type: object
        "400":
          description: Invalid ID format or listener is running
          schema:
            type: string
        "404":
          description: Listener not found
          schema:
            type: string
        "500":
          description: Failed to delete listener
          schema:
            type: string
        "503":
          description: Listener manager not available
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: Delete a dynamic listener
      tags:
      - listeners
    get:
      consumes:
      - application/json
      description: Returns a single dynamic listener by ID with runtime statistics
      parameters:
      - description: Listener ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/storage.DynamicListener'
        "400":
          description: Invalid listener ID format
          schema:
            type: string
        "404":
          description: Listener not found
          schema:
            type: string
        "500":
          description: Failed to retrieve listener
          schema:
            type: string
        "503":
          description: Listener manager not available
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: Get a dynamic listener
      tags:
      - listeners
    put:
      consumes:
      - application/json
      description: Updates an existing dynamic listener configuration (must be stopped
        first)
      parameters:
      - description: Listener ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: Updated listener configuration
        in: body
        name: listener
        required: true
        schema:
          $ref: '#/definitions/storage.DynamicListener'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/storage.DynamicListener'
        "400":
          description: Invalid JSON, validation error, or listener is running
          schema:
            type: string
        "404":
          description: Listener not found
          schema:
            type: string
        "500":
          description: Failed to update listener
          schema:
            type: string
        "503":
          description: Listener manager not available
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: Update a dynamic listener
      tags:
      - listeners
  /api/v1/listeners/{id}/dlq:
    get:
      description: Returns a paginated list of dead-letter queue events for a specific
        listener
      parameters:
      - description: Listener ID
        in: path
        name: id
        required: true
        type: string
      - description: Page number (default 1)
        in: query
        name: page
        type: integer
      - description: Items per page (default 50, max 100)
        in: query
        name: limit
        type: integer
      - description: Filter by status (pending, replayed, discarded)
        in: query
        name: status
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.PaginationResponse'
        "500":
          description: Internal server error
          schema:
            type: string
      summary: List DLQ events for a specific listener
      tags:
      - listeners
      - dlq
  /api/v1/listeners/{id}/dlq/{eventId}:
    delete:
      consumes:
      - application/json
      description: Marks a DLQ event as discarded, verifying it belongs to the specified
        listener
      parameters:
      - description: Listener ID
        in: path
        name: id
        required: true
        type: string
      - description: DLQ Event ID
        in: path
        name: eventId
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Success message
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: DLQ event not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Discard DLQ event for a specific listener
      tags:
      - listeners
      - dlq
    get:
      description: Returns a single DLQ event by ID, verifying it belongs to the specified
        listener
      parameters:
      - description: Listener ID
        in: path
        name: id
        required: true
        type: string
      - description: DLQ Event ID
        in: path
        name: eventId
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/ingest.DLQEvent'
        "404":
          description: DLQ event not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get DLQ event for a specific listener
      tags:
      - listeners
      - dlq
  /api/v1/listeners/{id}/dlq/{eventId}/replay:
    post:
      consumes:
      - application/json
      description: Attempts to re-ingest a DLQ event, verifying it belongs to the
        specified listener
      parameters:
      - description: Listener ID
        in: path
        name: id
        required: true
        type: string
      - description: DLQ Event ID
        in: path
        name: eventId
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Success message
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: DLQ event not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Replay DLQ event for a specific listener
      tags:
      - listeners
      - dlq
  /api/v1/listeners/{id}/restart:
    post:
      consumes:
      - application/json
      description: Restarts a running dynamic listener (stop then start)
      parameters:
      - description: Listener ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              allOf:
              - type: string
              - properties:
                  message:
                    type: string
                  status:
                    type: string
                type: object
            type: object
        "400":
          description: Invalid ID format or listener not running
          schema:
            type: string
        "404":
          description: Listener not found
          schema:
            type: string
        "500":
          description: Failed to restart listener
          schema:
            type: string
        "503":
          description: Listener manager not available
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: Restart a dynamic listener
      tags:
      - listeners
  /api/v1/listeners/{id}/start:
    post:
      consumes:
      - application/json
      description: Starts a stopped dynamic listener
      parameters:
      - description: Listener ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              allOf:
              - type: string
              - properties:
                  message:
                    type: string
                  status:
                    type: string
                type: object
            type: object
        "400":
          description: Invalid ID format or listener already running
          schema:
            type: string
        "404":
          description: Listener not found
          schema:
            type: string
        "500":
          description: Failed to start listener
          schema:
            type: string
        "503":
          description: Listener manager not available
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: Start a dynamic listener
      tags:
      - listeners
  /api/v1/listeners/{id}/stats:
    get:
      consumes:
      - application/json
      description: Returns real-time statistics for a running dynamic listener
      parameters:
      - description: Listener ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/storage.ListenerStats'
        "400":
          description: Invalid listener ID format or listener not running
          schema:
            type: string
        "404":
          description: Listener not found
          schema:
            type: string
        "500":
          description: Failed to retrieve statistics
          schema:
            type: string
        "503":
          description: Listener manager not available
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: Get listener statistics
      tags:
      - listeners
  /api/v1/listeners/{id}/stop:
    post:
      consumes:
      - application/json
      description: Stops a running dynamic listener
      parameters:
      - description: Listener ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              allOf:
              - type: string
              - properties:
                  message:
                    type: string
                  status:
                    type: string
                type: object
            type: object
        "400":
          description: Invalid ID format or listener not running
          schema:
            type: string
        "404":
          description: Listener not found
          schema:
            type: string
        "500":
          description: Failed to stop listener
          schema:
            type: string
        "503":
          description: Listener manager not available
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: Stop a dynamic listener
      tags:
      - listeners
  /api/v1/listeners/from-template/{templateId}:
    post:
      consumes:
      - application/json
      description: Creates a new dynamic listener from a built-in template with optional
        overrides
      parameters:
      - description: Template ID
        in: path
        name: templateId
        required: true
        type: string
      - description: Optional configuration overrides
        in: body
        name: overrides
        schema:
          $ref: '#/definitions/storage.DynamicListener'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/storage.DynamicListener'
        "400":
          description: Invalid JSON or validation error
          schema:
            type: string
        "404":
          description: Template not found
          schema:
            type: string
        "500":
          description: Failed to create listener
          schema:
            type: string
        "503":
          description: Listener manager not available
          schema:
            type: string
      security:
      - ApiKeyAuth: []
      summary: Create listener from template
      tags:
      - listeners
  /api/v1/mitre/coverage:
    get:
      consumes:
      - application/json
      description: Returns comprehensive coverage statistics across all tactics and
        techniques
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.CoverageReport'
        "500":
          description: Failed to generate coverage report
          schema:
            type: string
      summary: Get MITRE ATT&CK coverage report
      tags:
      - mitre
  /api/v1/mitre/coverage/data-sources:
    get:
      description: Returns coverage statistics grouped by data source
      produces:
      - application/json
      responses:
        "200":
          description: Data source coverage
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get coverage by data source
      tags:
      - mitre
  /api/v1/mitre/coverage/matrix:
    get:
      consumes:
      - application/json
      description: Returns detailed coverage matrix with all tactics and techniques
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.CoverageMatrix'
        "500":
          description: Failed to generate coverage matrix
          schema:
            type: string
      summary: Get MITRE ATT&CK coverage matrix
      tags:
      - mitre
  /api/v1/mitre/data-sources:
    get:
      description: Returns all data sources from the MITRE ATT&CK framework
      produces:
      - application/json
      responses:
        "200":
          description: Data sources
          schema:
            items:
              $ref: '#/definitions/mitre.DataSource'
            type: array
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get all MITRE ATT&CK data sources
      tags:
      - mitre
  /api/v1/mitre/import:
    post:
      consumes:
      - multipart/form-data
      description: Imports techniques, sub-techniques, tactics, and data sources from
        a STIX bundle file
      parameters:
      - description: STIX bundle JSON file
        in: formData
        name: file
        required: true
        type: file
      produces:
      - application/json
      responses:
        "200":
          description: Import result
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Import MITRE ATT&CK STIX bundle
      tags:
      - mitre
  /api/v1/mitre/statistics:
    get:
      consumes:
      - application/json
      description: Returns statistics about MITRE ATT&CK framework coverage
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal server error
          schema:
            type: string
        "503":
          description: MITRE storage not available
          schema:
            type: string
      summary: Get MITRE ATT&CK statistics
      tags:
      - mitre
  /api/v1/mitre/tactics:
    get:
      consumes:
      - application/json
      description: Returns all MITRE ATT&CK tactics
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/mitre.Tactic'
            type: array
        "500":
          description: Internal server error
          schema:
            type: string
        "503":
          description: MITRE storage not available
          schema:
            type: string
      summary: Get MITRE ATT&CK tactics
      tags:
      - mitre
  /api/v1/mitre/tactics/{id}:
    get:
      consumes:
      - application/json
      description: Returns a single MITRE ATT&CK tactic
      parameters:
      - description: Tactic ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/mitre.Tactic'
        "404":
          description: Tactic not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
        "503":
          description: MITRE storage not available
          schema:
            type: string
      summary: Get MITRE ATT&CK tactic by ID
      tags:
      - mitre
  /api/v1/mitre/techniques:
    get:
      consumes:
      - application/json
      description: Returns MITRE ATT&CK techniques with pagination
      parameters:
      - description: 'Page number (default: 1)'
        in: query
        name: page
        type: integer
      - description: 'Items per page (default: 50)'
        in: query
        name: limit
        type: integer
      - description: Filter by tactic ID
        in: query
        name: tacticId
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Paginated techniques
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal server error
          schema:
            type: string
        "503":
          description: MITRE storage not available
          schema:
            type: string
      summary: Get MITRE ATT&CK techniques
      tags:
      - mitre
  /api/v1/mitre/techniques/{id}:
    get:
      consumes:
      - application/json
      description: Returns a single MITRE ATT&CK technique
      parameters:
      - description: Technique ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/mitre.Technique'
        "404":
          description: Technique not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
        "503":
          description: MITRE storage not available
          schema:
            type: string
      summary: Get MITRE ATT&CK technique by ID
      tags:
      - mitre
  /api/v1/mitre/techniques/{id}/subtechniques:
    get:
      description: Returns all sub-techniques for a given parent technique ID
      parameters:
      - description: Parent technique ID (e.g., T1055)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Sub-techniques
          schema:
            items:
              $ref: '#/definitions/mitre.Technique'
            type: array
        "400":
          description: Invalid technique ID
          schema:
            type: string
        "404":
          description: Technique not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get sub-techniques for a parent technique
      tags:
      - mitre
  /api/v1/mitre/update:
    post:
      description: Downloads and imports the latest MITRE ATT&CK STIX bundle from
        GitHub
      produces:
      - application/json
      responses:
        "200":
          description: Import result
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Update MITRE ATT&CK data from latest bundle
      tags:
      - mitre
  /api/v1/ml/config:
    get:
      description: Returns current ML system configuration
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.MLAPIConfig'
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Get ML configuration
      tags:
      - ml
    put:
      consumes:
      - application/json
      description: Update ML system configuration
      parameters:
      - description: ML configuration
        in: body
        name: config
        required: true
        schema:
          $ref: '#/definitions/api.MLAPIConfig'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Update ML configuration
      tags:
      - ml
  /api/v1/ml/health:
    get:
      description: Returns detailed health information about the ML anomaly detection
        system
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.MLDetailedHealthResponse'
        "503":
          description: Service Unavailable
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Get ML system health
      tags:
      - ml
  /api/v1/ml/models:
    get:
      description: Returns a list of all ML models with their metadata
      parameters:
      - description: Filter by model name
        in: query
        name: name
        type: string
      - description: Filter by status (active, retired, training)
        in: query
        name: status
        type: string
      - description: Filter by algorithm
        in: query
        name: algorithm
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/storage.ModelMetadata'
            type: array
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: List ML models
      tags:
      - ml-models
  /api/v1/ml/models/{name}/{version}:
    get:
      description: Returns metadata for a specific ML model version
      parameters:
      - description: Model name
        in: path
        name: name
        required: true
        type: string
      - description: Model version
        in: path
        name: version
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/storage.ModelMetadata'
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Get ML model
      tags:
      - ml-models
  /api/v1/ml/models/{name}/{version}/activate:
    post:
      description: Activates a specific model version and retires previous active
        versions
      parameters:
      - description: Model name
        in: path
        name: name
        required: true
        type: string
      - description: Model version
        in: path
        name: version
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Activate ML model
      tags:
      - ml-models
  /api/v1/ml/models/{name}/{version}/rollback:
    post:
      description: Rolls back to a previous model version
      parameters:
      - description: Model name
        in: path
        name: name
        required: true
        type: string
      - description: Target version to rollback to
        in: path
        name: version
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Rollback ML model
      tags:
      - ml-models
  /api/v1/ml/models/{name}/{version}/status:
    put:
      consumes:
      - application/json
      description: Updates the status of a model version
      parameters:
      - description: Model name
        in: path
        name: name
        required: true
        type: string
      - description: Model version
        in: path
        name: version
        required: true
        type: string
      - description: Status object with 'status' field
        in: body
        name: status
        required: true
        schema:
          additionalProperties:
            type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Update ML model status
      tags:
      - ml-models
  /api/v1/ml/models/{name}/prune:
    post:
      description: Retires old model versions, keeping only the specified number of
        recent versions
      parameters:
      - description: Model name
        in: path
        name: name
        required: true
        type: string
      - description: Number of versions to keep
        in: query
        name: keep_versions
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Prune ML model versions
      tags:
      - ml-models
  /api/v1/ml/performance:
    get:
      description: Returns historical performance metrics for the ML anomaly detection
        system
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/ml.TrainingPerformance'
            type: array
        "503":
          description: Service Unavailable
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Get ML performance history
      tags:
      - ml
  /api/v1/ml/status:
    get:
      description: Returns current status and statistics of the ML anomaly detection
        system
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.MLStatusResponse'
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Get ML system status
      tags:
      - ml
  /api/v1/ml/train:
    post:
      description: Manually trigger ML model training with current data
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Force ML model training
      tags:
      - ml
  /api/v1/playbook-executions:
    get:
      description: Retrieve list of playbook executions with optional filtering by
        playbook_id, alert_id, status
      parameters:
      - description: Filter by playbook ID
        in: query
        name: playbook_id
        type: string
      - description: Filter by alert ID
        in: query
        name: alert_id
        type: string
      - description: Filter by status (running, completed, failed)
        in: query
        name: status
        type: string
      - description: 'Page number (default: 1)'
        in: query
        name: page
        type: integer
      - description: 'Items per page (default: 50, max: 100)'
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Paginated list of executions
          schema:
            additionalProperties: true
            type: object
      summary: List playbook executions
      tags:
      - playbooks
  /api/v1/playbook-executions/{id}:
    get:
      description: Retrieve status, step results, and metadata for a playbook execution
      parameters:
      - description: Execution ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Execution status and results
          schema:
            $ref: '#/definitions/api.PlaybookExecutionResponse'
        "404":
          description: Execution not found
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Get playbook execution status
      tags:
      - playbooks
  /api/v1/playbooks:
    get:
      description: Retrieve a paginated list of playbooks with optional filtering
      parameters:
      - description: 'Page number (default: 1)'
        in: query
        name: page
        type: integer
      - description: 'Items per page (default: 50, max: 100)'
        in: query
        name: limit
        type: integer
      - description: Filter by enabled status
        in: query
        name: enabled
        type: boolean
      - description: Filter by tag
        in: query
        name: tag
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Paginated list of playbooks
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List playbooks
      tags:
      - playbooks
    post:
      consumes:
      - application/json
      description: Create a new playbook with validation
      parameters:
      - description: Playbook to create
        in: body
        name: playbook
        required: true
        schema:
          $ref: '#/definitions/soar.Playbook'
      produces:
      - application/json
      responses:
        "201":
          description: Created playbook
          schema:
            $ref: '#/definitions/soar.Playbook'
        "400":
          description: Validation error
          schema:
            additionalProperties: true
            type: object
        "409":
          description: Name conflict
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Create playbook
      tags:
      - playbooks
  /api/v1/playbooks/{id}:
    delete:
      description: Delete a playbook by ID
      parameters:
      - description: Playbook ID
        in: path
        name: id
        required: true
        type: string
      responses:
        "204":
          description: Playbook deleted
        "400":
          description: Invalid ID
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Playbook not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Delete playbook
      tags:
      - playbooks
    get:
      description: Retrieve a specific playbook by ID
      parameters:
      - description: Playbook ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Playbook details
          schema:
            $ref: '#/definitions/soar.Playbook'
        "400":
          description: Invalid ID
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Playbook not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get playbook
      tags:
      - playbooks
    put:
      consumes:
      - application/json
      description: Update an existing playbook
      parameters:
      - description: Playbook ID
        in: path
        name: id
        required: true
        type: string
      - description: Updated playbook
        in: body
        name: playbook
        required: true
        schema:
          $ref: '#/definitions/soar.Playbook'
      produces:
      - application/json
      responses:
        "200":
          description: Updated playbook
          schema:
            $ref: '#/definitions/soar.Playbook'
        "400":
          description: Validation error
          schema:
            additionalProperties: true
            type: object
        "404":
          description: Playbook not found
          schema:
            additionalProperties:
              type: string
            type: object
        "409":
          description: Name conflict
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Update playbook
      tags:
      - playbooks
  /api/v1/playbooks/{id}/disable:
    post:
      description: Disable a playbook by ID
      parameters:
      - description: Playbook ID
        in: path
        name: id
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/soar.Playbook'
        "400":
          description: Invalid ID
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Playbook not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Disable playbook
      tags:
      - playbooks
  /api/v1/playbooks/{id}/duplicate:
    post:
      description: Create a copy of an existing playbook
      parameters:
      - description: Original playbook ID
        in: path
        name: id
        required: true
        type: string
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/soar.Playbook'
        "400":
          description: Invalid ID
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Playbook not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Duplicate playbook
      tags:
      - playbooks
  /api/v1/playbooks/{id}/enable:
    post:
      description: Enable a playbook by ID
      parameters:
      - description: Playbook ID
        in: path
        name: id
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/soar.Playbook'
        "400":
          description: Invalid ID
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Playbook not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Enable playbook
      tags:
      - playbooks
  /api/v1/playbooks/{id}/execute:
    post:
      consumes:
      - application/json
      description: 'Trigger execution of a playbook for a specific alert. TASK 100:
        Now loads playbook from storage.'
      parameters:
      - description: Playbook ID
        in: path
        name: id
        required: true
        type: string
      - description: Execution request with alert ID
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.PlaybookExecutionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Playbook execution started
          schema:
            $ref: '#/definitions/api.PlaybookExecutionResponse'
        "400":
          description: Invalid request or playbook disabled
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Playbook or alert not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Execution error
          schema:
            additionalProperties:
              type: string
            type: object
        "503":
          description: Service unavailable - playbook storage or executor not configured
          schema:
            type: string
      summary: Execute a playbook for an alert
      tags:
      - playbooks
  /api/v1/playbooks/executions/{executionId}/approve:
    post:
      consumes:
      - application/json
      description: Approve a playbook execution that is in awaiting_approval status.
      parameters:
      - description: Execution ID
        in: path
        name: executionId
        required: true
        type: string
      - description: Approval request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.ApprovalRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Execution approved
          schema:
            $ref: '#/definitions/api.ApprovalResponse'
        "400":
          description: Invalid request or expired
          schema:
            $ref: '#/definitions/api.ApprovalError'
        "404":
          description: Execution not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Approve playbook execution
      tags:
      - playbooks
  /api/v1/playbooks/executions/{executionId}/reject:
    post:
      consumes:
      - application/json
      description: Reject a playbook execution that is in awaiting_approval status.
      parameters:
      - description: Execution ID
        in: path
        name: executionId
        required: true
        type: string
      - description: Rejection request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.ApprovalRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Execution rejected
          schema:
            $ref: '#/definitions/api.ApprovalResponse'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/api.ApprovalError'
        "404":
          description: Execution not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Reject playbook execution
      tags:
      - playbooks
  /api/v1/playbooks/stats:
    get:
      consumes:
      - application/json
      description: Returns aggregated statistics for all playbooks (total, enabled,
        disabled counts)
      produces:
      - application/json
      responses:
        "200":
          description: Playbook statistics
          schema:
            $ref: '#/definitions/storage.PlaybookStats'
        "401":
          description: Unauthorized
          schema:
            type: string
        "403":
          description: Forbidden - insufficient permissions
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
        "503":
          description: Service unavailable - playbook management not configured
          schema:
            type: string
      summary: Get playbook statistics
      tags:
      - playbooks
  /api/v1/playbooks/validate:
    post:
      consumes:
      - application/json
      description: Validate playbook configuration without creating it
      parameters:
      - description: Playbook to validate
        in: body
        name: playbook
        required: true
        schema:
          $ref: '#/definitions/soar.Playbook'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.PlaybookValidationResponse'
        "400":
          description: Invalid JSON
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Validate playbook
      tags:
      - playbooks
  /api/v1/remediation/actions/{alertId}:
    get:
      description: |-
        Retrieve all remediation actions taken for a specific alert.
        This is a placeholder endpoint that returns mock data.
      parameters:
      - description: Alert ID
        in: path
        name: alertId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Remediation actions list
          schema:
            $ref: '#/definitions/api.GetRemediationActionsResponse'
        "400":
          description: Validation error
          schema:
            $ref: '#/definitions/api.RemediationError'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Alert not found
          schema:
            $ref: '#/definitions/api.RemediationError'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.RemediationError'
      security:
      - BearerAuth: []
      summary: Get remediation actions for alert
      tags:
      - remediation
  /api/v1/remediation/block-ip:
    post:
      consumes:
      - application/json
      description: |-
        Block a malicious IP address. This is a placeholder endpoint that logs the remediation request.
        In production, this would integrate with a firewall, EDR, or SOAR platform.
      parameters:
      - description: Block IP request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.BlockIPRequest'
      produces:
      - application/json
      responses:
        "200":
          description: IP blocked successfully
          schema:
            $ref: '#/definitions/api.BlockIPResponse'
        "400":
          description: Validation error
          schema:
            $ref: '#/definitions/api.RemediationError'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.RemediationError'
      security:
      - BearerAuth: []
      summary: Block IP address
      tags:
      - remediation
  /api/v1/remediation/unblock-ip:
    post:
      consumes:
      - application/json
      description: |-
        Unblock a previously blocked IP address. This is a placeholder endpoint that logs the remediation request.
        In production, this would integrate with a firewall, EDR, or SOAR platform.
      parameters:
      - description: Unblock IP request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.UnblockIPRequest'
      produces:
      - application/json
      responses:
        "200":
          description: IP unblocked successfully
          schema:
            $ref: '#/definitions/api.UnblockIPResponse'
        "400":
          description: Validation error
          schema:
            $ref: '#/definitions/api.RemediationError'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.RemediationError'
      security:
      - BearerAuth: []
      summary: Unblock IP address
      tags:
      - remediation
  /api/v1/roles:
    get:
      description: Returns a list of all available roles with their permissions
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/storage.Role'
            type: array
        "500":
          description: Internal server error
          schema:
            type: string
      summary: List all roles
      tags:
      - roles
  /api/v1/roles/{id}:
    get:
      description: Returns details for a specific role including permissions
      parameters:
      - description: Role ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/storage.Role'
        "404":
          description: Role not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get role details
      tags:
      - roles
  /api/v1/rules:
    get:
      description: Returns detection and/or correlation rules with optional filtering
      parameters:
      - default: all
        description: Rule category (detection|correlation|all)
        in: query
        name: category
        type: string
      - description: Lifecycle status filter
        in: query
        name: lifecycle_status
        type: string
      - description: SIGMA logsource category filter
        in: query
        name: logsource_category
        type: string
      - description: SIGMA logsource product filter
        in: query
        name: logsource_product
        type: string
      - description: Enabled filter (true|false)
        in: query
        name: enabled
        type: boolean
      - default: 50
        description: Results limit (max 1000)
        in: query
        name: limit
        type: integer
      - default: 0
        description: Pagination offset
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Invalid parameters
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get unified rules list
      tags:
      - rules
    post:
      consumes:
      - application/json
      description: Create a rule with automatic category detection
      parameters:
      - description: Rule object
        in: body
        name: rule
        required: true
        schema:
          $ref: '#/definitions/core.Rule'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/core.Rule'
        "400":
          description: Invalid JSON or validation error
          schema:
            type: string
        "503":
          description: Storage not available
          schema:
            type: string
      summary: Create unified rule
      tags:
      - rules
  /api/v1/rules/{id}:
    delete:
      description: Delete a detection or correlation rule
      parameters:
      - description: Rule ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Rule deleted
          schema:
            type: string
        "404":
          description: Rule not found
          schema:
            type: string
      summary: Delete unified rule
      tags:
      - rules
    get:
      description: Get a detection or correlation rule by ID
      parameters:
      - description: Rule ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Rule'
        "404":
          description: Rule not found
          schema:
            type: string
      summary: Get unified rule
      tags:
      - rules
    put:
      consumes:
      - application/json
      description: Update a rule with category consistency validation
      parameters:
      - description: Rule ID
        in: path
        name: id
        required: true
        type: string
      - description: Rule object
        in: body
        name: rule
        required: true
        schema:
          $ref: '#/definitions/core.Rule'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Rule'
        "400":
          description: Invalid JSON or category change
          schema:
            type: string
        "404":
          description: Rule not found
          schema:
            type: string
      summary: Update unified rule
      tags:
      - rules
  /api/v1/rules/{id}/clone:
    post:
      consumes:
      - application/json
      description: Create a copy of an existing rule with optional new name
      parameters:
      - description: Rule ID to clone
        in: path
        name: id
        required: true
        type: string
      - description: Clone options
        in: body
        name: request
        schema:
          $ref: '#/definitions/api.CloneRuleRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Cloned rule
          schema:
            $ref: '#/definitions/api.CloneRuleResponse'
        "400":
          description: Invalid request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Rule not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Clone a rule
      tags:
      - rules
  /api/v1/rules/{id}/restore:
    post:
      consumes:
      - application/json
      description: Restore a rule to a specific version from its history
      parameters:
      - description: Rule ID
        in: path
        name: id
        required: true
        type: string
      - description: Version to restore
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.RestoreRuleRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Restored rule
          schema:
            $ref: '#/definitions/api.RestoreRuleResponse'
        "400":
          description: Invalid request or version
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Rule or version not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Restore rule to previous version
      tags:
      - rules
  /api/v1/rules/{id}/test-batch:
    post:
      consumes:
      - application/json
      description: Test a rule against a batch of events and return aggregated statistics
      parameters:
      - description: Rule ID
        in: path
        name: id
        required: true
        type: string
      - description: Batch test request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.BatchTestRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.BatchTestResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Batch test a rule against multiple events (TASK 170)
      tags:
      - rules
  /api/v1/rules/{id}/versions:
    get:
      description: Retrieve the version history for a specific rule
      parameters:
      - description: Rule ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Version history
          schema:
            $ref: '#/definitions/api.RuleVersionsResponse'
        "400":
          description: Invalid request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Rule not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get rule version history
      tags:
      - rules
  /api/v1/rules/bulk-delete:
    post:
      consumes:
      - application/json
      description: Delete multiple rules in batch with single detector reload
      parameters:
      - description: Rule IDs to delete
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.BulkOperationRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.BulkOperationResponse'
        "400":
          description: Invalid request
          schema:
            type: string
        "500":
          description: Operation failed
          schema:
            type: string
      summary: Bulk delete rules
      tags:
      - rules
  /api/v1/rules/bulk-disable:
    post:
      consumes:
      - application/json
      description: Disable multiple rules in batch with single detector reload
      parameters:
      - description: Rule IDs to disable
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.BulkOperationRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.BulkOperationResponse'
        "400":
          description: Invalid request
          schema:
            type: string
        "500":
          description: Operation failed
          schema:
            type: string
      summary: Bulk disable rules
      tags:
      - rules
  /api/v1/rules/bulk-enable:
    post:
      consumes:
      - application/json
      description: Enable multiple rules in batch with single detector reload
      parameters:
      - description: Rule IDs to enable
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.BulkOperationRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.BulkOperationResponse'
        "400":
          description: Invalid request
          schema:
            type: string
        "500":
          description: Operation failed
          schema:
            type: string
      summary: Bulk enable rules
      tags:
      - rules
  /api/v1/rules/export:
    get:
      description: Export rules as SIGMA YAML or JSON in ZIP archive
      parameters:
      - default: sigma
        description: Export format (sigma|json)
        in: query
        name: format
        type: string
      - default: all
        description: Rule category (detection|correlation|all)
        in: query
        name: category
        type: string
      - collectionFormat: csv
        description: Specific rule IDs to export
        in: query
        items:
          type: string
        name: rule_ids
        type: array
      produces:
      - application/zip
      responses:
        "200":
          description: ZIP archive
          schema:
            type: file
        "400":
          description: Invalid request
          schema:
            type: string
        "500":
          description: Export failed
          schema:
            type: string
      summary: Export rules
      tags:
      - rules
  /api/v1/rules/import:
    post:
      consumes:
      - multipart/form-data
      description: Import SIGMA YAML rules from files or ZIP archive
      parameters:
      - description: YAML files or ZIP archive
        in: formData
        name: files
        required: true
        type: file
      - description: Overwrite existing rules
        in: formData
        name: overwrite_existing
        type: boolean
      - description: Validate without importing
        in: formData
        name: dry_run
        type: boolean
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.ImportResponse'
        "400":
          description: Invalid request
          schema:
            type: string
        "500":
          description: Import failed
          schema:
            type: string
      summary: Import rules
      tags:
      - rules
  /api/v1/rules/migrate-cql:
    post:
      consumes:
      - application/json
      description: Converts CQL-format rules to SIGMA YAML format, optionally preserving
        originals
      parameters:
      - description: Migration request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.MigrateCQLRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.MigrateCQLResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Migrate CQL rules to SIGMA format
      tags:
      - rules
  /api/v1/rules/sample-events:
    post:
      consumes:
      - multipart/form-data
      description: Upload a file containing sample events (JSON, JSONL, or CSV format)
      parameters:
      - description: Sample events file
        in: formData
        name: file
        required: true
        type: file
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.ParsedEvents'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Upload sample events for testing
      tags:
      - rules
  /api/v1/rules/test:
    post:
      consumes:
      - application/json
      description: Test a rule against sample events to see which ones match
      parameters:
      - description: Rule and events to test
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.RuleTestRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.RuleTestResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Test a detection rule (TASK 170)
      tags:
      - rules
  /api/v1/rules/validate:
    post:
      consumes:
      - application/json
      description: Validate SIGMA YAML without creating the rule
      parameters:
      - description: SIGMA YAML to validate
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.ValidateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.ValidateResponse'
        "400":
          description: Invalid request
          schema:
            type: string
      summary: Validate rule
      tags:
      - rules
  /api/v1/system/complete-setup:
    post:
      consumes:
      - application/json
      description: Marks the first-run setup wizard as completed
      parameters:
      - description: Setup completion data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.SetupCompleteRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.SetupCompleteResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Mark setup as complete
      tags:
      - system
  /api/v1/system/first-run:
    get:
      consumes:
      - application/json
      description: Returns whether the application is running for the first time and
        needs setup
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.FirstRunResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Check if this is the first run
      tags:
      - system
  /api/v1/users:
    get:
      description: Returns a list of all users (requires read:users permission)
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/storage.User'
            type: array
        "403":
          description: Forbidden
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: List all users
      tags:
      - users
    post:
      consumes:
      - application/json
      description: Creates a new user with assigned role (requires write:users permission)
      parameters:
      - description: User details
        in: body
        name: user
        required: true
        schema:
          properties:
            password:
              type: string
            role_id:
              format: int64
              type: integer
            username:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/storage.User'
        "400":
          description: Bad Request
          schema:
            type: string
        "403":
          description: Forbidden
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Create a new user
      tags:
      - users
  /api/v1/users/{username}:
    delete:
      description: Deletes a user (requires write:users permission)
      parameters:
      - description: Username
        in: path
        name: username
        required: true
        type: string
      responses:
        "204":
          description: No Content
          schema:
            type: string
        "400":
          description: Bad Request
          schema:
            type: string
        "403":
          description: Forbidden
          schema:
            type: string
        "404":
          description: User not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Delete user
      tags:
      - users
    get:
      description: Returns details for a specific user (requires read:users permission)
      parameters:
      - description: Username
        in: path
        name: username
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/storage.User'
        "403":
          description: Forbidden
          schema:
            type: string
        "404":
          description: User not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get user details
      tags:
      - users
    put:
      consumes:
      - application/json
      description: Updates user details (requires write:users permission)
      parameters:
      - description: Username
        in: path
        name: username
        required: true
        type: string
      - description: User updates
        in: body
        name: user
        required: true
        schema:
          properties:
            active:
              type: boolean
            password:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/storage.User'
        "400":
          description: Bad Request
          schema:
            type: string
        "403":
          description: Forbidden
          schema:
            type: string
        "404":
          description: User not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Update user
      tags:
      - users
  /api/v1/users/{username}/role:
    put:
      consumes:
      - application/json
      description: Updates a user's role assignment (requires write:users permission)
      parameters:
      - description: Username
        in: path
        name: username
        required: true
        type: string
      - description: New role ID
        in: body
        name: role
        required: true
        schema:
          properties:
            role_id:
              format: int64
              type: integer
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/storage.User'
        "400":
          description: Bad Request
          schema:
            type: string
        "403":
          description: Forbidden
          schema:
            type: string
        "404":
          description: User not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Update user role
      tags:
      - users
  /api/v1/users/{username}/unlock:
    post:
      description: Unlocks a user account that was locked due to failed login attempts
        (TASK 39)
      parameters:
      - description: Username
        in: path
        name: username
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            type: string
        "403":
          description: Forbidden
          schema:
            type: string
        "404":
          description: User not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Unlock user account
      tags:
      - users
  /api/v1/users/me:
    get:
      description: 'Returns the currently authenticated user with role and permissions
        (TASK 3.6: Frontend RBAC integration)'
      produces:
      - application/json
      responses:
        "200":
          description: User with role and permissions
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get current user information
      tags:
      - users
  /health:
    get:
      consumes:
      - application/json
      description: Returns the health status of the service
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Health check
      tags:
      - system
  /health/detailed:
    get:
      description: Returns comprehensive health information including system metrics
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.HealthDetailedResponse'
      summary: Detailed health information
      tags:
      - health
  /health/live:
    get:
      description: Returns 200 if the process is running. No external dependency checks.
      produces:
      - application/json
      responses:
        "200":
          description: Process is running
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Liveness probe
      tags:
      - health
  /health/ready:
    get:
      description: Checks if ClickHouse and SQLite are accessible
      produces:
      - application/json
      responses:
        "200":
          description: Service is ready
          schema:
            $ref: '#/definitions/api.HealthReadyResponse'
        "503":
          description: Service is not ready
          schema:
            $ref: '#/definitions/api.HealthReadyResponse'
      summary: Readiness probe
      tags:
      - health
swagger: "2.0"
