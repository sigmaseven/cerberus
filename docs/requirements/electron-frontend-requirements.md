# Cerberus Console - Electron Frontend Functional Requirements Document

**Version:** 1.0
**Date:** 2025-11-29
**Status:** Draft

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Architecture Overview](#2-architecture-overview)
3. [Design System & Theme](#3-design-system--theme)
4. [Module Requirements](#4-module-requirements)
   - 4.1 [Main Dashboard](#41-main-dashboard)
   - 4.2 [Alert Triage Center](#42-alert-triage-center)
   - 4.3 [Query Builder (Threat Hunter)](#43-query-builder-threat-hunter)
   - 4.4 [Rules Management](#44-rules-management)
   - 4.5 [Correlation Rules](#45-correlation-rules)
   - 4.6 [Investigations](#46-investigations)
   - 4.7 [Listeners Management](#47-listeners-management)
   - 4.8 [SOAR & Playbooks](#48-soar--playbooks)
   - 4.9 [MITRE ATT&CK Coverage](#49-mitre-attck-coverage)
   - 4.10 [Settings & Configuration](#410-settings--configuration)
   - 4.11 [Authentication & Authorization](#411-authentication--authorization)
5. [Technical Specifications](#5-technical-specifications)
6. [Security Requirements](#6-security-requirements)
7. [Testing Requirements](#7-testing-requirements)
8. [Appendices](#8-appendices)

---

## 1. Executive Summary

### 1.1 Purpose

Cerberus Console is a cross-platform desktop SIEM application built on Electron that provides security analysts with a unified interface for threat detection, investigation, and response. The application delivers a "Hacker Professional" aesthetic with terminal-like interactions while maintaining enterprise-grade functionality.

### 1.2 Scope

This document defines the complete functional requirements for the Cerberus Console frontend, including:
- All user interface modules and their interactions
- CRUD lifecycle management for all backend resources
- Real-time data streaming and visualization
- Integration with the Cerberus backend API
- Security and authentication requirements

### 1.3 Target Users

| User Role | Primary Functions |
|-----------|-------------------|
| Security Analyst (L1) | Alert triage, basic investigation, rule monitoring |
| Security Analyst (L2/L3) | Advanced threat hunting, correlation analysis, SOAR automation |
| SOC Manager | Dashboard oversight, team management, reporting |
| System Administrator | Configuration, listener management, user administration |

### 1.4 Deployment Modes

1. **Electron Desktop Application** - Standalone cross-platform (Windows, macOS, Linux)
2. **Web Frontend** - Deployed via standard web server for browser access

---

## 2. Architecture Overview

### 2.1 High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           CERBERUS CONSOLE                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  Dashboard  â”‚  â”‚Alert Triage â”‚  â”‚Query Builderâ”‚  â”‚    Rules    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚Investigationsâ”‚ â”‚  Listeners  â”‚  â”‚    SOAR     â”‚  â”‚   MITRE     â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         STATE MANAGEMENT (Zustand)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚    REST API Layer   â”‚  â”‚  WebSocket Manager  â”‚  â”‚  Local Storage   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         ELECTRON MAIN PROCESS                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   IPC Bus   â”‚  â”‚ Auto-Update â”‚  â”‚System Tray  â”‚  â”‚  Shortcuts  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CERBERUS BACKEND API                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  REST API   â”‚  â”‚  WebSocket  â”‚  â”‚ClickHouse  â”‚  â”‚   SQLite    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Technology Stack

| Layer | Technology | Purpose |
|-------|------------|---------|
| Framework | Electron 28+ | Cross-platform desktop runtime |
| UI Framework | React 18+ | Component-based UI |
| Language | TypeScript 5+ | Type-safe development |
| State | Zustand | Lightweight state management |
| Styling | Tailwind CSS | Utility-first styling |
| Charts | Recharts / D3.js | Data visualization |
| Tables | TanStack Table | High-performance data grids |
| Forms | React Hook Form + Zod | Form handling and validation |
| API | Axios + React Query | HTTP client with caching |
| WebSocket | Native WebSocket | Real-time updates |
| Code Editor | Monaco Editor | CQL/SIGMA editing |

### 2.3 Component Hierarchy

```
App
â”œâ”€â”€ AuthProvider
â”‚   â””â”€â”€ ProtectedRoute
â”œâ”€â”€ ThemeProvider
â”œâ”€â”€ WebSocketProvider
â”œâ”€â”€ Layout
â”‚   â”œâ”€â”€ Sidebar
â”‚   â”‚   â”œâ”€â”€ NavigationMenu
â”‚   â”‚   â””â”€â”€ QuickActions
â”‚   â”œâ”€â”€ TopBar
â”‚   â”‚   â”œâ”€â”€ CommandPalette (Ctrl+K)
â”‚   â”‚   â”œâ”€â”€ NotificationBell
â”‚   â”‚   â””â”€â”€ UserMenu
â”‚   â””â”€â”€ MainContent
â”‚       â””â”€â”€ [Module Components]
â””â”€â”€ ToastProvider
```

---

## 3. Design System & Theme

### 3.1 Color Palette - "Hacker Professional"

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CERBERUS DESIGN SYSTEM - COLOR PALETTE                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  BACKGROUNDS                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ #080808â”‚ â”‚ #0D0D0Dâ”‚ â”‚ #121212â”‚ â”‚ #1A1A1Aâ”‚                   â”‚
â”‚  â”‚ Base   â”‚ â”‚ Card   â”‚ â”‚ Hover  â”‚ â”‚ Border â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                  â”‚
â”‚  ACCENT COLORS                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ #00FF41â”‚ â”‚ #FF0040â”‚ â”‚ #00D4FFâ”‚ â”‚ #FFD700â”‚                   â”‚
â”‚  â”‚ Successâ”‚ â”‚ Criticalâ”‚ â”‚ Info   â”‚ â”‚ Warningâ”‚                   â”‚
â”‚  â”‚ Matrix â”‚ â”‚ Alert  â”‚ â”‚ Cyber  â”‚ â”‚ Cautionâ”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                  â”‚
â”‚  SEVERITY SCALE                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ #FF0040â”‚ â”‚ #FF6B00â”‚ â”‚ #FFD700â”‚ â”‚ #00D4FFâ”‚ â”‚ #808080â”‚        â”‚
â”‚  â”‚Criticalâ”‚ â”‚  High  â”‚ â”‚ Medium â”‚ â”‚  Low   â”‚ â”‚  Info  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                  â”‚
â”‚  TEXT                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚ #E0E0E0â”‚ â”‚ #A0A0A0â”‚ â”‚ #606060â”‚                               â”‚
â”‚  â”‚ Primaryâ”‚ â”‚Secondaryâ”‚ â”‚ Muted  â”‚                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Typography

| Element | Font | Size | Weight |
|---------|------|------|--------|
| H1 | JetBrains Mono | 28px | 700 |
| H2 | JetBrains Mono | 24px | 600 |
| H3 | JetBrains Mono | 20px | 600 |
| Body | Inter | 14px | 400 |
| Code | JetBrains Mono | 13px | 400 |
| Caption | Inter | 12px | 400 |

### 3.3 Component Specifications

#### 3.3.1 Buttons

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BUTTON VARIANTS                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Primary (Actions)                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Background: #00FF41                      â”‚
â”‚  â”‚   â–º EXECUTE      â”‚  Text: #080808                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  Hover: #00CC33                           â”‚
â”‚                                                                  â”‚
â”‚  Danger (Destructive)                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Background: #FF0040                      â”‚
â”‚  â”‚   âœ• DELETE       â”‚  Text: #FFFFFF                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  Hover: #CC0033                           â”‚
â”‚                                                                  â”‚
â”‚  Ghost (Secondary)                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Background: transparent                  â”‚
â”‚  â”‚   â—‹ CANCEL       â”‚  Border: #1A1A1A                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  Hover: #121212                           â”‚
â”‚                                                                  â”‚
â”‚  Icon Button                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”                Size: 32x32px                            â”‚
â”‚  â”‚ âš™ â”‚                Border-radius: 4px                        â”‚
â”‚  â””â”€â”€â”€â”€â”˜                                                          â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.3.2 Cards

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CARD COMPONENT                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â–Œ Card Title                                    [â‹®] â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  Card content area                                        â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  â€¢ Background: #0D0D0D                                    â”‚  â”‚
â”‚  â”‚  â€¢ Border: 1px solid #1A1A1A                              â”‚  â”‚
â”‚  â”‚  â€¢ Border-radius: 8px                                     â”‚  â”‚
â”‚  â”‚  â€¢ Padding: 16px                                          â”‚  â”‚
â”‚  â”‚  â€¢ Left accent bar: 3px (color varies by context)         â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.3.3 Command Palette (Ctrl+K / Cmd+K)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  COMMAND PALETTE                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚ â”‚ > search alerts, rules, events...              âŒ˜K â”‚   â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  RECENT                                                   â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ” source.ip:192.168.1.* AND severity:critical     â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ“‹ Alert: Suspicious PowerShell Execution          â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ“œ Rule: Lateral Movement Detection                â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  ACTIONS                                                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ â• Create new rule                          âŒ˜N     â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ”” View alerts                              âŒ˜A     â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”‚
â”‚  â”‚  â”‚ âš™ Open settings                            âŒ˜,     â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  Specs:                                                          â”‚
â”‚  â€¢ Width: 640px max                                              â”‚
â”‚  â€¢ Position: Center top, 20% from top                            â”‚
â”‚  â€¢ Background: #0D0D0D with backdrop blur                        â”‚
â”‚  â€¢ Border: 1px solid #00FF41 (glow effect)                       â”‚
â”‚  â€¢ Animation: Scale + fade in (150ms)                            â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 Iconography

- Primary Icon Set: Lucide React
- Size Standards: 16px (inline), 20px (buttons), 24px (navigation)
- Stroke Width: 1.5px
- Color: Inherits from parent text color

---

## 4. Module Requirements

### 4.1 Main Dashboard

#### 4.1.1 Overview

The Main Dashboard provides SOC analysts with an at-a-glance operational view of the security posture, including real-time metrics, alert trends, and system health indicators.

#### 4.1.2 Wireframe

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CERBERUS                          [ğŸ” Ctrl+K]        [ğŸ”” 12] [ğŸ‘¤ Admin â–¾]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        â”‚                                                                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ“Š â”‚ â”‚  â”‚                    CERBERUS COMMAND CENTER                   â”‚ â”‚
â”‚ â”‚Dashâ”‚ â”‚  â”‚                    Last updated: 2 seconds ago               â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”˜ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â” â”‚                                                                    â”‚
â”‚ â”‚ ğŸ”” â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚Alrtâ”‚ â”‚  â”‚ â–ŒCRITICAL   â”‚ â”‚ â–ŒHIGH       â”‚ â”‚ â–ŒEVENTS/SEC â”‚ â”‚ â–ŒUPTIME     â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”˜ â”‚  â”‚             â”‚ â”‚             â”‚ â”‚             â”‚ â”‚             â”‚  â”‚
â”‚ â”Œâ”€â”€â”€â”€â” â”‚  â”‚    47       â”‚ â”‚    182      â”‚ â”‚   8,432     â”‚ â”‚  99.97%     â”‚  â”‚
â”‚ â”‚ ğŸ” â”‚ â”‚  â”‚   â–² 12%     â”‚ â”‚   â–¼ 5%      â”‚ â”‚   â–² 2.1k    â”‚ â”‚             â”‚  â”‚
â”‚ â”‚Huntâ”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚ â””â”€â”€â”€â”€â”˜ â”‚                                                                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ ğŸ“œ â”‚ â”‚  â”‚ ALERT TREND (24H)              â”‚ â”‚ TOP ATTACK VECTORS         â”‚â”‚
â”‚ â”‚Ruleâ”‚ â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”˜ â”‚  â”‚ â”‚    â•­â”€â”€â•®      â•­â”€â•®           â”‚ â”‚ â”‚ â”‚ Brute Force    â–ˆâ–ˆâ–ˆâ–ˆâ–‘ â”‚   â”‚â”‚
â”‚ â”Œâ”€â”€â”€â”€â” â”‚  â”‚ â”‚   â•­â•¯  â•°â•®    â•­â•¯ â•°â•®   â•­â”€â”€â•®   â”‚ â”‚ â”‚ â”‚ Malware DL     â–ˆâ–ˆâ–ˆâ–‘â–‘ â”‚   â”‚â”‚
â”‚ â”‚ ğŸ”— â”‚ â”‚  â”‚ â”‚  â•­â•¯    â•°â”€â”€â”€â”€â•¯   â•°â”€â”€â”€â•¯  â•°â•®  â”‚ â”‚ â”‚ â”‚ Lateral Mvmt   â–ˆâ–ˆâ–‘â–‘â–‘ â”‚   â”‚â”‚
â”‚ â”‚Corrâ”‚ â”‚  â”‚ â”‚ â”€â•¯                      â•°â”€ â”‚ â”‚ â”‚ â”‚ Data Exfil     â–ˆâ–‘â–‘â–‘â–‘ â”‚   â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”˜ â”‚  â”‚ â”‚ 00  04  08  12  16  20  24 â”‚ â”‚ â”‚ â”‚ Priv Escalate  â–ˆâ–‘â–‘â–‘â–‘ â”‚   â”‚â”‚
â”‚ â”Œâ”€â”€â”€â”€â” â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚â”‚
â”‚ â”‚ ğŸ” â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚ â”‚Inv â”‚ â”‚                                                                    â”‚
â”‚ â””â”€â”€â”€â”€â”˜ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”Œâ”€â”€â”€â”€â” â”‚  â”‚ RECENT CRITICAL ALERTS         â”‚ â”‚ LISTENER STATUS            â”‚â”‚
â”‚ â”‚ ğŸ“¡ â”‚ â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â”‚
â”‚ â”‚Listâ”‚ â”‚  â”‚ â”‚ â— Ransomware Detected      â”‚ â”‚ â”‚ â”‚ â— Syslog-514    OK   â”‚   â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”˜ â”‚  â”‚ â”‚   host: WKS-042 | 2m ago   â”‚ â”‚ â”‚ â”‚ â— CEF-1514     OK   â”‚   â”‚â”‚
â”‚ â”Œâ”€â”€â”€â”€â” â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚ â”‚ â— JSON-8080    OK   â”‚   â”‚â”‚
â”‚ â”‚ âš¡ â”‚ â”‚  â”‚ â”‚ â— Credential Dumping       â”‚ â”‚ â”‚ â”‚ â—‹ Fluentd-24224 ERR â”‚   â”‚â”‚
â”‚ â”‚SOARâ”‚ â”‚  â”‚ â”‚   host: DC-01 | 5m ago     â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚ â”Œâ”€â”€â”€â”€â” â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚ â”‚ ğŸ¯ â”‚ â”‚                                                                    â”‚
â”‚ â”‚MITRâ”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â””â”€â”€â”€â”€â”˜ â”‚  â”‚ MITRE ATT&CK COVERAGE HEATMAP                               â”‚  â”‚
â”‚ â”Œâ”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚ â”‚ âš™ â”‚ â”‚  â”‚ â”‚Reconâ”‚Rsrc â”‚Init â”‚Exec â”‚Pers â”‚Priv â”‚Def  â”‚Cred â”‚Disc â”‚    â”‚  â”‚
â”‚ â”‚Stngâ”‚ â”‚  â”‚ â”‚ 72% â”‚ 45% â”‚ 68% â”‚ 89% â”‚ 56% â”‚ 78% â”‚ 34% â”‚ 91% â”‚ 67% â”‚    â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.1.3 Functional Requirements

| ID | Requirement | Priority |
|----|-------------|----------|
| DASH-001 | Display real-time KPI cards for Critical Alerts, High Alerts, Events/Second, System Uptime | P0 |
| DASH-002 | KPI cards SHALL show trend indicators (â†‘/â†“) with percentage change vs previous period | P0 |
| DASH-003 | Alert trend chart SHALL display 24-hour rolling window with hourly granularity | P0 |
| DASH-004 | Chart SHALL support zoom (6h, 12h, 24h, 7d) via toggle buttons | P1 |
| DASH-005 | Top Attack Vectors widget SHALL show top 5 MITRE techniques by alert count | P0 |
| DASH-006 | Recent Critical Alerts list SHALL show latest 5 critical severity alerts | P0 |
| DASH-007 | Clicking an alert SHALL navigate to Alert Triage with that alert selected | P0 |
| DASH-008 | Listener Status widget SHALL show all configured listeners with health status | P0 |
| DASH-009 | MITRE Coverage heatmap SHALL display coverage percentage per tactic | P1 |
| DASH-010 | Dashboard SHALL auto-refresh every 30 seconds (configurable) | P0 |
| DASH-011 | WebSocket connection status indicator SHALL be visible in header | P0 |
| DASH-012 | Dashboard layout SHALL be customizable via drag-and-drop widgets | P2 |

#### 4.1.4 Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Dashboard  â”‚â”€â”€â”€â”€â–¶â”‚  API Client  â”‚â”€â”€â”€â”€â–¶â”‚   Backend    â”‚
â”‚   Component  â”‚     â”‚              â”‚     â”‚   /api/v1/   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                    â”‚                    â”‚
       â”‚              â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”              â”‚
       â”‚              â”‚           â”‚              â”‚
       â–¼              â–¼           â–¼              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚    Zustand   â”‚ â”‚ /stats  â”‚ â”‚/alerts  â”‚        â”‚
â”‚    Store     â”‚ â”‚         â”‚ â”‚/summary â”‚        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
       â”‚                                         â”‚
       â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
       â”‚         â”‚  WebSocket   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â””â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  /ws/events  â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.1.5 API Endpoints Required

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/v1/stats/dashboard` | GET | Aggregated dashboard statistics |
| `/api/v1/alerts?severity=critical&limit=5` | GET | Recent critical alerts |
| `/api/v1/listeners/status` | GET | All listener health status |
| `/api/v1/mitre/coverage/summary` | GET | MITRE tactic coverage percentages |
| `/ws/events` | WS | Real-time event stream |

#### 4.1.6 Acceptance Criteria

```gherkin
Feature: Main Dashboard
  As a SOC analyst
  I want to see a real-time overview of security posture
  So that I can quickly identify and respond to threats

  Scenario: Dashboard loads with current data
    Given I am logged in as an analyst
    When I navigate to the Dashboard
    Then I should see 4 KPI cards displaying current metrics
    And the Alert Trend chart should display data for the last 24 hours
    And the Recent Critical Alerts list should show up to 5 alerts
    And all data should be less than 30 seconds old

  Scenario: Real-time updates via WebSocket
    Given I am viewing the Dashboard
    When a new critical alert is generated
    Then the Critical Alerts KPI should increment within 2 seconds
    And a toast notification should appear
    And the Recent Critical Alerts list should update

  Scenario: Navigate to alert from dashboard
    Given I am viewing the Dashboard
    When I click on an alert in the Recent Critical Alerts list
    Then I should be navigated to the Alert Triage page
    And that specific alert should be selected/highlighted

  Scenario: Dashboard handles connection loss gracefully
    Given I am viewing the Dashboard
    When the WebSocket connection is lost
    Then a warning banner should appear indicating offline status
    And the dashboard should attempt reconnection automatically
    And stale data indicators should appear on widgets
```

---

### 4.2 Alert Triage Center

#### 4.2.1 Overview

The Alert Triage Center is the primary workspace for security analysts to review, investigate, and respond to security alerts. It provides a streamlined workflow for managing the alert lifecycle from detection to resolution.

#### 4.2.2 Wireframe

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CERBERUS > ALERT TRIAGE              [ğŸ” Ctrl+K]       [ğŸ”” 12] [ğŸ‘¤ Admin â–¾] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ [NAV]  â”‚ â”‚ FILTERS                                                        â”‚ â”‚
â”‚        â”‚ â”‚ Status: [All â–¾] Severity: [All â–¾] Time: [Last 24h â–¾] [Search] â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ ALERTS                                            [â†»] [â‹®]     â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ â–¡ â”‚ SEV â”‚ TITLE                    â”‚ SOURCE    â”‚ TIME   â”‚ ACT â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ â–  â”‚ â—â—â— â”‚ Ransomware Behavior      â”‚ WKS-042   â”‚ 2m ago â”‚ [â–¶] â”‚ â”‚
â”‚        â”‚ â”‚ â–¡ â”‚ â—â—â— â”‚ Credential Dump (LSASS)  â”‚ DC-01     â”‚ 5m ago â”‚ [â–¶] â”‚ â”‚
â”‚        â”‚ â”‚ â–¡ â”‚ â—â—â—‹ â”‚ Suspicious PowerShell    â”‚ SRV-WEB-1 â”‚ 12m agoâ”‚ [â–¶] â”‚ â”‚
â”‚        â”‚ â”‚ â–¡ â”‚ â—â—â—‹ â”‚ Lateral Movement         â”‚ WKS-107   â”‚ 18m agoâ”‚ [â–¶] â”‚ â”‚
â”‚        â”‚ â”‚ â–¡ â”‚ â—â—‹â—‹ â”‚ Failed Login (5x)        â”‚ VPN-GW    â”‚ 23m agoâ”‚ [â–¶] â”‚ â”‚
â”‚        â”‚ â”‚ â–¡ â”‚ â—â—‹â—‹ â”‚ Port Scan Detected       â”‚ FW-EXT    â”‚ 31m agoâ”‚ [â–¶] â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚ Page 1 of 47                              [â—€ Prev] [Next â–¶]        â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ ALERT DETAILS                                         [âœ•]     â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ â–ŒRansomware Behavior Detected                                 â”‚ â”‚
â”‚        â”‚ â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ Status: [NEW â–¾]          Assigned: [Unassigned â–¾]            â”‚ â”‚
â”‚        â”‚ â”‚ Severity: CRITICAL       MITRE: T1486 (Data Encrypted)        â”‚ â”‚
â”‚        â”‚ â”‚ Source: WKS-042          Rule: ransomware-encryption-behavior â”‚ â”‚
â”‚        â”‚ â”‚ Time: 2024-11-29 14:32:17 UTC                                 â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ EVENT DATA                                     [Expand] â”‚  â”‚ â”‚
â”‚        â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ {                                                        â”‚  â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   "process.name": "suspicious.exe",                     â”‚  â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   "process.command_line": "suspicious.exe -encrypt",    â”‚  â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   "file.path": "C:\\Users\\*\\Documents\\*",            â”‚  â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   "file.extension": ".encrypted",                       â”‚  â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   "event.count": 847                                    â”‚  â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ }                                                        â”‚  â”‚ â”‚
â”‚        â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ QUICK ACTIONS                                                 â”‚ â”‚
â”‚        â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ âš¡Block  â”‚ â”‚ ğŸ”Hunt   â”‚ â”‚ ğŸ“‹Ticket â”‚ â”‚ ğŸ”—Link   â”‚          â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   IP     â”‚ â”‚  IOCs    â”‚ â”‚  Create  â”‚ â”‚  to Inv  â”‚          â”‚ â”‚
â”‚        â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ [Mark False Positive]  [Escalate]  [Close Alert]              â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.2.3 Alert Lifecycle State Machine

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ALERT LIFECYCLE STATE MACHINE                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚                              â”‚   NEW   â”‚                                     â”‚
â”‚                              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                     â”‚
â”‚                                   â”‚                                          â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                    â”‚              â”‚              â”‚                          â”‚
â”‚                    â–¼              â–¼              â–¼                          â”‚
â”‚             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚             â”‚ACKNOWLEDGEDâ”‚  â”‚ ASSIGNED â”‚  â”‚SUPPRESSED â”‚                     â”‚
â”‚             â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                   â”‚              â”‚                                           â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚                          â”‚                                                   â”‚
â”‚                          â–¼                                                   â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚                   â”‚IN_PROGRESS  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜             â”‚                             â”‚
â”‚                          â”‚                    â”‚                             â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                             â”‚
â”‚           â”‚              â”‚              â”‚     â”‚                             â”‚
â”‚           â–¼              â–¼              â–¼     â”‚                             â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚                             â”‚
â”‚    â”‚  CLOSED   â”‚  â”‚FALSE_POS  â”‚  â”‚ ESCALATED â”œâ”˜                             â”‚
â”‚    â”‚(Resolved) â”‚  â”‚           â”‚  â”‚           â”‚                              â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                                                              â”‚
â”‚  Transitions:                                                                â”‚
â”‚  â€¢ NEW â†’ ACKNOWLEDGED: Analyst views alert                                   â”‚
â”‚  â€¢ NEW â†’ ASSIGNED: Alert assigned to analyst                                 â”‚
â”‚  â€¢ NEW â†’ SUPPRESSED: Matches suppression rule                               â”‚
â”‚  â€¢ ACKNOWLEDGED/ASSIGNED â†’ IN_PROGRESS: Investigation started               â”‚
â”‚  â€¢ IN_PROGRESS â†’ CLOSED: Issue resolved                                      â”‚
â”‚  â€¢ IN_PROGRESS â†’ FALSE_POS: Determined not a threat                         â”‚
â”‚  â€¢ IN_PROGRESS â†’ ESCALATED: Requires higher tier                            â”‚
â”‚  â€¢ ESCALATED â†’ IN_PROGRESS: Escalation handled                              â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.2.4 Functional Requirements

| ID | Requirement | Priority |
|----|-------------|----------|
| ALRT-001 | Display paginated list of alerts with configurable page size (25, 50, 100) | P0 |
| ALRT-002 | Support filtering by: status, severity, time range, source, rule, MITRE technique | P0 |
| ALRT-003 | Support multi-select for bulk operations (assign, close, suppress) | P0 |
| ALRT-004 | Display alert details panel when alert is selected | P0 |
| ALRT-005 | Show full event data in expandable JSON viewer with syntax highlighting | P0 |
| ALRT-006 | Provide one-click remediation actions: Block IP, Hunt IOCs, Create Ticket | P0 |
| ALRT-007 | Support linking alerts to existing investigations | P0 |
| ALRT-008 | Display MITRE ATT&CK technique tags with links to technique details | P1 |
| ALRT-009 | Show related alerts (same source, same rule, same timeframe) | P1 |
| ALRT-010 | Support keyboard navigation (j/k for next/prev, Enter to open, Esc to close) | P1 |
| ALRT-011 | Show alert timeline with all status changes and analyst actions | P0 |
| ALRT-012 | Support adding analyst notes/comments to alerts | P0 |
| ALRT-013 | Real-time update of alert list via WebSocket | P0 |
| ALRT-014 | Export selected alerts to CSV/JSON | P2 |
| ALRT-015 | Display alert deduplication count (how many raw events triggered this alert) | P1 |

#### 4.2.5 API Endpoints Required

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/v1/alerts` | GET | List alerts with filtering and pagination |
| `/api/v1/alerts/{id}` | GET | Get single alert details |
| `/api/v1/alerts/{id}` | PATCH | Update alert status/assignment |
| `/api/v1/alerts/{id}/comments` | GET/POST | Get/add alert comments |
| `/api/v1/alerts/{id}/timeline` | GET | Get alert activity timeline |
| `/api/v1/alerts/{id}/related` | GET | Get related alerts |
| `/api/v1/alerts/bulk` | PATCH | Bulk update multiple alerts |
| `/api/v1/alerts/{id}/actions/block-ip` | POST | Execute block IP action |
| `/api/v1/alerts/{id}/link-investigation` | POST | Link to investigation |

#### 4.2.6 Acceptance Criteria

```gherkin
Feature: Alert Triage Center
  As a security analyst
  I want to efficiently triage and respond to alerts
  So that I can minimize mean time to respond (MTTR)

  Scenario: View and filter alerts
    Given I am on the Alert Triage page
    When I set the severity filter to "Critical"
    And I set the time range to "Last 1 hour"
    Then I should only see critical alerts from the last hour
    And the alert count should update to reflect the filter

  Scenario: View alert details
    Given I am on the Alert Triage page with alerts listed
    When I click on an alert row
    Then the alert details panel should expand
    And I should see the full event data in JSON format
    And I should see the MITRE technique badge
    And I should see quick action buttons

  Scenario: Execute one-click remediation
    Given I am viewing a critical alert with a malicious IP
    When I click the "Block IP" quick action button
    Then a confirmation dialog should appear
    And upon confirmation, the block action should execute
    And a success toast should appear
    And the alert timeline should show the action taken

  Scenario: Bulk update alerts
    Given I have selected 5 alerts using checkboxes
    When I click "Bulk Actions" and select "Assign to Me"
    Then all 5 alerts should be assigned to my user
    And the status should change to "Assigned"
    And a success message should confirm "5 alerts updated"

  Scenario: Link alert to investigation
    Given I am viewing an alert that requires further investigation
    When I click "Link to Investigation"
    Then I should see a list of open investigations
    And when I select an investigation
    Then the alert should be linked and appear in that investigation

  Scenario: Real-time alert updates
    Given I am viewing the alert list
    When a new critical alert is generated by the backend
    Then the new alert should appear at the top of the list within 2 seconds
    And a subtle highlight animation should indicate it's new
    And the total alert count should increment
```

---

### 4.3 Query Builder (Threat Hunter)

#### 4.3.1 Overview

The Query Builder provides a powerful CQL (Cerberus Query Language) interface for threat hunting and ad-hoc event analysis. It features a terminal-like search experience with autocomplete, syntax highlighting, and saved search management.

#### 4.3.2 Wireframe

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CERBERUS > THREAT HUNTER             [ğŸ” Ctrl+K]       [ğŸ”” 12] [ğŸ‘¤ Admin â–¾] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        â”‚                                                                    â”‚
â”‚ [NAV]  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ CQL QUERY EDITOR                                    [?] [âš™]   â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚  1 â”‚ source.ip:192.168.1.* AND                                â”‚ â”‚
â”‚        â”‚ â”‚  2 â”‚ process.name:("powershell.exe" OR "cmd.exe") AND         â”‚ â”‚
â”‚        â”‚ â”‚  3 â”‚ event.action:("process_create" OR "file_write") AND      â”‚ â”‚
â”‚        â”‚ â”‚  4 â”‚ @timestamp:[now-1h TO now]                               â”‚ â”‚
â”‚        â”‚ â”‚    â”‚                                                          â”‚ â”‚
â”‚        â”‚ â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚ â”‚
â”‚        â”‚ â”‚    â”‚ â”‚ Suggestions:                        â”‚                 â”‚ â”‚
â”‚        â”‚ â”‚    â”‚ â”‚  â€¢ event.category                   â”‚                 â”‚ â”‚
â”‚        â”‚ â”‚    â”‚ â”‚  â€¢ event.type                       â”‚                 â”‚ â”‚
â”‚        â”‚ â”‚    â”‚ â”‚  â€¢ event.outcome                    â”‚                 â”‚ â”‚
â”‚        â”‚ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚        â”‚ â”‚ Time Range      â”‚ â”‚ Max Results     â”‚ â”‚                 â”‚       â”‚
â”‚        â”‚ â”‚ [Last 24h    â–¾] â”‚ â”‚ [1000       â–¾] â”‚ â”‚ [â–º EXECUTE]     â”‚       â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ SAVED SEARCHES                                        [+ New] â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ â˜… Lateral Movement Hunt    â”‚ â˜… Suspicious PS Exec   â”‚ [More] â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ RESULTS (2,847 events in 0.342s)             [Export â–¾] [â‹®]   â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ TIMESTAMP            â”‚ SOURCE     â”‚ EVENT           â”‚ DETAILS â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ 2024-11-29 14:32:17  â”‚ WKS-042    â”‚ process_create  â”‚ [View]  â”‚ â”‚
â”‚        â”‚ â”‚ 2024-11-29 14:32:15  â”‚ WKS-042    â”‚ file_write      â”‚ [View]  â”‚ â”‚
â”‚        â”‚ â”‚ 2024-11-29 14:31:58  â”‚ SRV-APP-1  â”‚ process_create  â”‚ [View]  â”‚ â”‚
â”‚        â”‚ â”‚ 2024-11-29 14:31:42  â”‚ WKS-107    â”‚ network_conn    â”‚ [View]  â”‚ â”‚
â”‚        â”‚ â”‚ 2024-11-29 14:31:33  â”‚ DC-01      â”‚ process_create  â”‚ [View]  â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ EVENT DETAIL                                          [âœ•]     â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ {                                                              â”‚ â”‚
â”‚        â”‚ â”‚   "@timestamp": "2024-11-29T14:32:17.000Z",                   â”‚ â”‚
â”‚        â”‚ â”‚   "source.ip": "192.168.1.42",                                â”‚ â”‚
â”‚        â”‚ â”‚   "host.name": "WKS-042",                                     â”‚ â”‚
â”‚        â”‚ â”‚   "process.name": "powershell.exe",                           â”‚ â”‚
â”‚        â”‚ â”‚   "process.command_line": "powershell -enc JABzAD0...",       â”‚ â”‚
â”‚        â”‚ â”‚   "process.parent.name": "explorer.exe",                      â”‚ â”‚
â”‚        â”‚ â”‚   "event.action": "process_create"                            â”‚ â”‚
â”‚        â”‚ â”‚ }                                                              â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ [Create Alert] [Add to Investigation] [Hunt Similar]          â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.3.3 CQL Syntax Reference

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CQL (CERBERUS QUERY LANGUAGE)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  BASIC SYNTAX                                                                â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚  field:value                    Exact match                                  â”‚
â”‚  field:"value with spaces"      Quoted value                                 â”‚
â”‚  field:(val1 OR val2)           Multiple values                              â”‚
â”‚  field:*wildcard*               Wildcard matching                            â”‚
â”‚  field:/regex/                  Regular expression                           â”‚
â”‚  field:[1 TO 100]               Range query (inclusive)                      â”‚
â”‚  field:{1 TO 100}               Range query (exclusive)                      â”‚
â”‚                                                                              â”‚
â”‚  BOOLEAN OPERATORS                                                           â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚  expr1 AND expr2                Both must match                              â”‚
â”‚  expr1 OR expr2                 Either must match                            â”‚
â”‚  NOT expr                       Must not match                               â”‚
â”‚  (expr1 AND expr2) OR expr3     Grouping with parentheses                    â”‚
â”‚                                                                              â”‚
â”‚  TIME EXPRESSIONS                                                            â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚  @timestamp:[now-1h TO now]     Last hour                                    â”‚
â”‚  @timestamp:[now-7d TO now]     Last 7 days                                  â”‚
â”‚  @timestamp:[2024-01-01 TO *]   Since date                                   â”‚
â”‚                                                                              â”‚
â”‚  FIELD AGGREGATIONS                                                          â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚  | stats count() by field       Count by field                               â”‚
â”‚  | stats sum(bytes) by host     Sum aggregation                              â”‚
â”‚  | stats avg(duration)          Average                                      â”‚
â”‚  | sort @timestamp desc         Sort results                                 â”‚
â”‚  | limit 100                    Limit results                                â”‚
â”‚                                                                              â”‚
â”‚  EXAMPLES                                                                    â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚  # Find all PowerShell executions in last hour                               â”‚
â”‚  process.name:powershell.exe AND @timestamp:[now-1h TO now]                  â”‚
â”‚                                                                              â”‚
â”‚  # Hunt for lateral movement                                                 â”‚
â”‚  event.action:network_connection AND destination.port:(445 OR 3389)          â”‚
â”‚  AND NOT source.ip:10.0.0.*                                                  â”‚
â”‚                                                                              â”‚
â”‚  # Count events by source IP                                                 â”‚
â”‚  * | stats count() by source.ip | sort count desc | limit 10                 â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.3.4 Functional Requirements

| ID | Requirement | Priority |
|----|-------------|----------|
| HUNT-001 | Monaco-based query editor with CQL syntax highlighting | P0 |
| HUNT-002 | Autocomplete for field names based on indexed schema | P0 |
| HUNT-003 | Autocomplete for field values based on recent data | P1 |
| HUNT-004 | Syntax validation with inline error indicators | P0 |
| HUNT-005 | Query history with last 50 queries accessible via up/down arrows | P1 |
| HUNT-006 | Saved searches CRUD (create, read, update, delete) | P0 |
| HUNT-007 | Share saved searches with other users or make public | P2 |
| HUNT-008 | Time range picker with presets and custom range | P0 |
| HUNT-009 | Results table with sortable columns and pagination | P0 |
| HUNT-010 | Expandable row to view full event JSON | P0 |
| HUNT-011 | Export results to CSV, JSON, or NDJSON formats | P1 |
| HUNT-012 | Create alert rule from query (converts to detection rule) | P1 |
| HUNT-013 | Add events to existing investigation | P1 |
| HUNT-014 | Field statistics sidebar showing value distribution | P2 |
| HUNT-015 | Query execution time and result count display | P0 |
| HUNT-016 | Cancel long-running queries | P1 |
| HUNT-017 | Keyboard shortcut Ctrl+Enter to execute query | P0 |

#### 4.3.5 API Endpoints Required

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/v1/search` | POST | Execute CQL query |
| `/api/v1/search/validate` | POST | Validate CQL syntax |
| `/api/v1/search/fields` | GET | Get available field names |
| `/api/v1/search/fields/{field}/values` | GET | Get sample values for field |
| `/api/v1/saved-searches` | GET/POST | List/create saved searches |
| `/api/v1/saved-searches/{id}` | GET/PUT/DELETE | CRUD for saved search |
| `/api/v1/search/export` | POST | Export results to file |

#### 4.3.6 Acceptance Criteria

```gherkin
Feature: Query Builder (Threat Hunter)
  As a threat hunter
  I want to search and analyze security events using CQL
  So that I can identify threats and suspicious activity

  Scenario: Execute a CQL query
    Given I am on the Threat Hunter page
    When I enter a valid CQL query "process.name:powershell.exe"
    And I click the Execute button (or press Ctrl+Enter)
    Then the query should execute
    And results should display in the table
    And execution time and result count should be shown

  Scenario: Autocomplete field names
    Given I am typing a query in the editor
    When I type "process."
    Then autocomplete should show available fields like "process.name", "process.pid", "process.command_line"
    And I should be able to select a suggestion with Tab or Enter

  Scenario: Syntax validation
    Given I am typing a query
    When I enter invalid syntax "process.name AND"
    Then a red underline should appear under the error
    And hovering should show the error message
    And the Execute button should be disabled

  Scenario: Save a search
    Given I have entered a valid query
    When I click "Save Search"
    And I enter a name "Lateral Movement Hunt"
    And I click Save
    Then the search should appear in my Saved Searches list
    And I should be able to load it with one click

  Scenario: Export results
    Given I have executed a query with results
    When I click Export and select "CSV"
    Then a CSV file should download
    And it should contain all result columns
    And the filename should include the timestamp

  Scenario: Create alert from query
    Given I have a query that identifies suspicious activity
    When I click "Create Alert Rule"
    Then I should be navigated to the Rule creation form
    And the CQL query should be pre-populated
    And I can configure severity, name, and schedule
```

---

### 4.4 Rules Management

#### 4.4.1 Overview

The Rules Management module provides CRUD operations for SIGMA-compliant detection rules. Analysts can create, edit, test, enable/disable, and organize detection rules that generate alerts when matching events are detected.

#### 4.4.2 Wireframe

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CERBERUS > RULES                     [ğŸ” Ctrl+K]       [ğŸ”” 12] [ğŸ‘¤ Admin â–¾] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ [NAV]  â”‚ â”‚ [+ New Rule]  [Import SIGMA]  [Export]           [Search...] â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ FILTERS: Status [All â–¾] Severity [All â–¾] Tag [All â–¾]         â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ DETECTION RULES                                    [â†»] [â‹®]    â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ â—‰ â”‚ SEV â”‚ RULE NAME                â”‚ MITRE    â”‚ HITS â”‚ STATUS â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ â—‰ â”‚ â—â—â— â”‚ Ransomware Encryption    â”‚ T1486    â”‚ 47   â”‚ Active â”‚ â”‚
â”‚        â”‚ â”‚ â—‰ â”‚ â—â—â— â”‚ Mimikatz Usage           â”‚ T1003    â”‚ 12   â”‚ Active â”‚ â”‚
â”‚        â”‚ â”‚ â—‰ â”‚ â—â—â—‹ â”‚ Suspicious PowerShell    â”‚ T1059.001â”‚ 234  â”‚ Active â”‚ â”‚
â”‚        â”‚ â”‚ â—‹ â”‚ â—â—â—‹ â”‚ RDP Brute Force          â”‚ T1110    â”‚ 0    â”‚Disabledâ”‚ â”‚
â”‚        â”‚ â”‚ â—‰ â”‚ â—â—‹â—‹ â”‚ New Service Installed    â”‚ T1543    â”‚ 89   â”‚ Active â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ RULE EDITOR                                           [âœ•]     â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ Name: [Ransomware Encryption Behavior Detection          ]    â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ â”Œâ”€ METADATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Severity: [Critical â–¾]    Status: [â— Enabled]             â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Author: [admin          ]  License: [DRL-1.0     â–¾]       â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Tags: [ransomware] [encryption] [T1486] [+ Add]           â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ â”Œâ”€ DETECTION LOGIC (SIGMA YAML) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚        â”‚ â”‚ â”‚  1 â”‚ detection:                                           â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚  2 â”‚   selection:                                         â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚  3 â”‚     process.name:                                    â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚  4 â”‚       - '*.exe'                                      â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚  5 â”‚     file.extension:                                  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚  6 â”‚       - '.encrypted'                                 â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚  7 â”‚       - '.locked'                                    â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚  8 â”‚   condition: selection                               â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ â”Œâ”€ MITRE ATT&CK MAPPING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Tactic: [Impact         â–¾]                                â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Technique: [T1486 - Data Encrypted for Impact  â–¾]         â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ [Test Rule]  [Save Draft]  [Save & Enable]  [Cancel]          â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.4.3 Functional Requirements

| ID | Requirement | Priority |
|----|-------------|----------|
| RULE-001 | Display paginated list of all detection rules with filtering | P0 |
| RULE-002 | Create new detection rule with SIGMA YAML editor | P0 |
| RULE-003 | Monaco editor with SIGMA YAML syntax highlighting | P0 |
| RULE-004 | Validate SIGMA syntax on save with error reporting | P0 |
| RULE-005 | Enable/disable rules via toggle switch | P0 |
| RULE-006 | Import rules from SIGMA YAML files (single or bulk) | P0 |
| RULE-007 | Export rules to SIGMA YAML format | P1 |
| RULE-008 | Test rule against historical events (dry run) | P0 |
| RULE-009 | Display rule hit count (alerts generated) | P1 |
| RULE-010 | MITRE ATT&CK technique mapping with dropdown selection | P0 |
| RULE-011 | Tag management for rule organization | P1 |
| RULE-012 | Clone existing rule as template | P1 |
| RULE-013 | Version history for rule changes | P2 |
| RULE-014 | Bulk enable/disable selected rules | P1 |
| RULE-015 | Rule exception management (add conditions to exclude) | P1 |

#### 4.4.4 Rule Schema

```yaml
# SIGMA-Compliant Rule Structure
title: Ransomware Encryption Behavior Detection
id: 550d56b9-8f53-4ea2-8b74-b6c14a2d5f7c
status: enabled
description: Detects file encryption patterns associated with ransomware
author: SOC Team
date: 2024/11/29
modified: 2024/11/29
logsource:
  category: file_event
  product: windows
detection:
  selection:
    TargetFilename|endswith:
      - '.encrypted'
      - '.locked'
      - '.crypted'
    Image|endswith: '.exe'
  condition: selection
falsepositives:
  - Legitimate encryption software
level: critical
tags:
  - attack.impact
  - attack.t1486
```

#### 4.4.5 API Endpoints Required

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/v1/rules` | GET | List all rules with filtering |
| `/api/v1/rules` | POST | Create new rule |
| `/api/v1/rules/{id}` | GET | Get rule details |
| `/api/v1/rules/{id}` | PUT | Update rule |
| `/api/v1/rules/{id}` | DELETE | Delete rule |
| `/api/v1/rules/{id}/toggle` | PATCH | Enable/disable rule |
| `/api/v1/rules/{id}/test` | POST | Test rule against events |
| `/api/v1/rules/import` | POST | Import SIGMA rules |
| `/api/v1/rules/export` | GET | Export rules to SIGMA |
| `/api/v1/rules/bulk` | PATCH | Bulk operations |

#### 4.4.6 Acceptance Criteria

```gherkin
Feature: Rules Management
  As a security engineer
  I want to manage detection rules
  So that I can detect threats in my environment

  Scenario: Create a new detection rule
    Given I am on the Rules page
    When I click "New Rule"
    And I enter a rule name "Suspicious PowerShell Download"
    And I enter valid SIGMA YAML in the editor
    And I select severity "High"
    And I map MITRE technique "T1059.001"
    And I click "Save & Enable"
    Then the rule should be created and enabled
    And it should appear in the rules list

  Scenario: Test rule against historical data
    Given I have created a rule in draft mode
    When I click "Test Rule"
    And I select time range "Last 7 days"
    Then the system should execute the rule against historical events
    And display the number of matches found
    And show sample matching events

  Scenario: Import SIGMA rules
    Given I am on the Rules page
    When I click "Import SIGMA"
    And I select multiple SIGMA YAML files
    Then each file should be validated
    And valid rules should be imported
    And a summary should show success/failure counts

  Scenario: Disable a rule
    Given I have an active rule generating too many false positives
    When I toggle the rule status to disabled
    Then the rule should stop generating new alerts
    And the status should show "Disabled" in the list
```

---

### 4.5 Correlation Rules

#### 4.5.1 Overview

Correlation Rules enable detection of complex attack patterns that span multiple events, time windows, or entities. The module supports 7 correlation types for advanced threat detection scenarios.

#### 4.5.2 Wireframe

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CERBERUS > CORRELATION RULES         [ğŸ” Ctrl+K]       [ğŸ”” 12] [ğŸ‘¤ Admin â–¾] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ [NAV]  â”‚ â”‚ [+ New Correlation]                              [Search...] â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ CORRELATION RULES                                  [â†»] [â‹®]    â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ TYPE      â”‚ NAME                      â”‚ WINDOW  â”‚ STATUS      â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ count     â”‚ Brute Force Detection     â”‚ 5 min   â”‚ â— Active    â”‚ â”‚
â”‚        â”‚ â”‚ sequence  â”‚ Lateral Movement Chain    â”‚ 1 hour  â”‚ â— Active    â”‚ â”‚
â”‚        â”‚ â”‚ rare      â”‚ First Seen Process        â”‚ 7 days  â”‚ â— Active    â”‚ â”‚
â”‚        â”‚ â”‚ statistic â”‚ Anomalous Data Transfer   â”‚ 1 hour  â”‚ â—‹ Disabled  â”‚ â”‚
â”‚        â”‚ â”‚ chain     â”‚ Kill Chain Detection      â”‚ 24 hour â”‚ â— Active    â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ CORRELATION RULE BUILDER                              [âœ•]     â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ Name: [Brute Force Login Detection                       ]    â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ â”Œâ”€ CORRELATION TYPE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â—‹ count         â—‹ value_count    â—‹ sequence               â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â—‹ rare          â—‹ statistical    â—‹ cross_entity           â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â—‹ chain                                                    â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ â”Œâ”€ COUNT CONFIGURATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Base Query (CQL):                                         â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ event.action:logon_failed                              â”‚ â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                                                            â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Group By: [source.ip        â–¾]                            â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Threshold: [>=] [5] events                                â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Time Window: [5] [minutes â–¾]                              â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ â”Œâ”€ ALERT OUTPUT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Severity: [High    â–¾]    Title Template:                  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ [Brute Force: {{count}} failures from {{source.ip}}   ]   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ [Test Correlation]  [Save Draft]  [Save & Enable]  [Cancel]   â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.5.3 Correlation Types

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CORRELATION RULE TYPES                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  1. COUNT                                                                    â”‚
â”‚     Alert when event count exceeds threshold within time window              â”‚
â”‚     Example: 5+ failed logins from same IP in 5 minutes                      â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”                                â”‚
â”‚     â”‚ Evt â”‚ â”‚ Evt â”‚ â”‚ Evt â”‚ â”‚ Evt â”‚ â”‚ Evt â”‚ â”€â”€â”€â”€â”€â–¶ ALERT (count >= 5)      â”‚
â”‚     â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 5 min window â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                                              â”‚
â”‚  2. VALUE_COUNT                                                              â”‚
â”‚     Alert when distinct values exceed threshold                              â”‚
â”‚     Example: User accesses 10+ unique systems in 1 hour                      â”‚
â”‚                                                                              â”‚
â”‚  3. SEQUENCE                                                                 â”‚
â”‚     Alert when events occur in specific order                                â”‚
â”‚     Example: Recon â†’ Exploit â†’ Persistence (in order, within 1 hour)        â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚     â”‚ Recon â”‚ â”€â”€â”€â–¶ â”‚Exploitâ”‚ â”€â”€â”€â–¶ â”‚ Pers. â”‚ â”€â”€â”€â–¶ ALERT                     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                                                                              â”‚
â”‚  4. RARE                                                                     â”‚
â”‚     Alert on first occurrence of value (never seen before)                   â”‚
â”‚     Example: First time a process has been executed on host                  â”‚
â”‚                                                                              â”‚
â”‚  5. STATISTICAL                                                              â”‚
â”‚     Alert when values deviate from baseline (std dev)                        â”‚
â”‚     Example: Data transfer > 3 standard deviations from mean                 â”‚
â”‚                                                                              â”‚
â”‚  6. CROSS_ENTITY                                                             â”‚
â”‚     Alert when pattern spans multiple entities                               â”‚
â”‚     Example: Same malware hash seen on 5+ hosts                              â”‚
â”‚                                                                              â”‚
â”‚  7. CHAIN                                                                    â”‚
â”‚     Alert when multiple rules fire in sequence                               â”‚
â”‚     Example: Initial Access rule â†’ Lateral Movement rule â†’ Exfil rule        â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.5.4 CHAIN Correlation Type Configuration

The CHAIN correlation type requires specialized configuration UI for selecting multiple detection rules that must fire in sequence.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CHAIN CORRELATION CONFIGURATION                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€ RULE CHAIN BUILDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Chain Name: [Advanced Persistent Threat Detection            ]      â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€ RULE SEQUENCE (must fire in order) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚                                                              â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  STEP 1                                                      â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Rule: [Select Rule                              â–¾]    â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚       â”‚ â—‹ Initial Access - Phishing (SIGMA)        â”‚ â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚       â”‚ â— Initial Access - Spearphishing (SIGMA)   â”‚ â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚       â”‚ â—‹ Initial Access - Drive-by (SIGMA)        â”‚ â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚       â”‚ â—‹ Initial Access - External Remote (CQL)   â”‚ â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚       â”‚ [Search rules...                         ]  â”‚ â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Selected: Initial Access - Spearphishing Attachment  â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ MITRE: T1566.001 | Type: SIGMA | Severity: High      â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                            â”‚                                 â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                            â–¼                                 â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  STEP 2                                                      â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Rule: [Execution - Malicious PowerShell       â–¾]      â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Max Time from Step 1: [15   ] [minutes â–¾]             â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Entity Correlation: [â— Same Host  â—‹ Same User  â—‹ Any] â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ MITRE: T1059.001 | Type: SIGMA | Severity: High       â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                            â”‚                                 â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                            â–¼                                 â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  STEP 3                                                      â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Rule: [Lateral Movement - Pass the Hash       â–¾]      â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Max Time from Step 2: [60   ] [minutes â–¾]             â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Entity Correlation: [â— Same User  â—‹ Same Host  â—‹ Any] â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ MITRE: T1550.002 | Type: SIGMA | Severity: Critical   â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                            â”‚                                 â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                            â–¼                                 â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  STEP 4 (optional)                                           â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Rule: [Exfiltration - Large DNS Transfer      â–¾]      â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Max Time from Step 3: [24   ] [hours   â–¾]             â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Entity Correlation: [â—‹ Same User  â— Same Host  â—‹ Any] â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ MITRE: T1048.003 | Type: CQL | Severity: Critical     â”‚  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                              â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  [+ Add Step]  [â†‘ Move Up]  [â†“ Move Down]  [âœ• Remove Step]  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                              â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€ CHAIN CONFIGURATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚                                                                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Overall Time Window: [4    ] [hours â–¾] (max time for chain)  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Minimum Steps to Alert:                                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  [â—‹ All steps required  â— Minimum 3 steps  â—‹ Custom: [  ] ]   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Partial Match Behavior:                                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  [â— Track partial chains  â—‹ Alert on partial  â—‹ Ignore]       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Alert Severity: [Critical â–¾] (inherits highest or custom)    â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€ ALERT TEMPLATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚                                                                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Title: APT Chain Detected: {{matched_steps}} steps matched   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Description:                                                  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Detected attack chain on {{entity}}:                     â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ {{#each steps}}                                          â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ - Step {{step_num}}: {{rule_name}} at {{timestamp}}      â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ {{/each}}                                                â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Total chain duration: {{chain_duration}}                 â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Include in Alert:                                             â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  [âœ“] All matched events  [âœ“] MITRE techniques                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  [âœ“] Entity timeline     [âœ“] Recommended actions              â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  [Test Chain]  [Save Draft]  [Save & Enable]  [Cancel]                      â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**CHAIN Configuration Functional Requirements:**

| ID | Requirement | Priority |
|----|-------------|----------|
| CHAIN-001 | Multi-rule sequence selection with searchable rule dropdown | P0 |
| CHAIN-002 | Configurable time window between each chain step | P0 |
| CHAIN-003 | Entity correlation options (same host, same user, any) per step | P0 |
| CHAIN-004 | Drag-and-drop step reordering | P1 |
| CHAIN-005 | Minimum steps configuration for partial chain alerting | P1 |
| CHAIN-006 | Visual display of selected rule MITRE mappings | P1 |
| CHAIN-007 | Rule filtering by type (SIGMA/CQL), severity, MITRE tactic | P1 |
| CHAIN-008 | Preview of combined MITRE coverage across chain steps | P2 |

#### 4.5.5 Functional Requirements

| ID | Requirement | Priority |
|----|-------------|----------|
| CORR-001 | Support all 7 correlation types with type-specific configuration UI | P0 |
| CORR-002 | CQL query builder for base event selection | P0 |
| CORR-003 | Configurable time windows (minutes, hours, days) | P0 |
| CORR-004 | Group-by field selection for aggregation | P0 |
| CORR-005 | Threshold configuration with comparison operators | P0 |
| CORR-006 | Alert title/description templates with variable substitution | P0 |
| CORR-007 | Test correlation against historical data | P0 |
| CORR-008 | Visual sequence builder for sequence/chain types | P1 |
| CORR-009 | Baseline configuration for statistical correlations | P1 |
| CORR-010 | Enable/disable correlations | P0 |
| CORR-011 | View correlation state (current counts, sequences in progress) | P2 |

#### 4.5.6 Acceptance Criteria

```gherkin
Feature: Correlation Rules
  As a detection engineer
  I want to create correlation rules
  So that I can detect complex multi-event attack patterns

  Scenario: Create count-based correlation
    Given I am on the Correlation Rules page
    When I click "New Correlation"
    And I select type "count"
    And I enter base query "event.action:logon_failed"
    And I set group by to "source.ip"
    And I set threshold to ">= 5"
    And I set time window to "5 minutes"
    And I click "Save & Enable"
    Then the correlation should be created
    And it should start monitoring events

  Scenario: Create sequence correlation
    Given I am creating a new sequence correlation
    When I add step 1 with query "event.action:initial_access"
    And I add step 2 with query "event.action:lateral_movement"
    And I add step 3 with query "event.action:exfiltration"
    And I set time window to "1 hour"
    And I enable "strict ordering"
    Then the correlation should detect the sequence when all steps match in order

  Scenario: Test correlation rule
    Given I have configured a correlation rule
    When I click "Test Correlation"
    And I select "Last 24 hours"
    Then the system should evaluate the correlation
    And show how many times it would have triggered
    And display sample alert outputs
```

---

### 4.6 Investigations

#### 4.6.1 Overview

The Investigations module provides a structured workspace for managing security incidents from detection through resolution. It supports full investigation lifecycle management with evidence collection, timeline visualization, and collaboration features.

#### 4.6.2 Wireframe

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CERBERUS > INVESTIGATIONS            [ğŸ” Ctrl+K]       [ğŸ”” 12] [ğŸ‘¤ Admin â–¾] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ [NAV]  â”‚ â”‚ [+ New Investigation]                            [Search...] â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚        â”‚ â”‚ â–ŒOPEN    â”‚ â”‚ â–ŒIN PROG â”‚ â”‚ â–ŒPENDING â”‚ â”‚ â–ŒCLOSED  â”‚               â”‚
â”‚        â”‚ â”‚    12    â”‚ â”‚     8    â”‚ â”‚     3    â”‚ â”‚    47    â”‚               â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ INVESTIGATIONS                                     [â†»] [â‹®]    â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ ID    â”‚ TITLE                    â”‚ SEV â”‚ ASSIGNEE â”‚ STATUS    â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ INV-47â”‚ Ransomware Incident      â”‚ â—â—â— â”‚ jsmith   â”‚ In Prog   â”‚ â”‚
â”‚        â”‚ â”‚ INV-46â”‚ Credential Compromise    â”‚ â—â—â— â”‚ alee     â”‚ Open      â”‚ â”‚
â”‚        â”‚ â”‚ INV-45â”‚ Data Exfiltration        â”‚ â—â—â—‹ â”‚ mjones   â”‚ Pending   â”‚ â”‚
â”‚        â”‚ â”‚ INV-44â”‚ Malware Outbreak         â”‚ â—â—â—‹ â”‚ jsmith   â”‚ In Prog   â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ INVESTIGATION: INV-47 - Ransomware Incident           [âœ•]     â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ â”Œâ”€ OVERVIEW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Status: [In Progress â–¾]  Severity: CRITICAL               â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Assignee: [jsmith     â–¾]  Created: 2024-11-29 10:15 UTC   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Tags: [ransomware] [critical] [T1486]                     â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ â”Œâ”€ TABS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ [Timeline] [Alerts(12)] [Evidence] [Notes] [Actions]      â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ â”Œâ”€ TIMELINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                                                            â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚  10:15 â”€â”€â—â”€â”€ Investigation created                        â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚           â”‚                                                â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚  10:17 â”€â”€â—â”€â”€ Alert linked: Ransomware Detected            â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚           â”‚                                                â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚  10:23 â”€â”€â—â”€â”€ Evidence added: malware.exe (SHA256: a1b2...) â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚           â”‚                                                â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚  10:45 â”€â”€â—â”€â”€ Host WKS-042 isolated (SOAR action)          â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚           â”‚                                                â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚  11:02 â”€â”€â—â”€â”€ Note: Identified patient zero                â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                                                            â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ [Add Note] [Link Alert] [Add Evidence] [Run Playbook] [Close] â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.6.3 Investigation Evidence Tab

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ INVESTIGATION: INV-47 - Ransomware Incident                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€ TABS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ [Timeline] [Alerts(12)] [â–¸Evidence(8)] [Notes] [Actions]               â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚ â”Œâ”€ EVIDENCE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚                                                                         â”‚  â”‚
â”‚ â”‚  [+ Add Evidence â–¾]  [Upload File]  [Add IOC]  [Add Artifact]          â”‚  â”‚
â”‚ â”‚                                                                         â”‚  â”‚
â”‚ â”‚  â”Œâ”€ FILTER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚ â”‚  â”‚ Type: [All Types    â–¾]  Added By: [All Users â–¾]  [Search...]     â”‚ â”‚  â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚ â”‚                                                                         â”‚  â”‚
â”‚ â”‚  â”Œâ”€ EVIDENCE LIST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚ â”‚  â”‚                                                                    â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  FILES (3)                                                         â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚ ğŸ“„ malware.exe                                               â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚    Size: 1.2 MB | SHA256: a1b2c3d4...f8e9 | Added: 10:23     â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚    Added by: jsmith | Tags: [malware] [initial-payload]      â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚    [Download] [View Hash Analysis] [Delete]                   â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚ ğŸ“„ ransom_note.txt                                           â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚    Size: 2.1 KB | SHA256: e5f6g7h8...i9j0 | Added: 10:28     â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚    Added by: jsmith | Tags: [ransom-note]                     â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚    [Download] [View Contents] [Delete]                        â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚ ğŸ“„ memory_dump.dmp                                           â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚    Size: 4.2 GB | SHA256: k1l2m3n4...o5p6 | Added: 11:15     â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚    Added by: alee | Tags: [memory-forensics]                  â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚    [Download] [Delete]                                        â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚                                                                    â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  IOCs - INDICATORS OF COMPROMISE (4)                               â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚ TYPE       â”‚ VALUE                    â”‚ CONTEXT    â”‚ â‹®       â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚ SHA256     â”‚ a1b2c3d4e5f6g7h8i9j0... â”‚ Malware     â”‚ â‹®       â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚ IP Address â”‚ 185.220.101.42           â”‚ C2 Server   â”‚ â‹®       â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚ Domain     â”‚ evil-c2.example.com      â”‚ C2 Domain   â”‚ â‹®       â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚ Email      â”‚ attacker@protonmail.com  â”‚ Ransom Contactâ”‚ â‹®     â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚                                                                    â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  ARTIFACTS (1)                                                     â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚ ğŸ”§ Registry Key: HKLM\Software\...\Run\malware_persist       â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚    Context: Persistence mechanism                             â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â”‚    Added by: jsmith at 10:35                                  â”‚ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚  â”‚
â”‚ â”‚  â”‚                                                                    â”‚ â”‚  â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚ â”‚                                                                         â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UPLOAD EVIDENCE FILE                                                   [âœ•]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€ FILE UPLOAD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚                                                                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚               ğŸ“ Drag & Drop files here                        â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                    or click to browse                          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚          Supported: Any file type up to 100MB                  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚          For files >100MB, use external storage link           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Or link to external storage:                                        â”‚   â”‚
â”‚  â”‚  [https://storage.example.com/evidence/...                     ]    â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€ FILE DETAILS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Selected: malware_sample.exe (1.2 MB)                               â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Description:                                                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ Initial malware payload extracted from WKS-042                 â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Tags: [malware         ] [+]                                        â”‚   â”‚
â”‚  â”‚        [initial-payload] [âœ•]                                         â”‚   â”‚
â”‚  â”‚        [T1486           ] [âœ•]                                         â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Evidence Type:                                                       â”‚   â”‚
â”‚  â”‚  [â— Malware Sample  â—‹ Log File  â—‹ Memory Dump  â—‹ Screenshot         â”‚   â”‚
â”‚  â”‚   â—‹ Network Capture  â—‹ Document  â—‹ Other]                            â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Chain of Custody:                                                    â”‚   â”‚
â”‚  â”‚  [âœ“] Log collection timestamp and source                             â”‚   â”‚
â”‚  â”‚  [âœ“] Calculate and store hash (SHA256, MD5)                          â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  âš ï¸  Files will be scanned for known malware signatures             â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€ UPLOAD PROGRESS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  malware_sample.exe   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  67%  1.2 MB   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  [Upload]  [Cancel]                                                         â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ADD IOC                                                                [âœ•]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  IOC Type: [Select Type                                              â–¾]     â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚            â”‚ â—‹ SHA256 Hash        â—‹ IP Address                           â”‚  â”‚
â”‚            â”‚ â—‹ MD5 Hash           â—‹ Domain                               â”‚  â”‚
â”‚            â”‚ â—‹ SHA1 Hash          â—‹ URL                                  â”‚  â”‚
â”‚            â”‚ â—‹ File Name          â—‹ Email Address                        â”‚  â”‚
â”‚            â”‚ â—‹ Registry Key       â—‹ CVE ID                               â”‚  â”‚
â”‚            â”‚ â—‹ Mutex Name         â—‹ User Agent                           â”‚  â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚  Value: [                                                             ]     â”‚
â”‚                                                                              â”‚
â”‚  Context/Description:                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ C2 server identified from network traffic analysis                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚  Threat Intel Lookup:                                                        â”‚
â”‚  [âœ“] Auto-query VirusTotal    [âœ“] Auto-query AbuseIPDB                      â”‚
â”‚  [âœ“] Auto-query OTX           [ ] Auto-query MISP                           â”‚
â”‚                                                                              â”‚
â”‚  Tags: [c2-server    ] [+]                                                  â”‚
â”‚                                                                              â”‚
â”‚  [Add IOC]  [Add & Continue]  [Cancel]                                      â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Evidence Management Functional Requirements:**

| ID | Requirement | Priority |
|----|-------------|----------|
| EVID-001 | Upload evidence files with drag-and-drop support | P0 |
| EVID-002 | Support for large files up to 100MB with progress indicator | P0 |
| EVID-003 | External storage link support for files >100MB | P1 |
| EVID-004 | Automatic SHA256 and MD5 hash calculation on upload | P0 |
| EVID-005 | Evidence categorization by type (malware, log, memory dump, etc.) | P0 |
| EVID-006 | Tag management for evidence items | P1 |
| EVID-007 | Chain of custody logging (who uploaded, when, from where) | P0 |
| EVID-008 | IOC (Indicators of Compromise) management with type validation | P0 |
| EVID-009 | Auto-query threat intelligence platforms for IOCs | P1 |
| EVID-010 | Filter and search evidence within investigation | P1 |
| EVID-011 | Download evidence files with audit logging | P0 |
| EVID-012 | View file contents inline (text files, images) | P2 |
| EVID-013 | Link to external hash analysis services (VirusTotal, etc.) | P1 |
| EVID-014 | Artifact documentation (registry keys, processes, etc.) | P1 |
| EVID-015 | Bulk IOC import from CSV/STIX format | P2 |

**Evidence API Endpoints:**

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/v1/investigations/{id}/evidence` | GET | List all evidence |
| `/api/v1/investigations/{id}/evidence` | POST | Upload evidence file |
| `/api/v1/investigations/{id}/evidence/{eid}` | GET | Get evidence details |
| `/api/v1/investigations/{id}/evidence/{eid}` | DELETE | Delete evidence |
| `/api/v1/investigations/{id}/evidence/{eid}/download` | GET | Download evidence file |
| `/api/v1/investigations/{id}/iocs` | GET/POST | List/add IOCs |
| `/api/v1/investigations/{id}/iocs/{iocId}` | DELETE | Delete IOC |
| `/api/v1/investigations/{id}/artifacts` | GET/POST | List/add artifacts |

#### 4.6.4 Investigation Lifecycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      INVESTIGATION LIFECYCLE                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚   â”‚  OPEN  â”‚â”€â”€â”€â–¶â”‚IN_PROGRESS â”‚â”€â”€â”€â–¶â”‚ AWAITING_REVIEW â”‚â”€â”€â”€â–¶â”‚ PENDING â”‚       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚       â”‚              â”‚                    â”‚                   â”‚             â”‚
â”‚       â”‚              â”‚                    â”‚                   â–¼             â”‚
â”‚       â”‚              â”‚                    â”‚             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚       â”‚              â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  CLOSED  â”‚        â”‚
â”‚       â”‚              â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚       â”‚              â”‚                                       â”‚              â”‚
â”‚       â”‚              â”‚                                       â–¼              â”‚
â”‚       â”‚              â”‚                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚       â”‚              â”‚                                 â”‚ REOPENED â”‚         â”‚
â”‚       â”‚              â”‚                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚       â”‚              â”‚                                       â”‚              â”‚
â”‚       â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚       â”‚                                                                      â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Can be CANCELLED at any time â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                                              â”‚
â”‚   Status Definitions:                                                        â”‚
â”‚   â€¢ OPEN: New investigation, not yet started                                â”‚
â”‚   â€¢ IN_PROGRESS: Active investigation with assigned analyst                 â”‚
â”‚   â€¢ AWAITING_REVIEW: Analysis complete, pending manager/peer review         â”‚
â”‚   â€¢ PENDING: Awaiting external input (e.g., legal, management)             â”‚
â”‚   â€¢ CLOSED: Investigation complete (with verdict)                           â”‚
â”‚   â€¢ REOPENED: Previously closed, new evidence requires review               â”‚
â”‚   â€¢ CANCELLED: Determined to be non-incident                                â”‚
â”‚                                                                              â”‚
â”‚   Verdicts (on close):                                                       â”‚
â”‚   â€¢ TRUE_POSITIVE: Confirmed security incident                              â”‚
â”‚   â€¢ FALSE_POSITIVE: Not a security incident                                 â”‚
â”‚   â€¢ BENIGN: Activity was legitimate/authorized                              â”‚
â”‚   â€¢ INCONCLUSIVE: Unable to determine                                       â”‚
â”‚                                                                              â”‚
â”‚   State Transition Rules:                                                    â”‚
â”‚   â€¢ OPEN â†’ IN_PROGRESS: When analyst begins work                            â”‚
â”‚   â€¢ IN_PROGRESS â†’ AWAITING_REVIEW: When analyst submits for review          â”‚
â”‚   â€¢ AWAITING_REVIEW â†’ PENDING: If external input needed                     â”‚
â”‚   â€¢ AWAITING_REVIEW â†’ CLOSED: When reviewer approves with verdict           â”‚
â”‚   â€¢ AWAITING_REVIEW â†’ IN_PROGRESS: If reviewer requests changes             â”‚
â”‚   â€¢ CLOSED â†’ REOPENED: When new evidence emerges                            â”‚
â”‚   â€¢ Any state â†’ CANCELLED: When determined non-incident                     â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.6.5 Functional Requirements

| ID | Requirement | Priority |
|----|-------------|----------|
| INV-001 | Create investigations manually or from alerts | P0 |
| INV-002 | Investigation list with status-based filtering and KPI cards | P0 |
| INV-003 | Full lifecycle management (status transitions, verdicts) | P0 |
| INV-004 | Link multiple alerts to a single investigation | P0 |
| INV-005 | Visual timeline showing all investigation activity | P0 |
| INV-006 | Evidence management (add files, IOCs, artifacts) | P0 |
| INV-007 | Analyst notes with markdown support | P0 |
| INV-008 | Assignment and reassignment of investigators | P0 |
| INV-009 | Execute SOAR playbooks from investigation context | P1 |
| INV-010 | Tag management for categorization | P1 |
| INV-011 | Export investigation report (PDF, markdown) | P2 |
| INV-012 | SLA tracking (time to acknowledge, time to close) | P2 |
| INV-013 | Related investigations linking | P2 |

#### 4.6.6 API Endpoints Required

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/v1/investigations` | GET/POST | List/create investigations |
| `/api/v1/investigations/{id}` | GET/PUT/DELETE | CRUD operations |
| `/api/v1/investigations/{id}/status` | PATCH | Update status/verdict |
| `/api/v1/investigations/{id}/alerts` | GET/POST | List/link alerts |
| `/api/v1/investigations/{id}/evidence` | GET/POST | List/add evidence |
| `/api/v1/investigations/{id}/notes` | GET/POST | List/add notes |
| `/api/v1/investigations/{id}/timeline` | GET | Get activity timeline |
| `/api/v1/investigations/{id}/playbooks` | POST | Execute playbook |

#### 4.6.7 Acceptance Criteria

```gherkin
Feature: Investigations
  As a security analyst
  I want to manage security investigations
  So that I can track and resolve security incidents

  Scenario: Create investigation from alert
    Given I am viewing an alert that requires investigation
    When I click "Create Investigation"
    And I enter a title "Suspected Ransomware - WKS-042"
    And I set severity to "Critical"
    And I click "Create"
    Then a new investigation should be created
    And the alert should be automatically linked
    And I should be navigated to the investigation workspace

  Scenario: Add evidence to investigation
    Given I am viewing an open investigation
    When I click "Add Evidence"
    And I upload a malware sample file
    And I add a note "Collected from infected host"
    Then the evidence should appear in the Evidence tab
    And the timeline should show the evidence addition

  Scenario: Close investigation with verdict
    Given I have completed my investigation
    When I click "Close Investigation"
    And I select verdict "True Positive"
    And I enter closing notes
    Then the investigation status should change to "Closed"
    And all linked alerts should be marked as resolved
    And the closure should appear in the timeline

  Scenario: Execute SOAR playbook
    Given I am viewing an active investigation
    When I click "Run Playbook"
    And I select "Isolate Host" playbook
    And I confirm the action
    Then the playbook should execute
    And the action should appear in the timeline
    And I should see the playbook execution status
```

---

### 4.7 Listeners Management

#### 4.7.1 Overview

The Listeners Management module enables configuration and monitoring of data ingestion endpoints. It supports multiple protocols (Syslog, CEF, JSON, Fluentd) and provides real-time visibility into listener health, throughput, and parsing errors.

#### 4.7.2 Wireframe

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CERBERUS > LISTENERS                 [ğŸ” Ctrl+K]       [ğŸ”” 12] [ğŸ‘¤ Admin â–¾] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ [NAV]  â”‚ â”‚ [+ New Listener]                                 [Search...] â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚        â”‚ â”‚ â–ŒTOTAL   â”‚ â”‚ â–ŒACTIVE  â”‚ â”‚ â–ŒEPS     â”‚ â”‚ â–ŒDLQ     â”‚               â”‚
â”‚        â”‚ â”‚    8     â”‚ â”‚    6     â”‚ â”‚  8,432   â”‚ â”‚   127    â”‚               â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ LISTENERS                                          [â†»] [â‹®]    â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ STATUSâ”‚ NAME           â”‚ PROTOCOL â”‚ PORT  â”‚ EPS   â”‚ ERRORS    â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚  â—    â”‚ Syslog-Primary â”‚ Syslog   â”‚ 514   â”‚ 3,241 â”‚ 0         â”‚ â”‚
â”‚        â”‚ â”‚  â—    â”‚ CEF-Firewall   â”‚ CEF      â”‚ 1514  â”‚ 2,108 â”‚ 12        â”‚ â”‚
â”‚        â”‚ â”‚  â—    â”‚ JSON-Apps      â”‚ JSON     â”‚ 8080  â”‚ 1,847 â”‚ 3         â”‚ â”‚
â”‚        â”‚ â”‚  â—    â”‚ Fluentd-K8s    â”‚ Fluentd  â”‚ 24224 â”‚ 1,236 â”‚ 0         â”‚ â”‚
â”‚        â”‚ â”‚  â—‹    â”‚ Syslog-DR      â”‚ Syslog   â”‚ 1514  â”‚ 0     â”‚ 0         â”‚ â”‚
â”‚        â”‚ â”‚  â—    â”‚ CEF-EDR        â”‚ CEF      â”‚ 5514  â”‚ 412   â”‚ 112       â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ LISTENER DETAILS: Syslog-Primary                      [âœ•]     â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ â”Œâ”€ CONFIGURATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Name: [Syslog-Primary        ]  Status: [â— Running]       â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Protocol: [Syslog (RFC 5424) â–¾]                           â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Bind Address: [0.0.0.0       ]  Port: [514    ]          â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Transport: [â—‹ UDP  â— TCP  â—‹ TLS]                          â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ â”Œâ”€ FIELD MAPPING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Mapping Profile: [SIGMA Standard       â–¾]                 â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ Source Field     â”‚ Target Field                 â”‚       â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ src_ip           â”‚ source.ip                    â”‚       â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ dst_ip           â”‚ destination.ip               â”‚       â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ hostname         â”‚ host.name                    â”‚       â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ â”Œâ”€ METRICS (LAST 1 HOUR) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚        â”‚ â”‚ â”‚      â•­â”€â”€â•®                                                  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   â•­â”€â”€â•¯  â•°â”€â”€â•®     â•­â”€â”€â”€â”€â•®                                   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”€â”€â•¯        â•°â”€â”€â”€â”€â”€â•¯    â•°â”€â”€â”€â”€â”€â”€â”€â”€                           â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Events/sec â”‚ Avg: 3,241 â”‚ Peak: 4,892 â”‚ Errors: 0        â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ [Start/Stop] [Edit] [View DLQ] [Test Connection] [Delete]     â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.7.3 Protocol Support Matrix

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SUPPORTED PROTOCOLS                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  PROTOCOL        â”‚ TRANSPORT    â”‚ DEFAULT PORT â”‚ FEATURES                   â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚  Syslog RFC 5424 â”‚ UDP/TCP/TLS  â”‚ 514          â”‚ Structured data, priority  â”‚
â”‚  Syslog RFC 3164 â”‚ UDP/TCP      â”‚ 514          â”‚ Legacy BSD format          â”‚
â”‚  CEF             â”‚ TCP/TLS      â”‚ 1514         â”‚ ArcSight format, key=value â”‚
â”‚  JSON            â”‚ HTTP/HTTPS   â”‚ 8080         â”‚ REST API, batch support    â”‚
â”‚  Fluentd         â”‚ TCP          â”‚ 24224        â”‚ Forward protocol, msgpack  â”‚
â”‚                                                                              â”‚
â”‚  FLUENTD/MESSAGEPACK OPTIONS:                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Protocol Version: [â— Forward v1  â—‹ Forward v0 (legacy)]              â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  MessagePack Decoding:                                                 â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ Timestamp Format: [â— EventTime (ns precision)  â—‹ Integer (sec)]  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ String Encoding:  [â— UTF-8  â—‹ Binary passthrough]                â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ Max Nested Depth: [10     ] (prevent deeply nested objects)      â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ Max Array Size:   [10000  ] (max elements per array)             â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ Max Map Size:     [1000   ] (max key-value pairs per map)        â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  Tag Handling:                                                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ Tag Field Name: [tag                    ] (store tag as field)   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ Tag Filter:     [kubernetes.*           ] (glob pattern, blank=all)â”‚ â”‚
â”‚  â”‚  â”‚ Split on dot:   [âœ“] Parse tag.subcomponent into nested fields    â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  Chunk/ACK Mode:                                                       â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ [âœ“] Enable chunk acknowledgment (requires at_least_once)         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ ACK Timeout: [30   ] seconds                                     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ [âœ“] Require shared key authentication                            â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ Shared Key: [â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢] [Show] [Generate]                 â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  Fluent Bit Compatibility:                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ [âœ“] Accept Fluent Bit format (compact msgpack)                   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ [âœ“] Parse kubernetes metadata from standard fields               â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ [ ] Enable gzip compression                                       â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  TLS OPTIONS (when enabled):                                                â”‚
â”‚  â€¢ Minimum version: TLS 1.2                                                 â”‚
â”‚  â€¢ Certificate validation: Optional (configurable)                          â”‚
â”‚  â€¢ Client certificate auth: Optional (mTLS)                                 â”‚
â”‚                                                                              â”‚
â”‚  CONNECTION LIMITS:                                                          â”‚
â”‚  â€¢ Global max connections: 1,000                                            â”‚
â”‚  â€¢ Per-IP max connections: 10                                               â”‚
â”‚  â€¢ Connection timeout: 30 seconds                                           â”‚
â”‚  â€¢ Idle timeout: 300 seconds                                                â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.7.4 Dead Letter Queue (DLQ) Management

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DEAD LETTER QUEUE - CEF-EDR                                         [âœ•]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Summary: 112 events failed parsing in the last 24 hours                    â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€ FILTER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Error Type: [All Types      â–¾]  Time: [Last 24h â–¾]  [Search...]     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€ DLQ ENTRIES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â–¡ â”‚ TIMESTAMP           â”‚ ERROR TYPE        â”‚ SOURCE IP   â”‚ SIZE    â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ â–¡ â”‚ 2024-11-29 14:32:17 â”‚ Invalid CEF headerâ”‚ 10.0.1.45   â”‚ 1.2 KB  â”‚   â”‚
â”‚  â”‚ â–¡ â”‚ 2024-11-29 14:31:02 â”‚ Field parse error â”‚ 10.0.1.45   â”‚ 892 B   â”‚   â”‚
â”‚  â”‚ â–¡ â”‚ 2024-11-29 14:28:45 â”‚ Timestamp invalid â”‚ 10.0.2.12   â”‚ 1.1 KB  â”‚   â”‚
â”‚  â”‚ â–¡ â”‚ 2024-11-29 14:25:33 â”‚ Missing required  â”‚ 10.0.1.45   â”‚ 756 B   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€ RAW EVENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ CEF:0|Security|EDR|1.0|100|Malware Detected|10|                      â”‚   â”‚
â”‚  â”‚ src=10.0.1.45 dst=192.168.1.1 spt=443 dpt=80                        â”‚   â”‚
â”‚  â”‚ msg=Invalid timestamp format in field 'rt'                           â”‚   â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚   â”‚
â”‚  â”‚ Error: Expected epoch milliseconds, got "Nov 29 2024 14:28:45"       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  [Replay Selected] [Replay All] [Delete Selected] [Export] [Clear DLQ]      â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.7.5 DLQ Replay Progress & Feedback

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DLQ REPLAY IN PROGRESS                                                 [âœ•]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Replaying 47 selected events from CEF-EDR Dead Letter Queue                â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€ PROGRESS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  42%            â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Total:      47 events                                                â”‚   â”‚
â”‚  â”‚  Processed:  20 events                                                â”‚   â”‚
â”‚  â”‚  Succeeded:  15 events                                                â”‚   â”‚
â”‚  â”‚  Failed:     5 events                                                 â”‚   â”‚
â”‚  â”‚  Remaining:  27 events                                                â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Elapsed: 00:01:23    Estimated remaining: 00:01:58                   â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€ LIVE LOG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 14:32:45 âœ“ Event 1 replayed successfully                             â”‚   â”‚
â”‚  â”‚ 14:32:46 âœ“ Event 2 replayed successfully                             â”‚   â”‚
â”‚  â”‚ 14:32:47 âœ— Event 3 failed: Still invalid CEF header after retry      â”‚   â”‚
â”‚  â”‚ 14:32:48 âœ“ Event 4 replayed successfully                             â”‚   â”‚
â”‚  â”‚ 14:32:49 âœ— Event 5 failed: Field mapping not found for 'customField' â”‚   â”‚
â”‚  â”‚ 14:32:50 âœ“ Event 6 replayed successfully                             â”‚   â”‚
â”‚  â”‚ ...                                                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  [Pause]  [Cancel]                                                          â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DLQ REPLAY COMPLETE                                                    [âœ•]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€ SUMMARY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  âœ“ Replay completed in 00:03:21                                      â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Total Processed:   47 events                                         â”‚   â”‚
â”‚  â”‚  Successfully Parsed: 38 events (81%)  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘           â”‚   â”‚
â”‚  â”‚  Permanently Failed:  9 events (19%)   â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘           â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€ FAILED EVENTS (9) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚ ERROR CATEGORY         â”‚ COUNT â”‚ ACTION                              â”‚   â”‚
â”‚  â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚   â”‚
â”‚  â”‚ Invalid CEF header     â”‚   4   â”‚ [View Events] [Delete] [Export]    â”‚   â”‚
â”‚  â”‚ Missing field mapping  â”‚   3   â”‚ [View Events] [Configure Mapping]  â”‚   â”‚
â”‚  â”‚ Timestamp parse error  â”‚   2   â”‚ [View Events] [Delete] [Export]    â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚ âš ï¸  Failed events remain in DLQ for review                           â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€ RECOMMENDATIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚ â€¢ 3 events failed due to missing field mapping for 'customField1'    â”‚   â”‚
â”‚  â”‚   â†’ [Add Field Mapping] to resolve this category                     â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚ â€¢ 4 events have permanently malformed headers                        â”‚   â”‚
â”‚  â”‚   â†’ Consider contacting source system administrator                  â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  [Download Report]  [View Remaining DLQ]  [Close]                           â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**DLQ Replay Functional Requirements:**

| ID | Requirement | Priority |
|----|-------------|----------|
| DLQ-001 | Real-time progress bar showing replay completion percentage | P0 |
| DLQ-002 | Live event count display (total, processed, succeeded, failed) | P0 |
| DLQ-003 | Estimated time remaining calculation | P1 |
| DLQ-004 | Live log showing per-event success/failure status | P0 |
| DLQ-005 | Pause and resume replay operation | P1 |
| DLQ-006 | Cancel replay with confirmation dialog | P0 |
| DLQ-007 | Completion summary with categorized failure breakdown | P0 |
| DLQ-008 | Actionable recommendations for failed event categories | P1 |
| DLQ-009 | Quick links to configure field mappings for mapping errors | P1 |
| DLQ-010 | Export replay report (JSON/CSV) | P2 |
| DLQ-011 | WebSocket-based real-time progress updates | P0 |
| DLQ-012 | Retain failed events in DLQ after replay attempt | P0 |

#### 4.7.6 Field Mapping Management

Field mappings translate source log fields to normalized SIGMA/ECS field names for consistent detection rule matching.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CERBERUS > SETTINGS > FIELD MAPPINGS       [ğŸ” Ctrl+K]    [ğŸ”” 12] [ğŸ‘¤ Admin â–¾] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        â”‚                                                                    â”‚
â”‚ [NAV]  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ FIELD MAPPINGS                             [+ New Mapping]     â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ â”Œâ”€ MAPPING PROFILES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ NAME              â”‚ SOURCE TYPE â”‚ FIELDS â”‚ LISTENERS â”‚ â‹®   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Windows-EventLog  â”‚ JSON        â”‚ 47     â”‚ 3         â”‚ â‹®   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Palo-Alto-FW      â”‚ Syslog      â”‚ 32     â”‚ 2         â”‚ â‹®   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ AWS-CloudTrail    â”‚ JSON        â”‚ 58     â”‚ 1         â”‚ â‹®   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ CrowdStrike-EDR   â”‚ CEF         â”‚ 41     â”‚ 1         â”‚ â‹®   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Kubernetes-Audit  â”‚ Fluentd     â”‚ 29     â”‚ 2         â”‚ â‹®   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ â”Œâ”€ EDIT MAPPING: Windows-EventLog â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                                                             â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Profile Name: [Windows-EventLog                         ]  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Description:  [Windows Event Log via WEF/Sysmon         ]  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Source Type:  [JSON        â–¾]                              â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                                                             â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”Œâ”€ FIELD MAPPINGS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚                                                       â”‚   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ SOURCE FIELD          â†’ TARGET FIELD (SIGMA/ECS)     â”‚   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ EventData.User        â†’ user.name              [âœ•]   â”‚   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ EventData.Image       â†’ process.executable     [âœ•]   â”‚   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ EventData.CommandLine â†’ process.command_line   [âœ•]   â”‚   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ EventData.ParentImage â†’ process.parent.executable[âœ•] â”‚   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ EventData.SourceIp    â†’ source.ip              [âœ•]   â”‚   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ EventData.DestinationIpâ†’ destination.ip        [âœ•]   â”‚   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ System.TimeCreated    â†’ @timestamp             [âœ•]   â”‚   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ System.Computer       â†’ host.name              [âœ•]   â”‚   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ System.EventID        â†’ event.code             [âœ•]   â”‚   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚                                                       â”‚   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ [+ Add Mapping]                                       â”‚   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚                                                       â”‚   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                                                             â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”Œâ”€ ADD NEW MAPPING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚                                                        â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ Source Field: [EventData.                          ]  â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚               (supports dot notation for nested)      â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚                                                        â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ Target Field: [                                   â–¾]  â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚               â”‚ Common SIGMA Fields:                â”‚ â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚               â”‚ â—‹ user.name                         â”‚ â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚               â”‚ â—‹ user.domain                       â”‚ â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚               â”‚ â—‹ process.name                      â”‚ â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚               â”‚ â—‹ process.executable                â”‚ â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚               â”‚ â—‹ process.command_line              â”‚ â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚               â”‚ â—‹ process.pid                       â”‚ â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚               â”‚ â—‹ host.name                         â”‚ â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚               â”‚ â—‹ source.ip                         â”‚ â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚               â”‚ â—‹ destination.ip                    â”‚ â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚               â”‚ â—‹ file.path                         â”‚ â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚               â”‚ â—‹ registry.path                     â”‚ â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚               â”‚ [Type custom field name...]         â”‚ â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚                                                        â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ Transform:    [â—‹ None  â—‹ Lowercase  â—‹ Uppercase       â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚                â—‹ Extract (regex)  â—‹ Split]            â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚                                                        â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â”‚ [Add Mapping]  [Cancel]                                â”‚  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                                                             â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ [Import from YAML]  [Export YAML]  [Clone Profile]         â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                                                             â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ [Save]  [Test Mapping]  [Delete Profile]  [Cancel]         â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                                                             â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TEST FIELD MAPPING                                                    [âœ•]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Paste a sample event to test field mapping:                                â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€ INPUT EVENT (JSON) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ {                                                                     â”‚   â”‚
â”‚  â”‚   "System": {                                                         â”‚   â”‚
â”‚  â”‚     "TimeCreated": "2024-11-29T14:32:17.123Z",                       â”‚   â”‚
â”‚  â”‚     "Computer": "WKS-042",                                            â”‚   â”‚
â”‚  â”‚     "EventID": 1                                                      â”‚   â”‚
â”‚  â”‚   },                                                                  â”‚   â”‚
â”‚  â”‚   "EventData": {                                                      â”‚   â”‚
â”‚  â”‚     "User": "DOMAIN\\jsmith",                                        â”‚   â”‚
â”‚  â”‚     "Image": "C:\\Windows\\System32\\cmd.exe",                       â”‚   â”‚
â”‚  â”‚     "CommandLine": "cmd.exe /c whoami"                               â”‚   â”‚
â”‚  â”‚   }                                                                   â”‚   â”‚
â”‚  â”‚ }                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  [Run Test]                                                                  â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€ OUTPUT (Normalized) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  @timestamp:              2024-11-29T14:32:17.123Z  âœ“ Mapped         â”‚   â”‚
â”‚  â”‚  host.name:               WKS-042                   âœ“ Mapped         â”‚   â”‚
â”‚  â”‚  event.code:              1                         âœ“ Mapped         â”‚   â”‚
â”‚  â”‚  user.name:               DOMAIN\jsmith            âœ“ Mapped         â”‚   â”‚
â”‚  â”‚  process.executable:      C:\Windows\System32\cmd.exe âœ“ Mapped      â”‚   â”‚
â”‚  â”‚  process.command_line:    cmd.exe /c whoami        âœ“ Mapped         â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  âš ï¸ Unmapped source fields:                                          â”‚   â”‚
â”‚  â”‚  â€¢ EventData.ProcessGuid (no mapping defined)                        â”‚   â”‚
â”‚  â”‚  â€¢ EventData.ParentProcessGuid (no mapping defined)                  â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  [Add Mappings for Unmapped]  [Close]                                       â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Field Mapping Functional Requirements:**

| ID | Requirement | Priority |
|----|-------------|----------|
| FMAP-001 | Create, read, update, delete field mapping profiles | P0 |
| FMAP-002 | Source-to-target field mapping with dot notation support | P0 |
| FMAP-003 | Autocomplete dropdown for common SIGMA/ECS fields | P0 |
| FMAP-004 | Support custom field name entry for non-standard fields | P0 |
| FMAP-005 | Field value transformations (lowercase, uppercase, extract, split) | P1 |
| FMAP-006 | Test mapping with sample event input/output preview | P0 |
| FMAP-007 | Highlight unmapped fields from test events | P1 |
| FMAP-008 | Quick-add mappings for unmapped fields from test results | P1 |
| FMAP-009 | Import/export mapping profiles as YAML | P1 |
| FMAP-010 | Clone existing mapping profiles | P1 |
| FMAP-011 | Associate mapping profiles with listeners | P0 |
| FMAP-012 | Built-in templates for common log sources (Windows, Linux, AWS, etc.) | P2 |

**Field Mapping API Endpoints:**

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/v1/field-mappings` | GET | List all mapping profiles |
| `/api/v1/field-mappings` | POST | Create new mapping profile |
| `/api/v1/field-mappings/{id}` | GET | Get mapping profile details |
| `/api/v1/field-mappings/{id}` | PUT | Update mapping profile |
| `/api/v1/field-mappings/{id}` | DELETE | Delete mapping profile |
| `/api/v1/field-mappings/{id}/test` | POST | Test mapping with sample event |
| `/api/v1/field-mappings/import` | POST | Import mapping from YAML |
| `/api/v1/field-mappings/{id}/export` | GET | Export mapping as YAML |

#### 4.7.7 Functional Requirements

| ID | Requirement | Priority |
|----|-------------|----------|
| LIST-001 | Create listeners for all supported protocols (Syslog, CEF, JSON, Fluentd) | P0 |
| LIST-002 | Configure bind address, port, and transport (UDP/TCP/TLS) | P0 |
| LIST-003 | Start, stop, and restart listeners | P0 |
| LIST-004 | Real-time EPS (events per second) display | P0 |
| LIST-005 | Listener health status indicators (running, stopped, error) | P0 |
| LIST-006 | Field mapping configuration per listener | P0 |
| LIST-007 | SIGMA field taxonomy mapping profiles | P1 |
| LIST-008 | TLS certificate configuration for secure listeners | P1 |
| LIST-009 | View and manage Dead Letter Queue entries | P0 |
| LIST-010 | Replay failed events from DLQ after fixing issues | P0 |
| LIST-011 | Historical metrics chart (EPS over time) | P1 |
| LIST-012 | Test connection/parsing with sample event | P1 |
| LIST-013 | Clone listener configuration | P2 |
| LIST-014 | Bulk listener operations | P2 |

#### 4.7.8 API Endpoints Required

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/v1/listeners` | GET/POST | List/create listeners |
| `/api/v1/listeners/{id}` | GET/PUT/DELETE | CRUD operations |
| `/api/v1/listeners/{id}/start` | POST | Start listener |
| `/api/v1/listeners/{id}/stop` | POST | Stop listener |
| `/api/v1/listeners/{id}/status` | GET | Get health/metrics |
| `/api/v1/listeners/{id}/dlq` | GET | Get DLQ entries |
| `/api/v1/listeners/{id}/dlq/replay` | POST | Replay DLQ events |
| `/api/v1/listeners/{id}/dlq/clear` | DELETE | Clear DLQ |
| `/api/v1/listeners/{id}/test` | POST | Test with sample event |
| `/api/v1/field-mappings` | GET/POST | Manage field mappings |

#### 4.7.9 Acceptance Criteria

```gherkin
Feature: Listeners Management
  As a system administrator
  I want to configure data ingestion listeners
  So that security events can be collected from various sources

  Scenario: Create a new Syslog listener
    Given I am on the Listeners page
    When I click "New Listener"
    And I select protocol "Syslog RFC 5424"
    And I enter name "Firewall-Syslog"
    And I set port to "1514"
    And I select transport "TCP"
    And I click "Create & Start"
    Then the listener should be created and started
    And it should appear in the listeners list with "Running" status

  Scenario: View listener metrics
    Given I have a running listener receiving events
    When I click on the listener row
    Then I should see the current EPS
    And I should see a chart of EPS over the last hour
    And I should see error count if any

  Scenario: Manage Dead Letter Queue
    Given a listener has parsing errors in the DLQ
    When I click "View DLQ"
    Then I should see failed events with error details
    When I select events and click "Replay"
    Then the events should be re-processed
    And successfully parsed events should be removed from DLQ

  Scenario: Configure field mapping
    Given I am editing a listener
    When I select "Field Mapping" tab
    And I add a mapping from "src_ip" to "source.ip"
    And I save the configuration
    Then incoming events should have fields normalized
```

---

### 4.8 SOAR & Playbooks

#### 4.8.1 Overview

The SOAR (Security Orchestration, Automation, and Response) module provides playbook-based automation for incident response. It supports various action types including webhooks, email notifications, ticket creation, and host isolation with approval workflows for destructive actions.

#### 4.8.2 Wireframe

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CERBERUS > SOAR PLAYBOOKS            [ğŸ” Ctrl+K]       [ğŸ”” 12] [ğŸ‘¤ Admin â–¾] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ [NAV]  â”‚ â”‚ [+ New Playbook]  [Import]  [Export]             [Search...] â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚        â”‚ â”‚ â–ŒTOTAL   â”‚ â”‚ â–ŒACTIVE  â”‚ â”‚ â–ŒRUNS/24Hâ”‚ â”‚ â–ŒPENDING â”‚               â”‚
â”‚        â”‚ â”‚    15    â”‚ â”‚    12    â”‚ â”‚    847   â”‚ â”‚     3    â”‚               â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ PLAYBOOKS                                          [â†»] [â‹®]    â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ â—‰â”‚ NAME                    â”‚ TRIGGER     â”‚ RUNS â”‚ STATUS      â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ â—‰â”‚ Block Malicious IP      â”‚ On Alert    â”‚ 234  â”‚ Active      â”‚ â”‚
â”‚        â”‚ â”‚ â—‰â”‚ Isolate Infected Host   â”‚ Manual      â”‚ 12   â”‚ Active      â”‚ â”‚
â”‚        â”‚ â”‚ â—‰â”‚ Create JIRA Ticket      â”‚ On Alert    â”‚ 456  â”‚ Active      â”‚ â”‚
â”‚        â”‚ â”‚ â—‰â”‚ Send Slack Notification â”‚ On Alert    â”‚ 892  â”‚ Active      â”‚ â”‚
â”‚        â”‚ â”‚ â—‹â”‚ Quarantine Malware      â”‚ Manual      â”‚ 0    â”‚ Disabled    â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ PLAYBOOK BUILDER: Block Malicious IP                  [âœ•]     â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ Name: [Block Malicious IP                               ]     â”‚ â”‚
â”‚        â”‚ â”‚ Description: [Automatically block IPs from critical alerts]   â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ â”Œâ”€ TRIGGER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Type: [â— On Alert  â—‹ On Schedule  â—‹ Manual]               â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ Conditions:                                                â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   Alert Severity: [Critical â–¾]                            â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   Rule Match: [*malicious* OR *threat*              ]     â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ â”Œâ”€ WORKFLOW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                                                            â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚  â”‚ TRIGGER â”‚â”€â”€â”€â”€â”€â–¶â”‚ APPROVE â”‚â”€â”€â”€â”€â”€â–¶â”‚ BLOCK   â”‚            â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚  â”‚ Alert   â”‚      â”‚ Requiredâ”‚      â”‚   IP    â”‚            â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜            â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                                         â”‚                  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                                    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”             â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                                    â”‚ NOTIFY  â”‚             â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                                    â”‚ Slack   â”‚             â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                                                            â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚  [+ Add Step]                                              â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ [Test Playbook]  [Save Draft]  [Save & Enable]  [Cancel]      â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.8.3 Action Types

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          SOAR ACTION TYPES                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  ACTION TYPE      â”‚ REQUIRES APPROVAL â”‚ DESCRIPTION                         â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚                                                                              â”‚
â”‚  NOTIFICATION ACTIONS (No approval required)                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
â”‚  ğŸ“§ Email         â”‚ No                â”‚ Send email notification              â”‚
â”‚  ğŸ’¬ Slack/Teams   â”‚ No                â”‚ Send chat message (webhook)         â”‚
â”‚  ğŸ“‹ Create Ticket â”‚ No                â”‚ Create JIRA/ServiceNow ticket       â”‚
â”‚  ğŸ”” Webhook       â”‚ No                â”‚ Call external API                   â”‚
â”‚                                                                              â”‚
â”‚  CONTAINMENT ACTIONS (Approval required for destructive)                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
â”‚  ğŸš« Block IP      â”‚ Configurable      â”‚ Add IP to firewall blocklist        â”‚
â”‚  ğŸ”’ Isolate Host  â”‚ Yes (always)      â”‚ Network isolate endpoint            â”‚
â”‚  ğŸ—‘ï¸ Quarantine    â”‚ Yes (always)      â”‚ Quarantine file/process             â”‚
â”‚  â¹ï¸ Kill Process  â”‚ Yes (always)      â”‚ Terminate process on endpoint       â”‚
â”‚                                                                              â”‚
â”‚  ENRICHMENT ACTIONS (No approval required)                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
â”‚  ğŸ” VirusTotal    â”‚ No                â”‚ Check hash/URL reputation           â”‚
â”‚  ğŸŒ GeoIP Lookup  â”‚ No                â”‚ Get IP geolocation                  â”‚
â”‚  ğŸ‘¤ User Lookup   â”‚ No                â”‚ Get user details from directory     â”‚
â”‚  ğŸ“Š Enrich Alert  â”‚ No                â”‚ Add context data to alert           â”‚
â”‚                                                                              â”‚
â”‚  CUSTOM ACTIONS                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                          â”‚
â”‚  ğŸ“œ Custom Script â”‚ Configurable      â”‚ Execute custom remediation script   â”‚
â”‚                   â”‚                   â”‚ (Command injection protected)        â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.8.4 Approval Workflow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         APPROVAL WORKFLOW                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  For destructive actions (isolate, quarantine, kill):                       â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Playbook  â”‚â”€â”€â”€â”€â–¶â”‚  Pending  â”‚â”€â”€â”€â”€â–¶â”‚ Approved  â”‚â”€â”€â”€â”€â–¶â”‚ Executed  â”‚       â”‚
â”‚  â”‚ Triggered â”‚     â”‚ Approval  â”‚     â”‚           â”‚     â”‚           â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                          â”‚                                                   â”‚
â”‚                          â”‚ Timeout (4h)                                      â”‚
â”‚                          â”‚ or Rejected                                       â”‚
â”‚                          â–¼                                                   â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚
â”‚                    â”‚  Expired/ â”‚                                             â”‚
â”‚                    â”‚ Rejected  â”‚                                             â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â”‚                                                                              â”‚
â”‚  Approval Methods:                                                          â”‚
â”‚  â€¢ In-app notification with approve/reject buttons                          â”‚
â”‚  â€¢ Email with one-click approve/reject links                                â”‚
â”‚  â€¢ Slack/Teams interactive buttons                                          â”‚
â”‚                                                                              â”‚
â”‚  Approval Timeout: 4 hours (configurable)                                   â”‚
â”‚  Required Approvers: 1 (configurable, max 3)                                â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.8.5 Execution History

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PLAYBOOK EXECUTION HISTORY                                          [âœ•]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Playbook: Block Malicious IP                                               â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€ EXECUTIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ TIME                â”‚ TRIGGER      â”‚ STATUS   â”‚ DURATION â”‚ DETAILS  â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ 2024-11-29 14:32:17 â”‚ Alert #1247  â”‚ â— Successâ”‚ 2.3s     â”‚ [View]   â”‚   â”‚
â”‚  â”‚ 2024-11-29 14:28:45 â”‚ Alert #1245  â”‚ â— Successâ”‚ 1.8s     â”‚ [View]   â”‚   â”‚
â”‚  â”‚ 2024-11-29 14:15:02 â”‚ Alert #1242  â”‚ â—‹ Pendingâ”‚ -        â”‚ [View]   â”‚   â”‚
â”‚  â”‚ 2024-11-29 13:58:33 â”‚ Manual       â”‚ â— Successâ”‚ 3.1s     â”‚ [View]   â”‚   â”‚
â”‚  â”‚ 2024-11-29 13:45:12 â”‚ Alert #1238  â”‚ â— Failed â”‚ 0.5s     â”‚ [View]   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€ EXECUTION DETAIL: Alert #1247 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Step 1: Check IP Reputation                                          â”‚   â”‚
â”‚  â”‚  â— Completed in 0.8s                                                  â”‚   â”‚
â”‚  â”‚  Result: IP 45.33.32.156 - Malicious (score: 95/100)                 â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Step 2: Request Approval                                             â”‚   â”‚
â”‚  â”‚  â— Approved by jsmith in 45s                                          â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Step 3: Block IP on Firewall                                         â”‚   â”‚
â”‚  â”‚  â— Completed in 1.2s                                                  â”‚   â”‚
â”‚  â”‚  Result: IP added to blocklist (rule ID: FW-2847)                    â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Step 4: Send Slack Notification                                      â”‚   â”‚
â”‚  â”‚  â— Completed in 0.3s                                                  â”‚   â”‚
â”‚  â”‚  Result: Message sent to #security-alerts                            â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.8.6 Functional Requirements

| ID | Requirement | Priority |
|----|-------------|----------|
| SOAR-001 | Visual playbook builder with drag-and-drop workflow design | P0 |
| SOAR-002 | Support all action types (notification, containment, enrichment) | P0 |
| SOAR-003 | Trigger playbooks on alert creation with configurable conditions | P0 |
| SOAR-004 | Manual playbook execution from alert/investigation context | P0 |
| SOAR-005 | Approval workflow for destructive actions | P0 |
| SOAR-006 | In-app, email, and chat approval notifications | P1 |
| SOAR-007 | Playbook execution history with step-by-step details | P0 |
| SOAR-008 | Variable substitution in action parameters ({{alert.source_ip}}) | P0 |
| SOAR-009 | Conditional branching in workflows (if/then/else) | P1 |
| SOAR-010 | Playbook testing in dry-run mode | P1 |
| SOAR-011 | Import/export playbooks as JSON | P1 |
| SOAR-012 | Rate limiting for automated actions | P1 |
| SOAR-013 | Circuit breaker for failing integrations | P2 |
| SOAR-014 | Scheduled playbook execution (cron-like) | P2 |
| SOAR-015 | Action audit logging for compliance | P0 |

#### 4.8.7 Security Requirements

| ID | Requirement | Priority |
|----|-------------|----------|
| SOAR-SEC-001 | SSRF protection: Validate and allowlist webhook destinations | P0 |
| SOAR-SEC-002 | Command injection prevention: Sanitize all script parameters | P0 |
| SOAR-SEC-003 | DNS rebinding protection: Resolve hostnames at execution time | P0 |
| SOAR-SEC-004 | Credential storage: Encrypt integration credentials at rest | P0 |
| SOAR-SEC-005 | Action audit: Log all playbook executions with full context | P0 |

#### 4.8.8 API Endpoints Required

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/v1/playbooks` | GET/POST | List/create playbooks |
| `/api/v1/playbooks/{id}` | GET/PUT/DELETE | CRUD operations |
| `/api/v1/playbooks/{id}/execute` | POST | Manually execute playbook |
| `/api/v1/playbooks/{id}/executions` | GET | Get execution history |
| `/api/v1/playbooks/{id}/test` | POST | Dry-run test |
| `/api/v1/approvals` | GET | List pending approvals |
| `/api/v1/approvals/{id}` | PATCH | Approve/reject |
| `/api/v1/integrations` | GET/POST | Manage integration configs |

#### 4.8.9 Acceptance Criteria

```gherkin
Feature: SOAR Playbooks
  As a security operations analyst
  I want to automate incident response actions
  So that I can respond to threats faster and consistently

  Scenario: Create automated response playbook
    Given I am on the SOAR Playbooks page
    When I click "New Playbook"
    And I set name to "Auto-Block Malicious IP"
    And I configure trigger "On Alert" with severity "Critical"
    And I add step "Block IP" action
    And I enable approval requirement
    And I add step "Slack Notification"
    And I click "Save & Enable"
    Then the playbook should be created and active

  Scenario: Playbook executes on alert with approval
    Given I have an active playbook with approval required
    When a critical alert is generated matching the trigger
    Then the playbook should trigger
    And create a pending approval request
    And send notification to configured approvers
    When an approver clicks "Approve"
    Then the containment action should execute
    And the notification should be sent
    And execution should be logged in history

  Scenario: Manual playbook execution
    Given I am viewing a critical alert
    When I click "Run Playbook"
    And I select "Isolate Infected Host"
    And I confirm the action
    Then the playbook should execute in the alert context
    And the execution should appear in playbook history
    And the action should appear in alert timeline

  Scenario: View execution history
    Given I have playbooks with execution history
    When I view a playbook's execution history
    Then I should see all past executions
    And for each execution I can see step-by-step results
    And I can see success/failure status for each step
```

---

### 4.9 MITRE ATT&CK Coverage

#### 4.9.1 Overview

The MITRE ATT&CK Coverage module provides visualization and analysis of detection coverage mapped to the MITRE ATT&CK framework. It displays a coverage matrix, identifies gaps, and helps prioritize rule development efforts.

#### 4.9.2 Wireframe - Coverage Matrix

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CERBERUS > MITRE ATT&CK              [ğŸ” Ctrl+K]       [ğŸ”” 12] [ğŸ‘¤ Admin â–¾] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ [NAV]  â”‚ â”‚ [Coverage Matrix] [Gap Analysis] [Threat Groups] [Import/Export]â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚        â”‚ â”‚â–ŒTECHNIQUESâ”‚ â”‚â–ŒCOVERED  â”‚ â”‚â–ŒGAPS     â”‚ â”‚â–ŒRULES    â”‚               â”‚
â”‚        â”‚ â”‚   640+   â”‚ â”‚   412    â”‚ â”‚   228    â”‚ â”‚   156    â”‚               â”‚
â”‚        â”‚ â”‚          â”‚ â”‚   64%    â”‚ â”‚   36%    â”‚ â”‚          â”‚               â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ MITRE ATT&CK ENTERPRISE MATRIX                        [âš™]     â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ RECON â”‚RESOURCEâ”‚INIT   â”‚EXECUT â”‚PERSISTâ”‚PRIV   â”‚DEFENSEâ”‚CRED  â”‚ â”‚
â”‚        â”‚ â”‚       â”‚DEVELOP â”‚ACCESS â”‚       â”‚       â”‚ESCAL  â”‚EVASIONâ”‚ACCESSâ”‚ â”‚
â”‚        â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”‚ â”‚
â”‚        â”‚ â”‚ â–ˆâ–ˆâ–ˆâ–‘â–‘ â”‚ â–ˆâ–ˆâ–‘â–‘â–‘  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–‘ â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â”‚ â–ˆâ–ˆâ–ˆâ–‘â–‘ â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–‘ â”‚ â–ˆâ–ˆâ–‘â–‘â–‘ â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â”‚ â”‚
â”‚        â”‚ â”‚  72%  â”‚  45%   â”‚  68%  â”‚  89%  â”‚  56%  â”‚  78%  â”‚  34%  â”‚ 91%  â”‚ â”‚
â”‚        â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”‚ â”‚
â”‚        â”‚ â”‚ T1595 â”‚ T1583  â”‚ T1566 â”‚ T1059 â”‚ T1547 â”‚ T1548 â”‚ T1562 â”‚T1003 â”‚ â”‚
â”‚        â”‚ â”‚ â—     â”‚ â—‹      â”‚ â—     â”‚ â—     â”‚ â—     â”‚ â—     â”‚ â—‹     â”‚ â—    â”‚ â”‚
â”‚        â”‚ â”‚ T1592 â”‚ T1584  â”‚ T1190 â”‚ T1203 â”‚ T1543 â”‚ T1134 â”‚ T1070 â”‚T1555 â”‚ â”‚
â”‚        â”‚ â”‚ â—     â”‚ â—      â”‚ â—     â”‚ â—     â”‚ â—‹     â”‚ â—     â”‚ â—     â”‚ â—‹    â”‚ â”‚
â”‚        â”‚ â”‚ T1589 â”‚ T1585  â”‚ T1133 â”‚ T1047 â”‚ T1053 â”‚ T1484 â”‚ T1027 â”‚T1552 â”‚ â”‚
â”‚        â”‚ â”‚ â—‹     â”‚ â—‹      â”‚ â—     â”‚ â—‹     â”‚ â—     â”‚ â—‹     â”‚ â—‹     â”‚ â—    â”‚ â”‚
â”‚        â”‚ â”‚ ...   â”‚ ...    â”‚ ...   â”‚ ...   â”‚ ...   â”‚ ...   â”‚ ...   â”‚ ...  â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ Legend: â— Covered  â— Partial  â—‹ Not Covered                   â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ TECHNIQUE DETAILS: T1059 - Command and Scripting Interpreter  â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚ Tactic: Execution                    Coverage: â— Full (5 rules)â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ Sub-techniques:                                                â”‚ â”‚
â”‚        â”‚ â”‚ â”œâ”€ T1059.001 PowerShell           â— 3 rules                   â”‚ â”‚
â”‚        â”‚ â”‚ â”œâ”€ T1059.003 Windows Command Shell â— 2 rules                   â”‚ â”‚
â”‚        â”‚ â”‚ â”œâ”€ T1059.005 Visual Basic         â— 1 rule (low confidence)   â”‚ â”‚
â”‚        â”‚ â”‚ â””â”€ T1059.007 JavaScript           â—‹ No coverage               â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ Linked Rules:                                                  â”‚ â”‚
â”‚        â”‚ â”‚ â€¢ Suspicious PowerShell Execution (Critical)                   â”‚ â”‚
â”‚        â”‚ â”‚ â€¢ Encoded PowerShell Command (High)                           â”‚ â”‚
â”‚        â”‚ â”‚ â€¢ CMD Spawned by Office Application (High)                    â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ [View Rules] [Create Rule] [Export to Navigator]              â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.9.3 Gap Analysis View

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GAP ANALYSIS                                                         [âœ•]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Filter by: Tactic [All â–¾]  Priority [All â–¾]  Threat Group [All â–¾]         â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€ PRIORITIZED GAPS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ PRIORITY â”‚ TECHNIQUE            â”‚ TACTIC      â”‚ THREAT GROUPS â”‚ ACT  â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ â—â—â— HIGH â”‚ T1562 Impair Defense â”‚ Def Evasion â”‚ APT29, APT28  â”‚[+Rule]â”‚  â”‚
â”‚  â”‚ â—â—â— HIGH â”‚ T1027 Obfuscated Filesâ”‚ Def Evasion â”‚ Lazarus       â”‚[+Rule]â”‚  â”‚
â”‚  â”‚ â—â—â—‹ MED  â”‚ T1583 Acquire Infra  â”‚ Resource Devâ”‚ APT41         â”‚[+Rule]â”‚  â”‚
â”‚  â”‚ â—â—â—‹ MED  â”‚ T1585 Establish Acctsâ”‚ Resource Devâ”‚ FIN7          â”‚[+Rule]â”‚  â”‚
â”‚  â”‚ â—â—‹â—‹ LOW  â”‚ T1589 Gather Info    â”‚ Recon       â”‚ -             â”‚[+Rule]â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  Gap Prioritization Factors:                                                â”‚
â”‚  â€¢ Techniques used by threat groups targeting your industry                 â”‚
â”‚  â€¢ Techniques with high prevalence in recent campaigns                      â”‚
â”‚  â€¢ Techniques in your log sources that lack detection                       â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€ GAP DETAIL: T1562 Impair Defenses â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Description: Adversaries may disable security tools to avoid         â”‚   â”‚
â”‚  â”‚  detection of their activities.                                       â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Sub-techniques without coverage:                                     â”‚   â”‚
â”‚  â”‚  â€¢ T1562.001 - Disable or Modify Tools                               â”‚   â”‚
â”‚  â”‚  â€¢ T1562.002 - Disable Windows Event Logging                         â”‚   â”‚
â”‚  â”‚  â€¢ T1562.004 - Disable or Modify System Firewall                     â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Recommended Data Sources:                                            â”‚   â”‚
â”‚  â”‚  â€¢ Windows Security Event Logs (4688, 4689)                          â”‚   â”‚
â”‚  â”‚  â€¢ Sysmon (Event ID 1, 13)                                           â”‚   â”‚
â”‚  â”‚  â€¢ EDR Process Telemetry                                              â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  [Create Rule from Template] [View MITRE Page] [Mark as Accepted Risk]â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.9.4 Functional Requirements

| ID | Requirement | Priority |
|----|-------------|----------|
| MITRE-001 | Display interactive MITRE ATT&CK Enterprise matrix with coverage heatmap | P0 |
| MITRE-002 | Color-code techniques by coverage level (full, partial, none) | P0 |
| MITRE-003 | Click technique to view details, linked rules, and sub-techniques | P0 |
| MITRE-004 | Filter matrix by tactic, platform, or data source | P1 |
| MITRE-005 | Gap analysis with prioritized recommendations | P0 |
| MITRE-006 | Link rules to MITRE techniques during rule creation | P0 |
| MITRE-007 | Import STIX 2.1 bundles for ATT&CK updates | P1 |
| MITRE-008 | Export coverage to ATT&CK Navigator JSON format | P1 |
| MITRE-009 | Threat group mapping (which groups use which techniques) | P1 |
| MITRE-010 | Coverage trending over time | P2 |
| MITRE-011 | Sub-technique level coverage tracking | P1 |
| MITRE-012 | Quick-create rule from gap analysis | P1 |

#### 4.9.5 API Endpoints Required

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/v1/mitre/techniques` | GET | List all techniques with coverage |
| `/api/v1/mitre/tactics` | GET | List tactics with coverage summary |
| `/api/v1/mitre/coverage` | GET | Get full coverage matrix data |
| `/api/v1/mitre/gaps` | GET | Get prioritized gap analysis |
| `/api/v1/mitre/techniques/{id}/rules` | GET | Get rules linked to technique |
| `/api/v1/mitre/threat-groups` | GET | List threat groups |
| `/api/v1/mitre/import` | POST | Import STIX bundle |
| `/api/v1/mitre/export/navigator` | GET | Export Navigator layer |

#### 4.9.6 Acceptance Criteria

```gherkin
Feature: MITRE ATT&CK Coverage
  As a detection engineer
  I want to visualize my ATT&CK coverage
  So that I can identify and prioritize detection gaps

  Scenario: View coverage matrix
    Given I am on the MITRE ATT&CK page
    Then I should see the enterprise matrix with all tactics
    And each technique should show coverage status (covered/partial/none)
    And I should see overall coverage percentage KPIs

  Scenario: View technique details
    Given I am viewing the coverage matrix
    When I click on technique T1059
    Then I should see technique description
    And I should see all sub-techniques with their coverage
    And I should see linked detection rules
    And I should be able to create a new rule for this technique

  Scenario: Analyze gaps
    Given I navigate to Gap Analysis
    Then I should see uncovered techniques prioritized by risk
    And high-priority gaps should show threat group usage
    And I should be able to create a rule directly from a gap

  Scenario: Export to Navigator
    Given I have coverage data
    When I click "Export to Navigator"
    Then a JSON file should download
    And the file should be compatible with ATT&CK Navigator
```

---

### 4.10 Settings & Configuration

#### 4.10.1 Overview

The Settings module provides centralized configuration for all Cerberus Console features including system preferences, user preferences, integrations, retention policies, and backup/restore functionality.

#### 4.10.2 Wireframe

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CERBERUS > SETTINGS                  [ğŸ” Ctrl+K]       [ğŸ”” 12] [ğŸ‘¤ Admin â–¾] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        â”‚                                                                    â”‚
â”‚ [NAV]  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚ â”‚ SETTINGS                                                       â”‚ â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â”‚ â”Œâ”€ CATEGORIES â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€ GENERAL SETTINGS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                    â”‚ â”‚                                     â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â–¸ General          â”‚ â”‚ Application                         â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   User Preferences â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€               â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   Notifications    â”‚ â”‚ Application Name:                   â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                    â”‚ â”‚ [Cerberus Console              ]    â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â–¸ Security         â”‚ â”‚                                     â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   Authentication   â”‚ â”‚ Base URL:                           â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   Sessions         â”‚ â”‚ [http://localhost:8080         ]    â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   Password Policy  â”‚ â”‚                                     â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                    â”‚ â”‚ Time Zone:                          â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â–¸ Data             â”‚ â”‚ [UTC                          â–¾]    â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   Retention        â”‚ â”‚                                     â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   Backup/Restore   â”‚ â”‚ Date Format:                        â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                    â”‚ â”‚ [YYYY-MM-DD HH:mm:ss           â–¾]    â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â–¸ Integrations     â”‚ â”‚                                     â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   Email (SMTP)     â”‚ â”‚ Dashboard Settings                  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   Slack            â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€               â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   JIRA             â”‚ â”‚ Auto-refresh interval:              â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   Webhooks         â”‚ â”‚ [30        ] seconds                â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                    â”‚ â”‚                                     â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚ â–¸ Advanced         â”‚ â”‚ Default page size:                  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   API Settings     â”‚ â”‚ [â—‹ 25  â— 50  â—‹ 100]                â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   Performance      â”‚ â”‚                                     â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚   Debug            â”‚ â”‚ Enable animations:                  â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                    â”‚ â”‚ [â— Enabled  â—‹ Disabled]             â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â”‚                    â”‚ â”‚                                     â”‚ â”‚ â”‚
â”‚        â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ [Save Changes]  [Reset to Defaults] â”‚ â”‚ â”‚
â”‚        â”‚ â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚        â”‚ â”‚                                                                â”‚ â”‚
â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.10.3 Settings Categories

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          SETTINGS CATEGORIES                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  GENERAL                                                                     â”‚
â”‚  â”œâ”€ User Preferences: Theme, timezone, date format, language                â”‚
â”‚  â”œâ”€ Notifications: Alert thresholds, email preferences, sounds              â”‚
â”‚  â””â”€ Dashboard: Refresh rate, default time range, widget layout              â”‚
â”‚                                                                              â”‚
â”‚  SECURITY                                                                    â”‚
â”‚  â”œâ”€ Authentication: Session timeout, MFA settings, SSO configuration        â”‚
â”‚  â”œâ”€ Password Policy: Complexity, expiration, history                        â”‚
â”‚  â”œâ”€ API Keys: Manage API keys for integrations                              â”‚
â”‚  â””â”€ Audit Log: View security audit events                                   â”‚
â”‚                                                                              â”‚
â”‚  DATA                                                                        â”‚
â”‚  â”œâ”€ Retention: Event retention period, alert archival                       â”‚
â”‚  â”œâ”€ Backup: Manual backup, scheduled backups, restore points                â”‚
â”‚  â””â”€ Storage: View storage usage, configure limits                           â”‚
â”‚                                                                              â”‚
â”‚  INTEGRATIONS                                                                â”‚
â”‚  â”œâ”€ Email (SMTP): Configure email server for notifications                  â”‚
â”‚  â”œâ”€ Slack/Teams: Webhook configuration for chat notifications               â”‚
â”‚  â”œâ”€ Ticketing: JIRA, ServiceNow integration settings                        â”‚
â”‚  â”œâ”€ Threat Intel: VirusTotal, MISP, OTX API keys                           â”‚
â”‚  â””â”€ EDR/Firewall: Integration for containment actions                       â”‚
â”‚                                                                              â”‚
â”‚  SOAR                                                                        â”‚
â”‚  â”œâ”€ Approval Timeouts: Default approval wait times and escalation           â”‚
â”‚  â”œâ”€ Action Limits: Maximum concurrent actions, rate limits                  â”‚
â”‚  â””â”€ Notifications: Approval request notification channels                   â”‚
â”‚                                                                              â”‚
â”‚  ADVANCED                                                                    â”‚
â”‚  â”œâ”€ API: Rate limits, CORS settings, webhook retry policy                  â”‚
â”‚  â”œâ”€ Performance: Query timeouts, connection pools                           â”‚
â”‚  â””â”€ Debug: Log levels, diagnostic endpoints                                 â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.10.4 Retention Configuration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DATA RETENTION SETTINGS                                             [âœ•]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  âš ï¸  Changes to retention settings will take effect at next cleanup cycle   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€ RETENTION POLICIES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Events (Raw Logs)                                                    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚ Retention Period: [90    ] days                              â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ Current Storage:  847 GB                                     â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ Est. after policy: 623 GB                                    â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Alerts                                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚ Retention Period: [365   ] days                              â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ Archive after:    [90    ] days (move to cold storage)       â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ Current Count:    124,847 alerts                             â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Investigations                                                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚ Retention Period: [730   ] days (2 years)                    â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ Include evidence files: [â— Yes  â—‹ No]                        â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Audit Logs                                                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚ Retention Period: [365   ] days (compliance requirement)     â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ Cannot be reduced below 365 days                             â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  [Save Retention Settings]  [Run Cleanup Now]                               â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.10.5 SOAR Configuration Settings

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SOAR SETTINGS                                                         [âœ•]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€ APPROVAL TIMEOUT CONFIGURATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Default Approval Timeout                                             â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ Timeout Duration: [30   ] [minutes â–¾]                            â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                                                                   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ On Timeout Action:                                                â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ [â— Auto-deny and log  â—‹ Auto-approve  â—‹ Escalate]                â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                                                                   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ âš ï¸  Auto-approve is not recommended for containment actions      â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Severity-Based Timeouts                                              â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ [âœ“] Enable severity-based timeout overrides                      â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                                                                   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ SEVERITY    â”‚ TIMEOUT     â”‚ ON TIMEOUT                           â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Critical    â”‚ [5    ] min â”‚ [Escalate immediately   â–¾]           â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ High        â”‚ [15   ] min â”‚ [Escalate to manager    â–¾]           â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Medium      â”‚ [30   ] min â”‚ [Auto-deny              â–¾]           â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Low         â”‚ [60   ] min â”‚ [Auto-deny              â–¾]           â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Info        â”‚ [120  ] min â”‚ [Auto-approve           â–¾]           â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Escalation Configuration                                             â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ Primary Escalation:                                               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ [â— User's Manager  â—‹ Specific User  â—‹ Role: [SOC Lead      â–¾]]  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                                                                   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Secondary Escalation (if primary doesn't respond):               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ After: [15   ] minutes                                            â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Escalate to: [Role: Security Manager â–¾]                          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                                                                   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ [âœ“] Send escalation notifications via email                      â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ [âœ“] Send escalation notifications via Slack                      â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€ ACTION LIMITS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Concurrency Limits                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ Max concurrent playbook executions: [10   ]                      â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Max concurrent actions per playbook: [5    ]                     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Max pending approval requests: [50   ]                           â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Rate Limits (per action type)                                        â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ ACTION TYPE       â”‚ MAX PER HOUR â”‚ MAX PER DAY â”‚ COOLDOWN       â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Host Isolation    â”‚ [10   ]      â”‚ [50   ]     â”‚ [5   ] min     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Account Disable   â”‚ [20   ]      â”‚ [100  ]     â”‚ [2   ] min     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Block IP/Domain   â”‚ [100  ]      â”‚ [500  ]     â”‚ [0   ] min     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Send Notification â”‚ [200  ]      â”‚ [1000 ]     â”‚ [0   ] min     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Create Ticket     â”‚ [50   ]      â”‚ [200  ]     â”‚ [1   ] min     â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€ APPROVAL NOTIFICATIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Notification Channels for Approval Requests                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ [âœ“] Email: Notify assigned approvers via email                   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ [âœ“] Slack: Post to #security-approvals channel                   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ [âœ“] In-App: Show desktop notification and badge                  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ [ ] SMS: Send SMS to approvers (requires Twilio config)          â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Reminder Configuration                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ [âœ“] Send reminders for pending approvals                         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ First reminder after: [10   ] minutes                            â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Repeat every: [10   ] minutes until timeout                      â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Max reminders: [3    ]                                           â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  [Save SOAR Settings]  [Reset to Defaults]                                  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**SOAR Settings Functional Requirements:**

| ID | Requirement | Priority |
|----|-------------|----------|
| SOAR-SET-001 | Configure default approval timeout duration | P0 |
| SOAR-SET-002 | Configure timeout action (auto-deny, auto-approve, escalate) | P0 |
| SOAR-SET-003 | Severity-based timeout overrides | P1 |
| SOAR-SET-004 | Escalation chain configuration (primary, secondary) | P1 |
| SOAR-SET-005 | Escalation notification channel selection | P1 |
| SOAR-SET-006 | Maximum concurrent playbook execution limits | P0 |
| SOAR-SET-007 | Per-action-type rate limits (per hour, per day) | P1 |
| SOAR-SET-008 | Action cooldown periods to prevent rapid re-execution | P1 |
| SOAR-SET-009 | Approval notification channel configuration | P0 |
| SOAR-SET-010 | Approval reminder configuration | P1 |
| SOAR-SET-011 | Warning for risky settings (auto-approve containment) | P0 |

#### 4.10.6 Functional Requirements

| ID | Requirement | Priority |
|----|-------------|----------|
| SET-001 | Categorized settings navigation (General, Security, Data, Integrations) | P0 |
| SET-002 | User preferences (theme, timezone, date format) | P0 |
| SET-003 | Notification preferences (which alerts trigger notifications) | P1 |
| SET-004 | Data retention policy configuration per data type | P0 |
| SET-005 | Manual backup creation with download option | P0 |
| SET-006 | Restore from backup file | P0 |
| SET-007 | Scheduled backup configuration | P1 |
| SET-008 | SMTP email configuration with test function | P0 |
| SET-009 | Slack/Teams webhook configuration with test | P1 |
| SET-010 | Ticketing system integration (JIRA, ServiceNow) | P1 |
| SET-011 | Threat intelligence API key management | P1 |
| SET-012 | API rate limit configuration | P2 |
| SET-013 | Storage usage dashboard | P1 |
| SET-014 | Audit log viewer | P0 |

#### 4.10.7 API Endpoints Required

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/v1/settings` | GET/PUT | Get/update all settings |
| `/api/v1/settings/{category}` | GET/PUT | Get/update category settings |
| `/api/v1/settings/retention` | GET/PUT | Retention policy settings |
| `/api/v1/backup` | POST | Create manual backup |
| `/api/v1/backup/restore` | POST | Restore from backup |
| `/api/v1/backup/scheduled` | GET/PUT | Scheduled backup config |
| `/api/v1/integrations/{type}/test` | POST | Test integration |
| `/api/v1/audit-log` | GET | Get audit log entries |

---

### 4.11 Authentication & Authorization

#### 4.11.1 Overview

The Authentication module provides secure user authentication with JWT tokens, session management, and role-based access control (RBAC). It supports local authentication with optional MFA.

#### 4.11.2 Login Wireframe

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚                                                                             â”‚
â”‚                    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—                    â”‚
â”‚                    â•‘                                   â•‘                    â”‚
â”‚                    â•‘         â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„           â•‘                    â”‚
â”‚                    â•‘        â–ˆâ–ˆ CERBERUS â–ˆâ–ˆ            â•‘                    â”‚
â”‚                    â•‘         â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€           â•‘                    â”‚
â”‚                    â•‘                                   â•‘                    â”‚
â”‚                    â•‘   Security Information and       â•‘                    â”‚
â”‚                    â•‘   Event Management System        â•‘                    â”‚
â”‚                    â•‘                                   â•‘                    â”‚
â”‚                    â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£                    â”‚
â”‚                    â•‘                                   â•‘                    â”‚
â”‚                    â•‘   Username                        â•‘                    â”‚
â”‚                    â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘                    â”‚
â”‚                    â•‘   â”‚ admin@example.com           â”‚ â•‘                    â”‚
â”‚                    â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘                    â”‚
â”‚                    â•‘                                   â•‘                    â”‚
â”‚                    â•‘   Password                        â•‘                    â”‚
â”‚                    â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘                    â”‚
â”‚                    â•‘   â”‚ â—â—â—â—â—â—â—â—â—â—â—â—               â”‚ â•‘                    â”‚
â”‚                    â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘                    â”‚
â”‚                    â•‘                                   â•‘                    â”‚
â”‚                    â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘                    â”‚
â”‚                    â•‘   â”‚         SIGN IN             â”‚ â•‘                    â”‚
â”‚                    â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘                    â”‚
â”‚                    â•‘                                   â•‘                    â”‚
â”‚                    â•‘   â–¡ Remember this device         â•‘                    â”‚
â”‚                    â•‘                                   â•‘                    â”‚
â”‚                    â•‘   Forgot password?               â•‘                    â”‚
â”‚                    â•‘                                   â•‘                    â”‚
â”‚                    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                    â”‚
â”‚                                                                             â”‚
â”‚                           v1.0.0 | Status: â— Online                         â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.11.3 User Management

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CERBERUS > SETTINGS > USER MANAGEMENT                              [Admin] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ [+ New User]  [Import Users]                           [Search...]    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ USERS                                                      [â†»] [â‹®]    â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ USER               â”‚ EMAIL              â”‚ ROLE    â”‚ STATUS â”‚ ACTIONS  â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ John Smith         â”‚ jsmith@example.com â”‚ Admin   â”‚ Active â”‚ [Edit]   â”‚ â”‚
â”‚  â”‚ Alice Lee          â”‚ alee@example.com   â”‚ Analyst â”‚ Active â”‚ [Edit]   â”‚ â”‚
â”‚  â”‚ Bob Johnson        â”‚ bjohnson@ex.com    â”‚ Analyst â”‚ Active â”‚ [Edit]   â”‚ â”‚
â”‚  â”‚ Carol White        â”‚ cwhite@example.com â”‚ Viewer  â”‚ Locked â”‚ [Edit]   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€ ROLES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  ROLE       â”‚ DESCRIPTION                    â”‚ USERS â”‚ PERMISSIONS    â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚
â”‚  â”‚  Admin      â”‚ Full system access             â”‚ 1     â”‚ All            â”‚ â”‚
â”‚  â”‚  Analyst    â”‚ Alert triage, investigations   â”‚ 5     â”‚ Read/Write     â”‚ â”‚
â”‚  â”‚  Engineer   â”‚ Rule creation, SOAR config     â”‚ 2     â”‚ Config access  â”‚ â”‚
â”‚  â”‚  Viewer     â”‚ Read-only dashboard access     â”‚ 3     â”‚ Read only      â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  [+ Create Role]  [Edit Permissions]                                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.11.4 RBAC Permission Matrix

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ROLE-BASED ACCESS CONTROL                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  PERMISSION          â”‚ ADMIN â”‚ ENGINEER â”‚ ANALYST â”‚ VIEWER                  â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚                                                                              â”‚
â”‚  DASHBOARD                                                                   â”‚
â”‚  â”œâ”€ View               â”‚  âœ“   â”‚    âœ“    â”‚    âœ“    â”‚   âœ“                    â”‚
â”‚  â””â”€ Customize          â”‚  âœ“   â”‚    âœ“    â”‚    âœ“    â”‚   â”€                    â”‚
â”‚                                                                              â”‚
â”‚  ALERTS                                                                      â”‚
â”‚  â”œâ”€ View               â”‚  âœ“   â”‚    âœ“    â”‚    âœ“    â”‚   âœ“                    â”‚
â”‚  â”œâ”€ Triage             â”‚  âœ“   â”‚    âœ“    â”‚    âœ“    â”‚   â”€                    â”‚
â”‚  â””â”€ Execute Actions    â”‚  âœ“   â”‚    âœ“    â”‚    âœ“    â”‚   â”€                    â”‚
â”‚                                                                              â”‚
â”‚  RULES                                                                       â”‚
â”‚  â”œâ”€ View               â”‚  âœ“   â”‚    âœ“    â”‚    âœ“    â”‚   âœ“                    â”‚
â”‚  â”œâ”€ Create/Edit        â”‚  âœ“   â”‚    âœ“    â”‚    â”€    â”‚   â”€                    â”‚
â”‚  â””â”€ Delete             â”‚  âœ“   â”‚    âœ“    â”‚    â”€    â”‚   â”€                    â”‚
â”‚                                                                              â”‚
â”‚  INVESTIGATIONS                                                              â”‚
â”‚  â”œâ”€ View               â”‚  âœ“   â”‚    âœ“    â”‚    âœ“    â”‚   âœ“                    â”‚
â”‚  â”œâ”€ Create/Edit        â”‚  âœ“   â”‚    âœ“    â”‚    âœ“    â”‚   â”€                    â”‚
â”‚  â””â”€ Close              â”‚  âœ“   â”‚    âœ“    â”‚    âœ“    â”‚   â”€                    â”‚
â”‚                                                                              â”‚
â”‚  SOAR                                                                        â”‚
â”‚  â”œâ”€ View Playbooks     â”‚  âœ“   â”‚    âœ“    â”‚    âœ“    â”‚   âœ“                    â”‚
â”‚  â”œâ”€ Create/Edit        â”‚  âœ“   â”‚    âœ“    â”‚    â”€    â”‚   â”€                    â”‚
â”‚  â”œâ”€ Execute (Manual)   â”‚  âœ“   â”‚    âœ“    â”‚    âœ“    â”‚   â”€                    â”‚
â”‚  â””â”€ Approve Actions    â”‚  âœ“   â”‚    âœ“    â”‚    â”€    â”‚   â”€                    â”‚
â”‚                                                                              â”‚
â”‚  SETTINGS                                                                    â”‚
â”‚  â”œâ”€ View               â”‚  âœ“   â”‚    âœ“    â”‚    â”€    â”‚   â”€                    â”‚
â”‚  â”œâ”€ Modify             â”‚  âœ“   â”‚    â”€    â”‚    â”€    â”‚   â”€                    â”‚
â”‚  â””â”€ User Management    â”‚  âœ“   â”‚    â”€    â”‚    â”€    â”‚   â”€                    â”‚
â”‚                                                                              â”‚
â”‚  Legend: âœ“ = Allowed, â”€ = Denied                                           â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.11.5 Functional Requirements

| ID | Requirement | Priority |
|----|-------------|----------|
| AUTH-001 | Username/password authentication with JWT tokens | P0 |
| AUTH-002 | JWT stored in httpOnly cookie (not localStorage) | P0 |
| AUTH-003 | CSRF protection with double-submit cookie pattern | P0 |
| AUTH-004 | Session timeout with configurable duration (default: 8 hours) | P0 |
| AUTH-005 | Remember device option (extends session to 30 days) | P1 |
| AUTH-006 | Password policy enforcement (complexity, history, expiration) | P0 |
| AUTH-007 | Account lockout after failed attempts (default: 5) | P0 |
| AUTH-008 | User CRUD operations (create, read, update, delete) | P0 |
| AUTH-009 | Role management with customizable permissions | P0 |
| AUTH-010 | MFA support via TOTP (Google Authenticator compatible) | P1 |
| AUTH-011 | Password reset via email | P1 |
| AUTH-012 | Login audit logging (success, failure, IP address) | P0 |
| AUTH-013 | Active session management (view/revoke sessions) | P1 |
| AUTH-014 | XSS protection (sanitize all user inputs) | P0 |

#### 4.11.6 API Endpoints Required

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/v1/auth/login` | POST | Authenticate user |
| `/api/v1/auth/logout` | POST | End session |
| `/api/v1/auth/refresh` | POST | Refresh JWT token |
| `/api/v1/auth/me` | GET | Get current user info |
| `/api/v1/auth/password` | PUT | Change password |
| `/api/v1/auth/mfa/setup` | POST | Setup MFA |
| `/api/v1/auth/mfa/verify` | POST | Verify MFA code |
| `/api/v1/users` | GET/POST | List/create users |
| `/api/v1/users/{id}` | GET/PUT/DELETE | User CRUD |
| `/api/v1/roles` | GET/POST | List/create roles |
| `/api/v1/roles/{id}/permissions` | PUT | Update role permissions |

#### 4.11.7 Acceptance Criteria

```gherkin
Feature: Authentication
  As a user
  I want to securely authenticate to the system
  So that I can access features according to my role

  Scenario: Successful login
    Given I am on the login page
    When I enter valid username "analyst@example.com"
    And I enter valid password
    And I click "Sign In"
    Then I should be redirected to the Dashboard
    And I should see my username in the header
    And a JWT should be stored in an httpOnly cookie

  Scenario: Failed login with lockout
    Given I am on the login page
    When I enter invalid credentials 5 times
    Then my account should be locked
    And I should see message "Account locked. Contact administrator."

  Scenario: Role-based access control
    Given I am logged in as an Analyst
    When I try to access the Settings page
    Then I should see a "Permission Denied" message
    And I should not see the Settings menu item

  Scenario: Session timeout
    Given I am logged in
    When I am inactive for 8 hours
    Then my session should expire
    And I should be redirected to the login page
    And I should see message "Session expired. Please log in again."

  Scenario: MFA authentication
    Given I have MFA enabled on my account
    When I enter valid username and password
    Then I should see the MFA verification screen
    When I enter a valid TOTP code
    Then I should be logged in successfully
```

---

## 5. Technical Specifications

### 5.1 Electron Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ELECTRON PROCESS ARCHITECTURE                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                         MAIN PROCESS                                 â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚  â”‚  â”‚   App       â”‚  â”‚   Menu      â”‚  â”‚   Tray      â”‚  â”‚  Shortcuts  â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  Lifecycle  â”‚  â”‚  Manager    â”‚  â”‚   Icon      â”‚  â”‚   Handler   â”‚ â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚    â”‚
â”‚  â”‚  â”‚Auto-Updater â”‚  â”‚   Native    â”‚  â”‚   IPC       â”‚                  â”‚    â”‚
â”‚  â”‚  â”‚             â”‚  â”‚   Dialogs   â”‚  â”‚   Bridge    â”‚                  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                    â”‚                                         â”‚
â”‚                              IPC Channel                                     â”‚
â”‚                                    â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                       RENDERER PROCESS                               â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚                    REACT APPLICATION                         â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  Router  â”‚  â”‚  Zustand â”‚  â”‚   React  â”‚  â”‚  Tanstackâ”‚     â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚          â”‚  â”‚   Store  â”‚  â”‚   Query  â”‚  â”‚   Table  â”‚     â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ WebSocketâ”‚  â”‚   Axios  â”‚  â”‚  Monaco  â”‚                   â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  Client  â”‚  â”‚   HTTP   â”‚  â”‚  Editor  â”‚                   â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Directory Structure

```
cerberus-console/
â”œâ”€â”€ electron/
â”‚   â”œâ”€â”€ main.ts                 # Main process entry
â”‚   â”œâ”€â”€ preload.ts              # Preload script (context bridge)
â”‚   â”œâ”€â”€ ipc/                    # IPC handlers
â”‚   â”‚   â”œâ”€â”€ handlers.ts
â”‚   â”‚   â””â”€â”€ channels.ts
â”‚   â”œâ”€â”€ menu.ts                 # Application menu
â”‚   â”œâ”€â”€ tray.ts                 # System tray
â”‚   â””â”€â”€ updater.ts              # Auto-update logic
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.tsx                # React entry point
â”‚   â”œâ”€â”€ App.tsx                 # Root component
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ common/             # Reusable UI components
â”‚   â”‚   â”‚   â”œâ”€â”€ Button/
â”‚   â”‚   â”‚   â”œâ”€â”€ Card/
â”‚   â”‚   â”‚   â”œâ”€â”€ Table/
â”‚   â”‚   â”‚   â”œâ”€â”€ Modal/
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ layout/             # Layout components
â”‚   â”‚   â”‚   â”œâ”€â”€ Sidebar/
â”‚   â”‚   â”‚   â”œâ”€â”€ TopBar/
â”‚   â”‚   â”‚   â””â”€â”€ MainContent/
â”‚   â”‚   â””â”€â”€ features/           # Feature-specific components
â”‚   â”‚       â”œâ”€â”€ Dashboard/
â”‚   â”‚       â”œâ”€â”€ Alerts/
â”‚   â”‚       â”œâ”€â”€ Rules/
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”œâ”€â”€ pages/                  # Route pages
â”‚   â”‚   â”œâ”€â”€ Dashboard/
â”‚   â”‚   â”œâ”€â”€ Alerts/
â”‚   â”‚   â”œâ”€â”€ Hunt/
â”‚   â”‚   â”œâ”€â”€ Rules/
â”‚   â”‚   â”œâ”€â”€ Correlations/
â”‚   â”‚   â”œâ”€â”€ Investigations/
â”‚   â”‚   â”œâ”€â”€ Listeners/
â”‚   â”‚   â”œâ”€â”€ Playbooks/
â”‚   â”‚   â”œâ”€â”€ MITRE/
â”‚   â”‚   â”œâ”€â”€ Settings/
â”‚   â”‚   â””â”€â”€ Login/
â”‚   â”œâ”€â”€ hooks/                  # Custom React hooks
â”‚   â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”‚   â”œâ”€â”€ useWebSocket.ts
â”‚   â”‚   â”œâ”€â”€ useAlerts.ts
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ stores/                 # Zustand stores
â”‚   â”‚   â”œâ”€â”€ authStore.ts
â”‚   â”‚   â”œâ”€â”€ alertStore.ts
â”‚   â”‚   â”œâ”€â”€ settingsStore.ts
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ services/               # API services
â”‚   â”‚   â”œâ”€â”€ api.ts              # Axios instance
â”‚   â”‚   â”œâ”€â”€ alertService.ts
â”‚   â”‚   â”œâ”€â”€ ruleService.ts
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ types/                  # TypeScript types
â”‚   â”‚   â”œâ”€â”€ alert.ts
â”‚   â”‚   â”œâ”€â”€ rule.ts
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ utils/                  # Utility functions
â”‚   â”‚   â”œâ”€â”€ formatters.ts
â”‚   â”‚   â”œâ”€â”€ validators.ts
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ styles/                 # Global styles
â”‚       â”œâ”€â”€ globals.css
â”‚       â””â”€â”€ theme.ts
â”œâ”€â”€ public/                     # Static assets
â”œâ”€â”€ tests/                      # Test files
â”‚   â”œâ”€â”€ unit/
â”‚   â”œâ”€â”€ integration/
â”‚   â””â”€â”€ e2e/
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ vite.config.ts
â”œâ”€â”€ electron-builder.json
â””â”€â”€ README.md
```

### 5.3 State Management Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         STATE MANAGEMENT                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  ZUSTAND STORES (Client State)                                              â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  authStore  â”‚  â”‚   uiStore   â”‚  â”‚ alertStore  â”‚  â”‚settingsStoreâ”‚        â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚  â”‚ user        â”‚  â”‚ sidebarOpen â”‚  â”‚ selectedIds â”‚  â”‚ theme       â”‚        â”‚
â”‚  â”‚ token       â”‚  â”‚ commandOpen â”‚  â”‚ filters     â”‚  â”‚ timezone    â”‚        â”‚
â”‚  â”‚ permissions â”‚  â”‚ activeModal â”‚  â”‚ sortOrder   â”‚  â”‚ preferences â”‚        â”‚
â”‚  â”‚ isLoading   â”‚  â”‚ toasts      â”‚  â”‚             â”‚  â”‚             â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                              â”‚
â”‚  REACT QUERY (Server State)                                                 â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Query Keys:                                                         â”‚    â”‚
â”‚  â”‚  â€¢ ['alerts', filters]      â†’ Paginated alert list                  â”‚    â”‚
â”‚  â”‚  â€¢ ['alerts', id]           â†’ Single alert detail                   â”‚    â”‚
â”‚  â”‚  â€¢ ['rules']                â†’ All rules                              â”‚    â”‚
â”‚  â”‚  â€¢ ['dashboard', 'stats']   â†’ Dashboard KPIs                        â”‚    â”‚
â”‚  â”‚  â€¢ ['mitre', 'coverage']    â†’ MITRE coverage matrix                 â”‚    â”‚
â”‚  â”‚                                                                       â”‚    â”‚
â”‚  â”‚  Features Used:                                                       â”‚    â”‚
â”‚  â”‚  â€¢ Automatic background refetch                                      â”‚    â”‚
â”‚  â”‚  â€¢ Optimistic updates for mutations                                  â”‚    â”‚
â”‚  â”‚  â€¢ Infinite scroll pagination                                        â”‚    â”‚
â”‚  â”‚  â€¢ Cache invalidation on mutations                                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  WEBSOCKET STATE                                                            â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Real-time events pushed to React Query cache:                       â”‚    â”‚
â”‚  â”‚  â€¢ New alerts â†’ invalidate ['alerts']                               â”‚    â”‚
â”‚  â”‚  â€¢ Alert updates â†’ update ['alerts', id]                            â”‚    â”‚
â”‚  â”‚  â€¢ Stats updates â†’ update ['dashboard', 'stats']                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.4 API Integration

```typescript
// services/api.ts - Axios Configuration
import axios from 'axios';

const api = axios.create({
  baseURL: import.meta.env.VITE_API_URL || 'http://localhost:8080/api/v1',
  withCredentials: true, // Send cookies for JWT
  timeout: 30000,
});

// Request interceptor - Add CSRF token
api.interceptors.request.use((config) => {
  const csrfToken = getCookie('csrf_token');
  if (csrfToken) {
    config.headers['X-CSRF-Token'] = csrfToken;
  }
  return config;
});

// Response interceptor - Handle auth errors
api.interceptors.response.use(
  (response) => response,
  async (error) => {
    if (error.response?.status === 401) {
      // Redirect to login
      window.location.href = '/login';
    }
    return Promise.reject(error);
  }
);

export default api;
```

### 5.5 WebSocket Integration

```typescript
// services/websocket.ts - WebSocket Manager
class WebSocketManager {
  private ws: WebSocket | null = null;
  private reconnectAttempts = 0;
  private maxReconnectAttempts = 5;
  private listeners: Map<string, Set<(data: any) => void>> = new Map();

  connect(url: string): void {
    this.ws = new WebSocket(url);

    this.ws.onopen = () => {
      console.log('WebSocket connected');
      this.reconnectAttempts = 0;
    };

    this.ws.onmessage = (event) => {
      const message = JSON.parse(event.data);
      const handlers = this.listeners.get(message.type);
      handlers?.forEach((handler) => handler(message.data));
    };

    this.ws.onclose = () => {
      if (this.reconnectAttempts < this.maxReconnectAttempts) {
        setTimeout(() => this.connect(url), 1000 * Math.pow(2, this.reconnectAttempts));
        this.reconnectAttempts++;
      }
    };
  }

  subscribe(type: string, handler: (data: any) => void): () => void {
    if (!this.listeners.has(type)) {
      this.listeners.set(type, new Set());
    }
    this.listeners.get(type)!.add(handler);
    return () => this.listeners.get(type)?.delete(handler);
  }
}
```

### 5.6 Performance Requirements

| Metric | Target | Measurement |
|--------|--------|-------------|
| Initial Load Time | < 3 seconds | Time to interactive |
| Route Navigation | < 500ms | Time to render new page |
| API Response Handling | < 100ms | Time to update UI after response |
| Table Render (1000 rows) | < 500ms | Time to render with virtualization |
| WebSocket Latency | < 2 seconds | Time from event to UI update |
| Memory Usage | < 500MB | Idle application memory |
| Bundle Size | < 5MB | Gzipped production build |

### 5.7 Browser/Platform Support

| Platform | Minimum Version |
|----------|-----------------|
| Electron | 28.0+ |
| Chrome (Web) | 100+ |
| Firefox (Web) | 100+ |
| Safari (Web) | 15+ |
| Windows | 10+ (64-bit) |
| macOS | 11+ (Big Sur) |
| Linux | Ubuntu 20.04+ / equivalent |

---

## 6. Security Requirements

### 6.1 Authentication Security

| ID | Requirement | Implementation |
|----|-------------|----------------|
| SEC-001 | JWT tokens stored in httpOnly cookies | Never expose tokens to JavaScript |
| SEC-002 | CSRF protection via double-submit cookie | Include X-CSRF-Token header |
| SEC-003 | Token refresh mechanism | Silent refresh before expiry |
| SEC-004 | Secure cookie flags | SameSite=Strict, Secure (HTTPS) |
| SEC-005 | Session invalidation on logout | Clear all tokens server-side |

### 6.2 Input Validation & XSS Prevention

| ID | Requirement | Implementation |
|----|-------------|----------------|
| SEC-006 | Sanitize all user inputs | Use DOMPurify for HTML content |
| SEC-007 | Escape output in templates | React auto-escapes by default |
| SEC-008 | Content Security Policy | Strict CSP headers |
| SEC-009 | Validate file uploads | Check MIME types, size limits |
| SEC-010 | Validate URL parameters | Prevent open redirects |

### 6.3 Data Protection

| ID | Requirement | Implementation |
|----|-------------|----------------|
| SEC-011 | No sensitive data in localStorage | Use httpOnly cookies only |
| SEC-012 | Mask sensitive fields in UI | Passwords, API keys, tokens |
| SEC-013 | Secure clipboard operations | Clear clipboard after paste |
| SEC-014 | Memory cleanup | Clear sensitive data from memory |

### 6.4 Electron-Specific Security

| ID | Requirement | Implementation |
|----|-------------|----------------|
| SEC-015 | Context isolation enabled | `contextIsolation: true` |
| SEC-016 | Node integration disabled | `nodeIntegration: false` |
| SEC-017 | Sandbox enabled | `sandbox: true` |
| SEC-018 | Disable remote module | `enableRemoteModule: false` |
| SEC-019 | Validate IPC messages | Whitelist allowed channels |
| SEC-020 | Disable `webSecurity` in dev only | Enable in production |

---

## 7. Testing Requirements

### 7.1 Test Coverage Targets

| Test Type | Coverage Target | Tools |
|-----------|-----------------|-------|
| Unit Tests | > 80% | Vitest, React Testing Library |
| Integration Tests | > 60% | Vitest, MSW |
| E2E Tests | Critical paths | Playwright |
| Accessibility | WCAG 2.1 AA | axe-core |
| Visual Regression | Key components | Chromatic / Percy |

### 7.2 Unit Testing Standards

```typescript
// Example: Alert component test
import { render, screen, fireEvent } from '@testing-library/react';
import { AlertCard } from './AlertCard';

describe('AlertCard', () => {
  const mockAlert = {
    id: '123',
    title: 'Suspicious PowerShell',
    severity: 'critical',
    status: 'new',
    timestamp: '2024-11-29T14:32:17Z',
  };

  it('renders alert title', () => {
    render(<AlertCard alert={mockAlert} />);
    expect(screen.getByText('Suspicious PowerShell')).toBeInTheDocument();
  });

  it('shows critical severity indicator', () => {
    render(<AlertCard alert={mockAlert} />);
    expect(screen.getByTestId('severity-indicator')).toHaveClass('critical');
  });

  it('calls onSelect when clicked', () => {
    const onSelect = vi.fn();
    render(<AlertCard alert={mockAlert} onSelect={onSelect} />);
    fireEvent.click(screen.getByRole('article'));
    expect(onSelect).toHaveBeenCalledWith('123');
  });
});
```

### 7.3 E2E Testing Scenarios

```typescript
// Example: Playwright E2E test
import { test, expect } from '@playwright/test';

test.describe('Alert Triage', () => {
  test.beforeEach(async ({ page }) => {
    await page.goto('/login');
    await page.fill('[name="username"]', 'analyst@example.com');
    await page.fill('[name="password"]', 'password123');
    await page.click('button[type="submit"]');
    await expect(page).toHaveURL('/dashboard');
  });

  test('can filter alerts by severity', async ({ page }) => {
    await page.goto('/alerts');
    await page.selectOption('[data-testid="severity-filter"]', 'critical');
    await page.waitForSelector('[data-testid="alert-list"]');

    const alerts = await page.$$('[data-testid="alert-row"]');
    for (const alert of alerts) {
      const severity = await alert.$('[data-testid="severity-badge"]');
      await expect(severity).toHaveText('Critical');
    }
  });

  test('can change alert status', async ({ page }) => {
    await page.goto('/alerts');
    await page.click('[data-testid="alert-row"]:first-child');
    await page.selectOption('[data-testid="status-select"]', 'in_progress');

    await expect(page.getByText('Status updated')).toBeVisible();
    await expect(page.getByTestId('status-badge')).toHaveText('In Progress');
  });
});
```

### 7.4 Accessibility Testing

All components must meet WCAG 2.1 Level AA compliance:

| Requirement | Standard |
|-------------|----------|
| Keyboard Navigation | All interactive elements focusable via Tab |
| Focus Indicators | Visible focus rings on all focusable elements |
| Color Contrast | Minimum 4.5:1 for text, 3:1 for large text |
| Screen Reader | All images have alt text, ARIA labels where needed |
| Form Labels | All inputs have associated labels |
| Error Messages | Errors announced to screen readers |

---

## 8. Appendices

### 8.1 Keyboard Shortcuts

| Shortcut | Action | Context |
|----------|--------|---------|
| `Ctrl/Cmd + K` | Open Command Palette | Global |
| `Ctrl/Cmd + /` | Toggle Sidebar | Global |
| `Ctrl/Cmd + Enter` | Execute Query | Query Builder |
| `Escape` | Close Modal/Panel | Global |
| `j` / `k` | Next/Previous Item | Lists |
| `Enter` | Open Selected Item | Lists |
| `Ctrl/Cmd + N` | New Item | Context-dependent |
| `Ctrl/Cmd + S` | Save | Forms |
| `Ctrl/Cmd + F` | Focus Search | Global |

### 8.2 Error Codes

| Code | Message | Resolution |
|------|---------|------------|
| E001 | Authentication failed | Check credentials |
| E002 | Session expired | Re-authenticate |
| E003 | Permission denied | Contact administrator |
| E004 | Resource not found | Verify resource exists |
| E005 | Validation error | Check input fields |
| E006 | Server error | Retry or contact support |
| E007 | Network error | Check connection |
| E008 | Rate limited | Wait and retry |

### 8.3 Glossary

| Term | Definition |
|------|------------|
| CQL | Cerberus Query Language - Search query syntax |
| SIGMA | Open standard for detection rules |
| MITRE ATT&CK | Adversarial tactics and techniques framework |
| SOAR | Security Orchestration, Automation, and Response |
| DLQ | Dead Letter Queue - Failed event storage |
| EPS | Events Per Second - Throughput metric |
| MTTR | Mean Time To Respond - Performance metric |
| JWT | JSON Web Token - Authentication token |
| RBAC | Role-Based Access Control |
| MFA | Multi-Factor Authentication |

---

**Document End**

*This document provides comprehensive functional requirements for the Cerberus Console Electron frontend. All modules, wireframes, flow diagrams, and acceptance criteria are designed to ensure complete coverage of the backend API functionality and enable efficient security operations workflows.*

