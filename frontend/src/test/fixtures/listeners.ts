import type {
  DynamicListener,
  ListenerTemplate,
  Event,
  BulkOperationResult,
  BulkImportResult,
} from '../../types';

// Mock Dynamic Listeners
export const mockListeners: DynamicListener[] = [
  {
    id: 'listener-1',
    name: 'Production Syslog',
    description: 'Main production syslog listener',
    type: 'syslog',
    protocol: 'udp',
    host: '0.0.0.0',
    port: 514,
    tls: false,
    status: 'running',
    tags: ['production', 'critical'],
    source: 'prod-syslog',
    events_received: 15432,
    events_per_minute: 245,
    error_count: 3,
    last_event: '2025-01-15T10:30:00Z',
    created_at: '2025-01-10T08:00:00Z',
    created_by: 'admin',
    updated_at: '2025-01-10T08:00:00Z',
    started_at: '2025-01-10T08:05:00Z',
  },
  {
    id: 'listener-2',
    name: 'CEF Firewall',
    description: 'CEF listener for firewall logs',
    type: 'cef',
    protocol: 'tcp',
    host: '0.0.0.0',
    port: 515,
    tls: true,
    cert_file: '/etc/certs/server.crt',
    key_file: '/etc/certs/server.key',
    status: 'running',
    tags: ['firewall', 'cef'],
    source: 'firewall-cef',
    events_received: 8721,
    events_per_minute: 120,
    error_count: 0,
    last_event: '2025-01-15T10:29:45Z',
    created_at: '2025-01-11T09:15:00Z',
    created_by: 'admin',
    updated_at: '2025-01-11T09:15:00Z',
    started_at: '2025-01-11T09:20:00Z',
  },
  {
    id: 'listener-3',
    name: 'Development JSON',
    description: 'JSON listener for dev environment',
    type: 'json',
    protocol: 'http',
    host: '127.0.0.1',
    port: 8888,
    tls: false,
    status: 'stopped',
    tags: ['development', 'json'],
    source: 'dev-json',
    events_received: 542,
    events_per_minute: 0,
    error_count: 1,
    last_event: '2025-01-14T16:22:10Z',
    created_at: '2025-01-12T11:30:00Z',
    created_by: 'developer',
    updated_at: '2025-01-14T16:30:00Z',
    stopped_at: '2025-01-14T16:30:00Z',
  },
  {
    id: 'listener-4',
    name: 'Error Test Listener',
    description: 'Listener in error state for testing',
    type: 'syslog',
    protocol: 'udp',
    host: '0.0.0.0',
    port: 9999,
    tls: false,
    status: 'error',
    tags: ['test', 'error'],
    source: 'error-test',
    events_received: 0,
    events_per_minute: 0,
    error_count: 25,
    last_event: '',
    created_at: '2025-01-13T14:00:00Z',
    created_by: 'admin',
    updated_at: '2025-01-13T14:05:00Z',
  },
];

// Mock Listener Templates
export const mockTemplates: ListenerTemplate[] = [
  {
    id: 'template-syslog-standard',
    name: 'Standard Syslog',
    description: 'Standard UDP Syslog listener on port 514',
    category: 'syslog',
    icon: 'ðŸ“',
    tags: ['syslog', 'udp', 'standard'],
    config: {
      id: '',
      name: 'New Syslog Listener',
      description: 'Standard syslog listener',
      type: 'syslog',
      protocol: 'udp',
      host: '0.0.0.0',
      port: 514,
      tls: false,
      status: 'stopped',
      tags: ['syslog'],
      source: 'syslog-source',
      events_received: 0,
      events_per_minute: 0,
      error_count: 0,
      last_event: '',
      created_at: '',
      created_by: '',
      updated_at: '',
    },
  },
  {
    id: 'template-syslog-tls',
    name: 'Syslog over TLS',
    description: 'Secure TCP Syslog listener with TLS on port 6514',
    category: 'syslog',
    icon: 'ðŸ”’',
    tags: ['syslog', 'tcp', 'tls', 'secure'],
    config: {
      id: '',
      name: 'Secure Syslog Listener',
      description: 'TLS-enabled syslog listener',
      type: 'syslog',
      protocol: 'tcp',
      host: '0.0.0.0',
      port: 6514,
      tls: true,
      cert_file: '/etc/certs/server.crt',
      key_file: '/etc/certs/server.key',
      status: 'stopped',
      tags: ['syslog', 'tls'],
      source: 'secure-syslog',
      events_received: 0,
      events_per_minute: 0,
      error_count: 0,
      last_event: '',
      created_at: '',
      created_by: '',
      updated_at: '',
    },
  },
  {
    id: 'template-cef-firewall',
    name: 'CEF Firewall',
    description: 'CEF listener optimized for firewall logs',
    category: 'cef',
    icon: 'ðŸ”¥',
    tags: ['cef', 'firewall', 'security'],
    config: {
      id: '',
      name: 'Firewall CEF Listener',
      description: 'CEF listener for firewall events',
      type: 'cef',
      protocol: 'tcp',
      host: '0.0.0.0',
      port: 515,
      tls: true,
      cert_file: '/etc/certs/server.crt',
      key_file: '/etc/certs/server.key',
      status: 'stopped',
      tags: ['cef', 'firewall'],
      source: 'firewall-cef',
      events_received: 0,
      events_per_minute: 0,
      error_count: 0,
      last_event: '',
      created_at: '',
      created_by: '',
      updated_at: '',
    },
  },
  {
    id: 'template-json-api',
    name: 'JSON API Listener',
    description: 'HTTP JSON listener for API log ingestion',
    category: 'json',
    icon: 'ðŸŒ',
    tags: ['json', 'http', 'api'],
    config: {
      id: '',
      name: 'JSON API Listener',
      description: 'HTTP listener for JSON logs',
      type: 'json',
      protocol: 'http',
      host: '0.0.0.0',
      port: 8080,
      tls: false,
      status: 'stopped',
      tags: ['json', 'api'],
      source: 'json-api',
      events_received: 0,
      events_per_minute: 0,
      error_count: 0,
      last_event: '',
      created_at: '',
      created_by: '',
      updated_at: '',
    },
  },
  {
    id: 'template-json-secure',
    name: 'Secure JSON Listener',
    description: 'HTTPS JSON listener with TLS encryption',
    category: 'json',
    icon: 'ðŸ”',
    tags: ['json', 'https', 'tls', 'secure'],
    config: {
      id: '',
      name: 'Secure JSON Listener',
      description: 'HTTPS listener with TLS',
      type: 'json',
      protocol: 'http',
      host: '0.0.0.0',
      port: 8443,
      tls: true,
      cert_file: '/etc/certs/server.crt',
      key_file: '/etc/certs/server.key',
      status: 'stopped',
      tags: ['json', 'https', 'secure'],
      source: 'json-secure',
      events_received: 0,
      events_per_minute: 0,
      error_count: 0,
      last_event: '',
      created_at: '',
      created_by: '',
      updated_at: '',
    },
  },
  {
    id: 'template-cloud-aws',
    name: 'AWS CloudWatch',
    description: 'Optimized for AWS CloudWatch log ingestion',
    category: 'cloud',
    icon: 'â˜ï¸',
    tags: ['cloud', 'aws', 'cloudwatch'],
    config: {
      id: '',
      name: 'AWS CloudWatch Listener',
      description: 'Listener for AWS CloudWatch logs',
      type: 'json',
      protocol: 'http',
      host: '0.0.0.0',
      port: 9000,
      tls: true,
      cert_file: '/etc/certs/server.crt',
      key_file: '/etc/certs/server.key',
      status: 'stopped',
      tags: ['aws', 'cloudwatch', 'cloud'],
      source: 'aws-cloudwatch',
      events_received: 0,
      events_per_minute: 0,
      error_count: 0,
      last_event: '',
      created_at: '',
      created_by: '',
      updated_at: '',
    },
  },
  {
    id: 'template-cloud-azure',
    name: 'Azure Monitor',
    description: 'Optimized for Azure Monitor log ingestion',
    category: 'cloud',
    icon: 'â˜ï¸',
    tags: ['cloud', 'azure', 'monitor'],
    config: {
      id: '',
      name: 'Azure Monitor Listener',
      description: 'Listener for Azure Monitor logs',
      type: 'json',
      protocol: 'http',
      host: '0.0.0.0',
      port: 9001,
      tls: true,
      cert_file: '/etc/certs/server.crt',
      key_file: '/etc/certs/server.key',
      status: 'stopped',
      tags: ['azure', 'monitor', 'cloud'],
      source: 'azure-monitor',
      events_received: 0,
      events_per_minute: 0,
      error_count: 0,
      last_event: '',
      created_at: '',
      created_by: '',
      updated_at: '',
    },
  },
];

// Mock Events
export const mockEvents: Event[] = [
  {
    event_id: 'evt-001',
    event_type: 'authentication',
    fields: {
      user: 'admin',
      action: 'login',
      result: 'success',
      source_ip: '192.168.1.100',
    },
    raw_data: 'Jan 15 10:30:00 server sshd[1234]: Accepted password for admin from 192.168.1.100',
    severity: 'info',
    source_format: 'syslog',
    source_ip: '192.168.1.100',
    timestamp: '2025-01-15T10:30:00Z',
  },
  {
    event_id: 'evt-002',
    event_type: 'firewall',
    fields: {
      action: 'blocked',
      protocol: 'tcp',
      src_ip: '203.0.113.45',
      dst_ip: '192.168.1.10',
      dst_port: 22,
    },
    raw_data: 'CEF:0|Firewall|FW-3000|1.0|100|Connection Blocked|5|src=203.0.113.45 dst=192.168.1.10 dpt=22',
    severity: 'warning',
    source_format: 'cef',
    source_ip: '203.0.113.45',
    timestamp: '2025-01-15T10:29:45Z',
  },
  {
    event_id: 'evt-003',
    event_type: 'application',
    fields: {
      app: 'web-api',
      endpoint: '/api/users',
      method: 'GET',
      status: 200,
      response_time: 145,
    },
    raw_data: '{"app":"web-api","endpoint":"/api/users","method":"GET","status":200,"response_time_ms":145}',
    severity: 'info',
    source_format: 'json',
    source_ip: '192.168.1.50',
    timestamp: '2025-01-15T10:29:30Z',
  },
  {
    event_id: 'evt-004',
    event_type: 'authentication',
    fields: {
      user: 'unknown',
      action: 'login',
      result: 'failed',
      source_ip: '198.51.100.88',
      attempts: 5,
    },
    raw_data: 'Jan 15 10:28:15 server sshd[5678]: Failed password for invalid user unknown from 198.51.100.88',
    severity: 'high',
    source_format: 'syslog',
    source_ip: '198.51.100.88',
    timestamp: '2025-01-15T10:28:15Z',
  },
  {
    event_id: 'evt-005',
    event_type: 'network',
    fields: {
      event: 'connection_established',
      protocol: 'https',
      src_ip: '192.168.1.100',
      dst_ip: '172.217.14.206',
      dst_port: 443,
    },
    raw_data: 'CEF:0|Network|IDS-2000|2.1|200|Connection Established|3|src=192.168.1.100 dst=172.217.14.206 dpt=443',
    severity: 'info',
    source_format: 'cef',
    source_ip: '192.168.1.100',
    timestamp: '2025-01-15T10:27:00Z',
  },
  {
    event_id: 'evt-006',
    event_type: 'database',
    fields: {
      db: 'production',
      operation: 'SELECT',
      table: 'users',
      duration_ms: 23,
      rows: 150,
    },
    raw_data: '{"database":"production","operation":"SELECT","table":"users","duration_ms":23,"rows_affected":150}',
    severity: 'info',
    source_format: 'json',
    source_ip: '192.168.1.75',
    timestamp: '2025-01-15T10:26:45Z',
  },
  {
    event_id: 'evt-007',
    event_type: 'security',
    fields: {
      alert_type: 'malware_detected',
      file: '/tmp/suspicious.exe',
      action: 'quarantined',
      signature: 'Trojan.Generic.12345',
    },
    raw_data: 'CEF:0|AV|AntiVirus-Pro|3.0|500|Malware Detected|9|file=/tmp/suspicious.exe sig=Trojan.Generic.12345',
    severity: 'critical',
    source_format: 'cef',
    source_ip: '192.168.1.150',
    timestamp: '2025-01-15T10:25:30Z',
  },
  {
    event_id: 'evt-008',
    event_type: 'system',
    fields: {
      component: 'disk',
      metric: 'usage',
      value: 92,
      threshold: 90,
      mount: '/var',
    },
    raw_data: '{"component":"disk","metric":"usage","value":92,"threshold":90,"mount":"/var","alert":"high"}',
    severity: 'warning',
    source_format: 'json',
    source_ip: '192.168.1.200',
    timestamp: '2025-01-15T10:24:00Z',
  },
];

// Mock Bulk Operation Result Generator
export const mockBulkOperationResult = (
  operation: string,
  listenerIds: string[]
): BulkOperationResult => {
  const successCount = Math.floor(listenerIds.length * 0.8); // 80% success rate
  const failureCount = listenerIds.length - successCount;

  return {
    operation,
    total_requested: listenerIds.length,
    success_count: successCount,
    failure_count: failureCount,
    results: listenerIds.map((id, index) => ({
      listener_id: id,
      success: index < successCount,
      message:
        index < successCount
          ? `Successfully ${operation}ed listener ${id}`
          : `Failed to ${operation} listener ${id}`,
      error:
        index >= successCount ? `Listener ${id} is not in valid state for ${operation}` : undefined,
    })),
    export_data:
      operation === 'export'
        ? mockListeners.filter((l) => listenerIds.includes(l.id))
        : undefined,
  };
};

// Mock Bulk Import Result Generator
export const mockBulkImportResult = (
  totalProcessed: number = 10,
  successCount: number = 7,
  failedCount: number = 2,
  skippedCount: number = 1
): BulkImportResult => {
  return {
    total_processed: totalProcessed,
    success_count: successCount,
    failed_count: failedCount,
    skipped_count: skippedCount,
    conflicts: [
      {
        listener_id: 'listener-conflict-1',
        name: 'Production Syslog',
        reason: 'Listener with same name already exists',
        resolution: 'skipped',
      },
    ],
    errors: [
      {
        listener_id: 'listener-error-1',
        message: 'Invalid port number: must be between 1-65535',
      },
      {
        listener_id: 'listener-error-2',
        message: 'Missing required field: name',
      },
    ],
  };
};
